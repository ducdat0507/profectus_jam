/* empty css                    */import"./vue.d3924a70.js";import{q as Ft,D as c,ad as K,t as O,aM as N,a3 as M,aS as it,bD as Tt,H as ye,az as At,a0 as T,aG as mn,a4 as h,K as Z,Q as he,aR as nt,a2 as A,J as Re,aa as $,ab as g,bf as j,aP as ft,aN as mt,l as Le,u as hn,ba as Qe,w as Gt,bb as vn,aO as Yt,A as Be,a1 as J,bh as pn,bB as _r,ay as Ct,bk as Lt,V as wr,j as Nr,bE as $n,aF as Sr,aT as Bt,aV as We,z as gt,bw as Cr,bA as kr,bl as Tn,as as Fn,aK as Mr,bn as Ir}from"./@vue.f39bd477.js";import{L as rt}from"./lz-string.dccec454.js";import{c as Bn}from"./nanoevents.1080beb7.js";import{Y as xr}from"./vue-next-select.90a10463.js";import{D as $r}from"./vuedraggable.09420910.js";import{p as Tr}from"./vue-textarea-autosize.35804eaf.js";import{P as Fr}from"./vue-panzoom.84096fdf.js";import{s as Pr,u as Er}from"./vue-toastification.1036abd4.js";import"./amator.0d8662e6.js";import"./bezier-easing.a990b400.js";import"./sortablejs.c81ffc7d.js";import"./panzoom.a3919164.js";import"./wheel.e9936e98.js";import"./ngraph.events.083734c6.js";const Or=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}};Or();const Dr="modulepreload",Pn={},Vr="./",qt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Vr}${r}`,r in Pn)return;Pn[r]=!0;const i=r.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${a}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":Dr,i||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),i)return new Promise((s,l)=>{u.addEventListener("load",s),u.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},Ar="./projInfo-schema.json",Lr="Delooped",Br="A project made in Profectus",qr="delooped",Rr="",zr="",Ur="",jr="0.0",Gr="Initial Commit",Wr=!0,Hr=!1,Zr=2,Yr=!1,Jr=null,Xr="",Kr=["game"],Qr=1,ei=0,ti=!0,ni="base64";var X={$schema:Ar,title:Lr,description:Br,id:qr,author:Rr,discordName:zr,discordLink:Ur,versionNumber:jr,versionTitle:Gr,allowGoBack:Wr,defaultShowSmall:Hr,defaultDecimalsShown:Zr,useHeader:Yr,banner:Jr,logo:Xr,initialTabs:Kr,maxTickLength:Qr,offlineLimit:ei,enablePausing:ti,exportEncoding:ni};const ri=Ft({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var G=window.player=ri;function bn(e){return JSON.stringify(e,(t,n)=>c(n))}var le=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n};const ii=["onClick"],ai=K({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=O(!1),r=O(null);function i(){t("click"),r.value&&clearTimeout(r.value),n.value=!1,At(()=>{n.value=!0,r.value=setTimeout(()=>n.value=!1,500)})}return(a,u)=>(N(),M("button",{onClick:Tt(i,["stop"]),class:ye(["feedback",{activated:n.value,left:a.left}])},[it(a.$slots,"default",{},void 0,!0)],10,ii))}});var yn=le(ai,[["__scopeId","data-v-01a1b95c"]]);const rn=e=>(ft("data-v-ac351c02"),e=e(),mt(),e),oi={class:"error"},si={class:"error-title"},li={class:"error-details",style:{"margin-top":"-10px"}},ui={key:0},ci={class:"instructions"},di=["href"],gi=rn(()=>h("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),fi=rn(()=>h("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),mi=rn(()=>h("br",null,null,-1)),hi={key:0,style:{"margin-top":"20px"}},vi=rn(()=>h("h3",null,"Other errors",-1)),pi=[vi],bi={class:"error-details"},yi={key:0,style:{"margin-top":"10px"}},_i={key:1,style:{"margin-top":"10px"}},wi=K({__name:"Error",props:{errors:{}},setup(e){const t=e,n=T(()=>t.errors[0]),r=T(()=>t.errors.map(u=>u.stack==null?[]:u.stack.split(`
`))),i=T(()=>t.errors.map(u=>u.cause==null?[]:(typeof u.cause=="string"?u.cause:JSON.stringify(u.cause)).split(`
`)));function a(){let u=bn(G);switch(X.exportEncoding){default:console.warn(`Unknown save encoding: ${X.exportEncoding}. Defaulting to lz`);case"lz":u=rt.compressToUTF16(u);break;case"base64":u=btoa(unescape(encodeURIComponent(u)));break;case"plain":break}console.log(u);const s=document.createElement("textarea");s.value=u,document.body.appendChild(s),s.select(),s.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(s)}return mn(()=>{G.autosave=!1,G.devSpeed=0}),(u,s)=>(N(),M("div",oi,[h("h1",si,Z(n.value.name)+": "+Z(n.value.message),1),h("div",li,[n.value.cause?(N(),M("div",ui,[(N(!0),M(he,null,nt(i.value[0],l=>(N(),M("div",{key:l},Z(l),1))),128))])):A("",!0),n.value.stack?(N(),M("div",{key:1,style:Re(n.value.cause?"margin-top: 10px":"")},[(N(!0),M(he,null,nt(r.value[0],l=>(N(),M("div",{key:l},Z(l),1))),128))],4)):A("",!0)]),h("div",ci,[$(" Check the console for more details, and consider sharing it with the developers on "),h("a",{href:c(X).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,di),$("! "),g(yn,{onClick:a,class:"button",style:{display:"inline-flex"}},{default:j(()=>[gi,fi]),_:1}),mi,u.errors.length>1?(N(),M("div",hi,pi)):A("",!0),(N(!0),M(he,null,nt(u.errors.slice(1),(l,m)=>(N(),M("div",{key:m,style:{"margin-top":"20px"}},[h("details",bi,[h("summary",null,Z(l.name)+": "+Z(l.message),1),l.cause?(N(),M("div",yi,[(N(!0),M(he,null,nt(i.value[m+1],y=>(N(),M("div",{key:y},Z(y),1))),128))])):A("",!0),l.stack?(N(),M("div",_i,[(N(!0),M(he,null,nt(r.value[m+1],y=>(N(),M("div",{key:y},Z(y),1))),128))])):A("",!0)])]))),128))])]))}});var qn=le(wi,[["__scopeId","data-v-ac351c02"]]);class Ni{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const r=new Si(t,n);for(this.first===void 0?(this.first=r,this.last=r):(r.next=this.first,this.first.prev=r,this.first=r),this.map.set(t,r);this.map.size>this.maxSize;){const i=this.last;this.map.delete(i.key),this.last=i.prev,this.last.next=void 0}}}class Si{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const cn=17,Ci=9e15,ki=Math.log10(9e15),Mi=1/9e15,Ii=308,xi=-324,En=5,$i=(1<<10)-1,Ti=function(){const e=[];for(let n=xi+1;n<=Ii;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),pt=[2,Math.E,3,4,5,6,7,8,9,10],Fi=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],Pi=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let w=function(t){return d.fromValue_noAlloc(t)},W=function(e,t,n){return d.fromComponents(e,t,n)},Y=function(t,n,r){return d.fromComponents_noNormalize(t,n,r)};const lt=function(t,n){const r=n+1,i=Math.ceil(Math.log10(Math.abs(t))),a=Math.round(t*Math.pow(10,r-i))*Math.pow(10,i-r);return parseFloat(a.toFixed(Math.max(r-i,0)))},dn=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},Ei=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const r=e*e;let i=e;return n=n+1/(12*i),i=i*r,n=n+1/(360*i),i=i*r,n=n+1/(1260*i),i=i*r,n=n+1/(1680*i),i=i*r,n=n+1/(1188*i),i=i*r,n=n+691/(360360*i),i=i*r,n=n+7/(1092*i),i=i*r,n=n+3617/(122400*i),Math.exp(n)/t},Rn=.5671432904097838,On=function(e,t=1e-10){let n,r;if(!Number.isFinite(e)||e===0)return e;if(e===1)return Rn;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let i=0;i<100;++i){if(r=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(r-n)<t*Math.abs(r))return r;n=r}throw Error(`Iteration failed to converge: ${e.toString()}`)};function Dn(e,t=1e-10){let n,r,i,a;if(!Number.isFinite(e.mag)||e.eq(d.dZero))return e;if(e.eq(d.dOne))return d.fromNumber(Rn);n=d.ln(e);for(let u=0;u<100;++u){if(r=n.neg().exp(),i=n.sub(e.mul(r)),a=n.sub(i.div(n.add(1).sub(n.add(2).mul(i).div(d.mul(2,n).add(2))))),d.abs(a.sub(n)).lt(d.abs(a).mul(t)))return a;n=a}throw Error(`Iteration failed to converge: ${e.toString()}`)}const f=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof f?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/Ti(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new f().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new f().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new f().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new f().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new f().fromDecimal(e)}static fromNumber(e){return new f().fromNumber(e)}static fromString(e){return new f().fromString(e)}static fromValue(e){return new f().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof f)return e;if(typeof e=="string"){const t=f.fromStringCache.get(e);return t!==void 0?t:f.fromString(e)}else return typeof e=="number"?f.fromNumber(e):f.dZero}static abs(e){return w(e).abs()}static neg(e){return w(e).neg()}static negate(e){return w(e).neg()}static negated(e){return w(e).neg()}static sign(e){return w(e).sign}static sgn(e){return w(e).sign}static round(e){return w(e).round()}static floor(e){return w(e).floor()}static ceil(e){return w(e).ceil()}static trunc(e){return w(e).trunc()}static add(e,t){return w(e).add(t)}static plus(e,t){return w(e).add(t)}static sub(e,t){return w(e).sub(t)}static subtract(e,t){return w(e).sub(t)}static minus(e,t){return w(e).sub(t)}static mul(e,t){return w(e).mul(t)}static multiply(e,t){return w(e).mul(t)}static times(e,t){return w(e).mul(t)}static div(e,t){return w(e).div(t)}static divide(e,t){return w(e).div(t)}static recip(e){return w(e).recip()}static reciprocal(e){return w(e).recip()}static reciprocate(e){return w(e).reciprocate()}static cmp(e,t){return w(e).cmp(t)}static cmpabs(e,t){return w(e).cmpabs(t)}static compare(e,t){return w(e).cmp(t)}static isNaN(e){return e=w(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=w(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return w(e).eq(t)}static equals(e,t){return w(e).eq(t)}static neq(e,t){return w(e).neq(t)}static notEquals(e,t){return w(e).notEquals(t)}static lt(e,t){return w(e).lt(t)}static lte(e,t){return w(e).lte(t)}static gt(e,t){return w(e).gt(t)}static gte(e,t){return w(e).gte(t)}static max(e,t){return w(e).max(t)}static min(e,t){return w(e).min(t)}static minabs(e,t){return w(e).minabs(t)}static maxabs(e,t){return w(e).maxabs(t)}static clamp(e,t,n){return w(e).clamp(t,n)}static clampMin(e,t){return w(e).clampMin(t)}static clampMax(e,t){return w(e).clampMax(t)}static cmp_tolerance(e,t,n){return w(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return w(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return w(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return w(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return w(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return w(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return w(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return w(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return w(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return w(e).gte_tolerance(t,n)}static pLog10(e){return w(e).pLog10()}static absLog10(e){return w(e).absLog10()}static log10(e){return w(e).log10()}static log(e,t){return w(e).log(t)}static log2(e){return w(e).log2()}static ln(e){return w(e).ln()}static logarithm(e,t){return w(e).logarithm(t)}static pow(e,t){return w(e).pow(t)}static pow10(e){return w(e).pow10()}static pow_base(e,t){return w(e).pow_base(t)}static root(e,t){return w(e).root(t)}static factorial(e,t){return w(e).factorial()}static gamma(e,t){return w(e).gamma()}static lngamma(e,t){return w(e).lngamma()}static exp(e){return w(e).exp()}static sqr(e){return w(e).sqr()}static sqrt(e){return w(e).sqrt()}static cube(e){return w(e).cube()}static cbrt(e){return w(e).cbrt()}static tetrate(e,t=2,n=Y(1,0,1)){return w(e).tetrate(t,n)}static iteratedexp(e,t=2,n=Y(1,0,1)){return w(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return w(e).iteratedlog(t,n)}static layeradd10(e,t){return w(e).layeradd10(t)}static layeradd(e,t,n=10){return w(e).layeradd(t,n)}static slog(e,t=10){return w(e).slog(t)}static lambertw(e){return w(e).lambertw()}static ssqrt(e){return w(e).ssqrt()}static pentate(e,t=2,n=Y(1,0,1)){return w(e).pentate(t,n)}static sin(e){return w(e).sin()}static cos(e){return w(e).cos()}static tan(e){return w(e).tan()}static asin(e){return w(e).asin()}static acos(e){return w(e).acos()}static atan(e){return w(e).atan()}static sinh(e){return w(e).sinh()}static cosh(e){return w(e).cosh()}static tanh(e){return w(e).tanh()}static asinh(e){return w(e).asinh()}static acosh(e){return w(e).acosh()}static atanh(e){return w(e).atanh()}static affordGeometricSeries(e,t,n,r){return this.affordGeometricSeries_core(w(e),w(t),w(n),r)}static sumGeometricSeries(e,t,n,r){return this.sumGeometricSeries_core(e,w(t),w(n),r)}static affordArithmeticSeries(e,t,n,r){return this.affordArithmeticSeries_core(w(e),w(t),w(n),w(r))}static sumArithmeticSeries(e,t,n,r){return this.sumArithmeticSeries_core(w(e),w(t),w(n),w(r))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(w(e),w(t),w(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return Y(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return Y(t,0,1);const n=Math.floor(Math.random()*(e+1));let r=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(r=Math.trunc(r));let i=Math.pow(10,r);return Math.random()>.9&&(i=Math.trunc(i)),W(t,n,i)}static affordGeometricSeries_core(e,t,n,r){const i=t.mul(n.pow(r));return f.floor(e.div(i).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,r){return t.mul(n.pow(r)).mul(f.sub(1,n.pow(e))).div(f.sub(1,n))}static affordArithmeticSeries_core(e,t,n,r){const a=t.add(r.mul(n)).sub(n.div(2)),u=a.pow(2);return a.neg().add(u.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,r){const i=t.add(r.mul(n));return e.div(2).mul(i.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<Mi)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=Ci)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<ki&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=f.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const r=e.split("^^^");if(r.length===2){const p=parseFloat(r[0]),S=parseFloat(r[1]),L=r[1].split(";");let P=1;if(L.length===2&&(P=parseFloat(L[1]),isFinite(P)||(P=1)),isFinite(p)&&isFinite(S)){const C=f.pentate(p,S,P);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const i=e.split("^^");if(i.length===2){const p=parseFloat(i[0]),S=parseFloat(i[1]),L=i[1].split(";");let P=1;if(L.length===2&&(P=parseFloat(L[1]),isFinite(P)||(P=1)),isFinite(p)&&isFinite(S)){const C=f.tetrate(p,S,P);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const a=e.split("^");if(a.length===2){const p=parseFloat(a[0]),S=parseFloat(a[1]);if(isFinite(p)&&isFinite(S)){const L=f.pow(p,S);return this.sign=L.sign,this.layer=L.layer,this.mag=L.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}e=e.trim().toLowerCase();let u,s,l=e.split("pt");if(l.length===2){u=10,s=parseFloat(l[0]),l[1]=l[1].replace("(",""),l[1]=l[1].replace(")","");let p=parseFloat(l[1]);if(isFinite(p)||(p=1),isFinite(u)&&isFinite(s)){const S=f.tetrate(u,s,p);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}if(l=e.split("p"),l.length===2){u=10,s=parseFloat(l[0]),l[1]=l[1].replace("(",""),l[1]=l[1].replace(")","");let p=parseFloat(l[1]);if(isFinite(p)||(p=1),isFinite(u)&&isFinite(s)){const S=f.tetrate(u,s,p);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const m=e.split("e"),y=m.length-1;if(y===0){const p=parseFloat(e);if(isFinite(p))return this.fromNumber(p),f.fromStringCache.size>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}else if(y===1){const p=parseFloat(e);if(isFinite(p)&&p!==0)return this.fromNumber(p),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}const v=e.split("e^");if(v.length===2){this.sign=1,v[0].charAt(0)=="-"&&(this.sign=-1);let p="";for(let S=0;S<v[1].length;++S){const L=v[1].charCodeAt(S);if(L>=43&&L<=57||L===101)p+=v[1].charAt(S);else return this.layer=parseFloat(p),this.mag=parseFloat(v[1].substr(S+1)),this.normalize(),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}if(y<1)return this.sign=0,this.layer=0,this.mag=0,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this;const b=parseFloat(m[0]);if(b===0)return this.sign=0,this.layer=0,this.mag=0,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this;let _=parseFloat(m[m.length-1]);if(y>=2){const p=parseFloat(m[m.length-2]);isFinite(p)&&(_*=Math.sign(p),_+=dn(p))}if(!isFinite(b))this.sign=m[0]==="-"?-1:1,this.layer=y,this.mag=_;else if(y===1)this.sign=Math.sign(b),this.layer=1,this.mag=_+Math.log10(Math.abs(b));else if(this.sign=Math.sign(b),this.layer=y,y===2){const p=f.mul(W(1,2,_),w(b));return this.sign=p.sign,this.layer=p.layer,this.mag=p.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}else this.mag=_;return this.normalize(),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}fromValue(e){return e instanceof f?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:lt(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:lt(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=En?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):lt(this.m,e)+"e"+lt(this.e,e):this.layer===1?lt(this.m,e)+"e"+lt(this.e,e):this.layer<=En?(this.sign===-1?"-":"")+"e".repeat(this.layer)+lt(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+lt(this.mag,e)}abs(){return Y(this.sign===0?0:1,this.layer,this.mag)}neg(){return Y(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=w(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return Y(0,0,0);let n,r;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(f.cmpabs(this,t)>0?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return f.fromNumber(n.sign*n.mag+r.sign*r.mag);const i=n.layer*Math.sign(n.mag),a=r.layer*Math.sign(r.mag);if(i-a>=2)return n;if(i===0&&a===-1){if(Math.abs(r.mag-Math.log10(n.mag))>cn)return n;{const u=Math.pow(10,Math.log10(n.mag)-r.mag),s=r.sign+n.sign*u;return W(Math.sign(s),1,r.mag+Math.log10(Math.abs(s)))}}if(i===1&&a===0){if(Math.abs(n.mag-Math.log10(r.mag))>cn)return n;{const u=Math.pow(10,n.mag-Math.log10(r.mag)),s=r.sign+n.sign*u;return W(Math.sign(s),1,Math.log10(r.mag)+Math.log10(Math.abs(s)))}}if(Math.abs(n.mag-r.mag)>cn)return n;{const u=Math.pow(10,n.mag-r.mag),s=r.sign+n.sign*u;return W(Math.sign(s),1,r.mag+Math.log10(Math.abs(s)))}}plus(e){return this.add(e)}sub(e){return this.add(w(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=w(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return Y(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return Y(this.sign*t.sign,0,1);let n,r;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return f.fromNumber(n.sign*r.sign*n.mag*r.mag);if(n.layer>=3||n.layer-r.layer>=2)return W(n.sign*r.sign,n.layer,n.mag);if(n.layer===1&&r.layer===0)return W(n.sign*r.sign,1,n.mag+Math.log10(r.mag));if(n.layer===1&&r.layer===1)return W(n.sign*r.sign,1,n.mag+r.mag);if(n.layer===2&&r.layer===1){const i=W(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(W(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return W(n.sign*r.sign,i.layer+1,i.sign*i.mag)}if(n.layer===2&&r.layer===2){const i=W(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(W(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return W(n.sign*r.sign,i.layer+1,i.sign*i.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=w(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?f.dNaN:this.layer===0?W(this.sign,0,1/this.mag):W(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=w(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=w(e),n=this.mag>0?this.layer:-this.layer,r=t.mag>0?t.layer:-t.layer;return n>r?1:n<r?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=w(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=w(e);return this.lt(t)?t:this}min(e){const t=w(e);return this.gt(t)?t:this}maxabs(e){const t=w(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=w(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=w(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let r=this.mag,i=n.mag;return this.layer>n.layer&&(i=dn(i)),this.layer<n.layer&&(r=dn(r)),Math.abs(r-i)<=t*Math.max(Math.abs(r),Math.abs(i))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=w(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=w(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(f.dZero)?f.dZero:this.log10()}absLog10(){return this.sign===0?f.dNaN:this.layer>0?W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):W(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?f.dNaN:this.layer>0?W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):W(this.sign,0,Math.log10(this.mag))}log(e){return e=w(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?f.dNaN:this.layer===0&&e.layer===0?W(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):f.div(this.log10(),e.log10())}log2(){return this.sign<=0?f.dNaN:this.layer===0?W(this.sign,0,Math.log2(this.mag)):this.layer===1?W(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?W(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?f.dNaN:this.layer===0?W(this.sign,0,Math.log(this.mag)):this.layer===1?W(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?W(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=w(e),n=this,r=t;if(n.sign===0)return r.eq(0)?Y(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(r.sign===0)return Y(1,0,1);if(r.sign===1&&r.layer===0&&r.mag===1)return n;const i=n.absLog10().mul(r).pow10();return this.sign===-1?Math.abs(r.toNumber()%2)%2===1?i.neg():Math.abs(r.toNumber()%2)%2===0?i:f.dNaN:i}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return f.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return W(1,0,t);if(e.sign===0)return f.dOne;e=Y(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?W(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?W(-e.sign,e.layer+1,-e.mag):f.dOne}pow_base(e){return w(e).pow(this)}root(e){const t=w(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?f.exp(f.mul(this,f.ln(this).sub(1))):f.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(Y(1,0,24)))return f.fromNumber(Ei(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let r=e,i=12*r,a=1/i,u=t+a;if(u===t||(t=u,r=r*n,i=360*r,a=1/i,u=t-a,u===t))return f.exp(t);t=u,r=r*n,i=1260*r;let s=1/i;return t=t+s,r=r*n,i=1680*r,s=1/i,t=t-s,f.exp(t)}else return this.layer===1?f.exp(f.mul(this,f.ln(this).sub(1))):f.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?f.dOne:this.layer===0&&this.mag<=709.7?f.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?W(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?W(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):W(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return f.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return W(1,2,Math.log10(this.mag)-.3010299956639812);{const e=f.div(Y(this.sign,this.layer-1,this.mag),Y(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=Y(1,0,1)){if(e===1)return f.pow(this,t);if(e===0)return new f(t);if(this.eq(f.dOne))return f.dOne;if(this.eq(-1))return f.pow(this,t);if(e===Number.POSITIVE_INFINITY){const i=this.toNumber();if(i<=1.444667861009766&&i>=.06598803584531254){if(i>1.444667861009099)return f.fromNumber(Math.E);const a=f.ln(this).neg();return a.lambertw().div(a)}else return i>1.444667861009766?f.fromNumber(Number.POSITIVE_INFINITY):f.dNaN}if(this.eq(f.dZero)){let i=Math.abs((e+1)%2);return i>1&&(i=2-i),f.fromNumber(i)}if(e<0)return f.iteratedlog(t,this,-e);t=w(t);const n=e;e=Math.trunc(e);const r=n-e;if(this.gt(f.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let i=0;i<e;++i){const a=t;if(t=this.pow(t),a.eq(t))return t}if(r!=0){const i=this.pow(t);return t.mul(1-r).add(i.mul(r))}return t}r!==0&&(t.eq(f.dOne)?this.gt(10)?t=this.pow(r):(t=f.fromNumber(f.tetrate_critical(this.toNumber(),r)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return Y(t.sign,t.layer+(e-i-1),t.mag);if(i>1e4)return t}return t}iteratedexp(e=2,t=Y(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return f.tetrate(e,-t,this);e=w(e);let n=f.fromDecimal(this);const r=t;t=Math.trunc(t);const i=r-t;if(n.layer-e.layer>3){const a=Math.min(t,n.layer-e.layer-3);t-=a,n.layer-=a}for(let a=0;a<t;++a){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(a>1e4)return n}return i>0&&i<1&&(e.eq(10)?n=n.layeradd10(-i):n=n.layeradd(-i,e)),n}slog(e=10,t=100){let n=.001,r=!1,i=!1,a=this.slog_internal(e).toNumber();for(let u=1;u<t;++u){const l=new f(e).tetrate(a).gt(this);if(u>1&&i!=l&&(r=!0),i=l,r?n/=2:n*=2,n=Math.abs(n)*(l?-1:1),a+=n,n===0)break}return f.fromNumber(a)}slog_internal(e=10){if(e=w(e),e.lte(f.dZero)||e.eq(f.dOne))return f.dNaN;if(e.lt(f.dOne))return this.eq(f.dOne)?f.dZero:this.eq(f.dZero)?f.dNegOne:f.dNaN;if(this.mag<0||this.eq(f.dZero))return f.dNegOne;let t=0,n=f.fromDecimal(this);if(n.layer-e.layer>3){const r=n.layer-e.layer-3;t+=r,n.layer-=r}for(let r=0;r<100;++r)if(n.lt(f.dZero))n=f.pow(e,n),t-=1;else{if(n.lte(f.dOne))return f.fromNumber(t+f.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=f.log(n,e)}return f.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:f.critical_section(e,t,Pi)}static tetrate_critical(e,t){return f.critical_section(e,t,Fi)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let r=0,i=0;for(let u=0;u<pt.length;++u)if(pt[u]==e){r=n[u][Math.floor(t)],i=n[u][Math.ceil(t)];break}else if(pt[u]<e&&pt[u+1]>e){const s=(e-pt[u])/(pt[u+1]-pt[u]);r=n[u][Math.floor(t)]*(1-s)+n[u+1][Math.floor(t)]*s,i=n[u][Math.ceil(t)]*(1-s)+n[u+1][Math.ceil(t)]*s;break}const a=t-Math.floor(t);return r<=0||i<=0?r*(1-a)+i*a:Math.pow(e,Math.log(r)/Math.log(e)*(1-a)+Math.log(i)/Math.log(e)*a)}layeradd10(e){e=f.fromValue_noAlloc(e).toNumber();const t=f.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let r=0;r<100;++r){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const r=this.slog(t).toNumber()+e;return r>=0?f.tetrate(t,r):Number.isFinite(r)?r>=-1?f.log(f.tetrate(t,r+1),t):f.log(f.log(f.tetrate(t,r+2),t),t):f.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return f.fromNumber(On(this.toNumber()));if(this.layer===0)return f.fromNumber(On(this.sign*this.mag));if(this.layer===1)return Dn(this);if(this.layer===2)return Dn(this);if(this.layer>=3)return Y(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return Y(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=Y(1,0,1)){t=w(t);const n=e;e=Math.trunc(e);const r=n-e;r!==0&&(t.eq(f.dOne)?(++e,t=f.fromNumber(r)):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(i>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.sin(this.sign*this.mag)):Y(0,0,0)}cos(){return this.mag<0?f.dOne:this.layer===0?f.fromNumber(Math.cos(this.sign*this.mag)):Y(0,0,0)}tan(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.tan(this.sign*this.mag)):Y(0,0,0)}asin(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.asin(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?f.fromNumber(Math.acos(this.toNumber())):this.layer===0?f.fromNumber(Math.acos(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.atan(this.sign*this.mag)):f.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return f.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return f.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?Y(Number.NaN,Number.NaN,Number.NaN):f.ln(this.add(1).div(f.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(f.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let d=f;d.fromStringCache=new Ni($i);d.dZero=Y(0,0,0);d.dOne=Y(1,0,1);d.dNegOne=Y(-1,0,1);d.dTwo=Y(1,0,2);d.dTen=Y(1,0,10);d.dNaN=Y(Number.NaN,Number.NaN,Number.NaN);d.dInf=Y(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);d.dNegInf=Y(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);d.dNumberMax=W(1,0,Number.MAX_VALUE);d.dNumberMin=W(1,0,Number.MIN_VALUE);w=d.fromValue_noAlloc;W=d.fromComponents;Y=d.fromComponents_noNormalize;d.fromMantissaExponent;d.fromMantissaExponent_noNormalize;const Oi=new d(1);function Ot(e,t,n=!0){let r=d.log10(e).floor(),i=d.div(e,d.pow(10,r));i.toStringWithDecimalPlaces(t)==="10"&&(i=Oi,r=r.add(1));const a=r.gte(1e9)?Ge(r,Math.max(Math.max(t,3),X.defaultDecimalsShown)):r.gte(1e4)?Qt(r,0):r.toStringWithDecimalPlaces(0);return n?i.toStringWithDecimalPlaces(t)+"e"+a:"e"+a}function Qt(e,t){if(e==null)return"NaN";if(e=new d(e),e.mag<.001)return 0 .toFixed(t);const r=e.toStringWithDecimalPlaces(t).split(".");return r[0]=r[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),r.length==1?r[0]:r[0]+"."+r[1]}function zn(e,t){return e==null?"NaN":(e=new d(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),X.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const Di=new d("eeee1000"),Vi=new d("e100000"),Vn=new d("e1000"),Un=new d(1e9),Ai=new d(1e6),Li=new d(1e3),Bi=new d(.98),qi=new d(.001),jn=new d(0);function Ge(e,t,n){if(t==null&&(t=X.defaultDecimalsShown),n=n!=null?n:X.defaultShowSmall,e=new d(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+Ge(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(Di)){const r=e.slog();return r.gte(Ai)?"F"+Ge(r.floor()):d.pow(10,r.sub(r.floor())).toStringWithDecimalPlaces(3)+"F"+Qt(r.floor(),0)}else{if(e.gte(Vi))return Ot(e,0,!1);if(e.gte(Vn))return Ot(e,0);if(e.gte(Un))return Ot(e,t);if(e.gte(Li))return Qt(e,0);if(e.gte(qi)||!n)return zn(e,t);if(e.eq(jn))return 0 .toFixed(t)}return e=Wn(e),e.lt(Vn)?Ot(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):Ge(e,t)+"\u207B\xB9"}function oe(e){return e=new d(e),e.sign<0?"-"+oe(e.neg()):e.gte(Un)||e.lte(Bi)&&!e.eq(jn)?Ge(e):Ge(e,0)}function Gn(e){return d.lt(e,0)?"-"+Gn(d.neg(e)):d.gt(e,2**51)?Ge(d.div(e,31536e3))+"y":(e=new d(e).toNumber(),e<60?Ge(e)+"s":e<3600?oe(Math.floor(e/60))+"m "+Ge(e%60)+"s":e<86400?oe(Math.floor(e/3600))+"h "+oe(Math.floor(e/60)%60)+"m "+oe(e%60)+"s":e<31536e3?oe(Math.floor(e/84600)%365)+"d "+oe(Math.floor(e/3600)%24)+"h "+oe(Math.floor(e/60)%60)+"m":oe(Math.floor(e/31536e3))+"y "+oe(Math.floor(e/84600)%365)+"d "+oe(Math.floor(e/3600)%24)+"h")}function Ri(e,t,n){e=new d(e);let r=e.toStringWithDecimalPlaces(t);return new d(r).gte(n)&&(r=d.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),r}function zi(e,t){return Ge(e,t,!0)}function Wn(e){let t=d.log10(e).ceil();const n=d.div(e,d.pow(10,t));return t=t.neg(),e=new d(10).pow(t).times(n),e}var Ui=Object.freeze(Object.defineProperty({__proto__:null,default:d,exponentialFormat:Ot,commaFormat:Qt,regularFormat:zn,format:Ge,formatWhole:oe,formatTime:Gn,toPlaces:Ri,formatSmall:zi,invertOOM:Wn},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:ji,commaFormat:Gi,regularFormat:Wi,format:dt,formatWhole:It,formatTime:an,toPlaces:Hi,formatSmall:Zi,invertOOM:Yi}=Ui;window.Decimal=d;window.exponentialFormat=ji;window.commaFormat=Gi;window.regularFormat=Wi;window.format=dt;window.formatWhole=It;window.formatTime=an;window.toPlaces=Hi;window.formatSmall=Zi;window.invertOOM=Yi;function Ji(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function en(e){return typeof e=="function"}var D=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(D||{});const Rt=Symbol("DoNotCache");function z(e,t){const n=e[t];en(n)&&n.length===0&&!n[Rt]?e[t]=T(n.bind(e)):en(n)&&(e[t]=n.bind(e),e[t][Rt]=!0)}function An(e){return en(e)&&!e[Rt]&&(e=T(e)),e}const on=Symbol("Component"),sn=Symbol("GatherProps");let Xi=0;function Hn(e="feature-"){return e+Xi++}var zt=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(zt||{});function _n(e){const t=c(e);return t!==2&&t!==!1}function Ki(e){return c(e)===1}function Ie(e){return e[Rt]=!0,e}function ke(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function Qi(e,...t){const n=[],r=i=>{Object.keys(i).forEach(a=>{const u=i[a];u!=null&&typeof u=="object"&&(t.includes(u.type)?n.push(u):!(u instanceof d)&&!Le(u)&&r(u))})};return r(e),n}var me=window.state=hn({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:Ft([])});const bt={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var wn=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(wn||{}),Je={classic:bt,paper:{...bt,variables:{...bt.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...bt,variables:{...bt.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...bt,variables:{...bt.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const Te=Bn();"fonts"in document&&(document.fonts.onloadingdone=()=>Te.emit("fontsLoaded"));var ea=Object.freeze(Object.defineProperty({__proto__:null,globalBus:Te},Symbol.toStringTag,{value:"Module"}));function Zn(e={}){return Object.assign({id:`${X.id}-0`,name:"Default Save",tabs:X.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:X.id,modVersion:X.versionNumber,layers:{}},e)}function qe(e){const t=rt.compressToUTF16(bn(e!=null?e:G));return localStorage.setItem((e!=null?e:G).id,t),t}async function ta(){ra();try{let e=localStorage.getItem(ie.active);if(e==null){await wt(xt());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=rt.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==X.id){await wt(xt());return}t.id=ie.active,await wt(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await wt(xt())}}function xt(){const e=Xt(),t=Zn({id:e});return qe(t),ie.saves.push(e),t}function Xt(){let e,t=0;do e=`${X.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const Yn=O(!1);async function wt(e){console.info("Loading save",e),Yn.value=!0;const{layers:t,removeLayer:n,addLayer:r}=await qt(()=>Promise.resolve().then(function(){return es}),void 0),{fixOldSave:i,getInitialLayers:a}=await qt(()=>Promise.resolve().then(function(){return Qu}),void 0);for(const u in t){const s=t[u];s&&n(s)}a(e).forEach(u=>r(u,e)),e=Zn(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,X.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==X.versionNumber&&(i(e.modVersion,e),e.modVersion=X.versionNumber),Object.assign(G,e),ie.active=G.id,Te.emit("onLoad")}setInterval(()=>{G.autosave&&qe()},1e3);window.onbeforeunload=()=>{G.autosave&&qe()};window.save=qe;const na=window.hardReset=async()=>{await wt(xt())};window.deleteLowerSaves=()=>{const e=Object.values(ie.saves).indexOf(G.id)+1;Object.values(ie.saves).slice(e).forEach(t=>localStorage.removeItem(t)),ie.saves=ie.saves.slice(0,e)};const Ut=Ft({active:"",saves:[],showTPS:!0,theme:wn.Nordic,unthrottled:!1,alignUnits:!1});Qe(Ut,e=>{const t=rt.compressToUTF16(JSON.stringify(e));localStorage.setItem(X.id,t)},{deep:!0});var ie=window.settings=Ut;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:wn.Nordic,alignUnits:!1};Te.emit("loadSettings",e),Object.assign(Ut,e),na()};function ra(){try{let e=localStorage.getItem(X.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=rt.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(Ut,t)}Te.emit("loadSettings",Ut)}catch{}}const ia=Ft([]),aa=Ft([]),oa=Ft([]),sa={class:"table"};K({__name:"Column",setup(e){const t=T(()=>Je[ie.theme].mergeAdjacent);return(n,r)=>(N(),M("div",sa,[h("div",{class:ye(["col",{mergeAdjacent:t.value}])},[it(n.$slots,"default")],2)]))}});const la={class:"table"};K({__name:"Row",setup(e){const t=T(()=>Je[ie.theme].mergeAdjacent);return(n,r)=>(N(),M("div",la,[h("div",{class:ye(["row",{mergeAdjacent:t.value}])},[it(n.$slots,"default")],2)]))}});function ht(e,t="span"){return typeof e=="function"?K({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),K({template:e})):K({render:()=>({})}):e}function ut(e){if(Jn(e))return typeof e=="function"?e():ht(e);const t=e[on];return g(t,e[sn](),null)}function ua(e){if(Jn(e))return typeof e=="function"?e():typeof e=="string"?g(he,null,[e]):g(e,null,null);const t=e[on];return g(t,e[sn](),null)}function Jn(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[Rt]===!0}function ca(e,t="div"){const n=Gt();return vn(()=>{n.value=ht(Xe(e),t)}),n}function Wt(e,t="div"){const n=Gt(null);return vn(()=>{const r=Xe(e);n.value=r==""||r==null?null:ht(r,t)}),n}function Xe(e){return c(c(e))}function se(...e){return e.includes(Object)||e.push(Object),e}const da=K({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var y;const n=O({}),r=new ResizeObserver(s),i=O(null);mn(()=>{const v=i.value;v!=null&&r.observe(v)});let a=!0,u=O((y=i.value)==null?void 0:y.getBoundingClientRect());function s(){a&&(a=!1,At(()=>{var v;u.value=(v=i.value)==null?void 0:v.getBoundingClientRect(),Object.values(n.value).filter(b=>b).forEach(b=>b.rect=b.element.getBoundingClientRect()),t("updateNodes",n.value),a=!0}))}Te.on("fontsLoaded",s);const l={attributes:!1,childList:!0,subtree:!1};Yt(Sn,(v,b)=>{const _=new MutationObserver(()=>m(v));_.observe(b,l),n.value[v]={element:b,observer:_,rect:b.getBoundingClientRect()},s()}),Yt(Cn,v=>{var b;(b=n.value[v])==null||b.observer.disconnect(),n.value[v]=void 0,s()}),Yt(Qn,n),Yt(er,u);function m(v){const b=n.value[v];b!=null&&(b.rect=b.element.getBoundingClientRect(),t("updateNodes",n.value))}return(v,b)=>(N(),M(he,null,[it(v.$slots,"default",{},void 0,!0),h("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Xn=le(da,[["__scopeId","data-v-2b1dc1bc"]]);const ga=["onPointerdown"],fa={class:"modal-wrapper"},ma={class:"modal-container"},ha={class:"modal-header"},va={class:"modal-body"},pa={class:"modal-footer"},ba=h("div",{class:"modal-default-flex-grow"},null,-1),at=K({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const i=Be(e),a=T(()=>c(i.modelValue)||s.value);function u(){n("update:modelValue",!1)}const s=O(!1),l=O(null),m=T(()=>{var y,v;return(v=(y=l.value)==null?void 0:y.nodes)!=null?v:null});return t({isOpen:a,nodes:m}),(y,v)=>(N(),J(wr,{to:"#modal-root"},[g(Lt,{name:"modal",onBeforeEnter:v[0]||(v[0]=b=>s.value=!0),onAfterLeave:v[1]||(v[1]=b=>s.value=!1)},{default:j(()=>[pn(h("div",Ct({class:"modal-mask",onPointerdown:Tt(u,["self"])},y.$attrs),[h("div",fa,[h("div",ma,[h("div",ha,[it(y.$slots,"header",{shown:a.value},()=>[$(" default header ")])]),h("div",va,[g(Xn,{ref_key:"contextRef",ref:l},{default:j(()=>[it(y.$slots,"body",{shown:a.value},()=>[$(" default body ")])]),_:3},512)]),h("div",pa,[it(y.$slots,"footer",{shown:a.value},()=>[h("div",{class:"modal-default-footer"},[ba,h("button",{class:"button modal-default-button",onClick:u}," Close ")])])])])])],16,ga),[[_r,y.modelValue]])]),_:3})]))}}),_t=Symbol("ProxyState");function Nn(e,t={}){const n=t;let r=!1,i=!1;function a(){return r||(i&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),i=!0,Object.assign(n,e.call(n,n)),r=!0),n}return new Proxy(n,{get(u,s){if(s===_t)return a();const l=a()[s];return l!=null&&typeof l=="object"&&ct in l?l[ct]:l},set(u,s,l){return a()[s]=l,!0},has(u,s){return s===_t?!0:Reflect.has(a(),s)},ownKeys(){return Reflect.ownKeys(a())},getOwnPropertyDescriptor(u,s){return r||(Object.assign(n,e.call(n,n)),r=!0),Object.getOwnPropertyDescriptor(u,s)}})}const Kn=d.ln(10);function Dt(e){return e}function ya(e,t){return I(t)?t.invert(d.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function _a(e,t){return I(t)?t.isIntegrable()?o.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),o.constant(0)):(console.error("Could not integrate due to no input being a variable"),o.constant(0))}function wa(e){return o.neg(e)}function Na(e,t,n){return I(t)?t.invert(d.sub(e,ve(n))):I(n)?n.invert(d.sub(e,ve(t))):(console.error("Could not invert due to no input being a variable"),0)}function Sa(e,t,n){var r,i;if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const a=t.getIntegralFormula(e);return o.times(n,(r=t.innermostVariable)!=null?r:0).add(a)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const a=n.getIntegralFormula(e);return o.times(t,(i=n.innermostVariable)!=null?i:0).add(a)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ca(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.add(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e);return o.add(r,t)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function ka(e,t,n){return I(t)?t.invert(d.add(e,ve(n))):I(n)?n.invert(d.sub(ve(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Ma(e,t,n){var r,i;if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const a=t.getIntegralFormula(e);return o.sub(a,o.times(n,(r=t.innermostVariable)!=null?r:0))}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const a=n.getIntegralFormula(e);return o.times(t,(i=n.innermostVariable)!=null?i:0).sub(a)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ia(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.sub(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e);return o.sub(r,t)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function xa(e,t,n){return I(t)?t.invert(d.div(e,ve(n))):I(n)?n.invert(d.div(e,ve(t))):(console.error("Could not invert due to no input being a variable"),0)}function $a(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.times(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e);return o.times(r,t)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ta(e,t,n){return I(t)?o.div(e,n):I(n)?o.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),o.constant(0))}function Fa(e,t,n){return I(t)?t.invert(d.mul(e,ve(n))):I(n)?n.invert(d.div(ve(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Pa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.div(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e);return o.div(t,r)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ea(e,t,n){return I(t)?o.mul(e,n):I(n)?o.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),o.constant(0))}function Oa(e,t){return I(t)?t.invert(d.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function Da(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.ln(n)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Va(e,t){return I(t)?t.invert(d.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function Aa(e){return d.ln(e).sub(1).times(e).div(Kn)}function La(e,t){if(I(t)){const n=Kn.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ba(e,t){return I(t)?t.isIntegrable()?new o({inputs:[t.getIntegralFormula(e)],evaluate:Aa,invert:La}):(console.error("Could not integrate due to variable not being integrable"),o.constant(0)):(console.error("Could not integrate due to no input being a variable"),o.constant(0))}function qa(e,t,n){return I(t)?t.invert(d.pow(ve(n),e)):I(n)?n.invert(d.root(ve(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Ra(e,t){return d.ln(e).sub(1).times(e).div(d.ln(t))}function za(e,t,n){if(I(t)){const r=d.ln(ve(n)).times(e);return t.invert(r.div(r.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ua(e,t,n){return I(t)?t.isIntegrable()?new o({inputs:[t.getIntegralFormula(e),n],evaluate:Ra,invert:za}):(console.error("Could not integrate due to variable not being integrable"),o.constant(0)):(console.error("Could not integrate due to no input being a variable"),o.constant(0))}function ja(e,t){return I(t)?t.invert(d.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function Ga(e){return d.ln(e).sub(1).times(e).div(d.ln(2))}function Wa(e,t){if(I(t)){const n=d.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ha(e,t){return I(t)?t.isIntegrable()?new o({inputs:[t.getIntegralFormula(e)],evaluate:Ga,invert:Wa}):(console.error("Could not integrate due to variable not being integrable"),o.constant(0)):(console.error("Could not integrate due to no input being a variable"),o.constant(0))}function Za(e,t){return I(t)?t.invert(d.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ya(e){return d.ln(e).sub(1).times(e)}function Ja(e,t){return I(t)?t.invert(d.div(e,d.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Xa(e,t){return I(t)?t.isIntegrable()?new o({inputs:[t.getIntegralFormula(e)],evaluate:Ya,invert:Ja}):(console.error("Could not integrate due to variable not being integrable"),o.constant(0)):(console.error("Could not integrate due to no input being a variable"),o.constant(0))}function Ka(e,t,n){return I(t)?t.invert(d.root(e,ve(n))):I(n)?n.invert(d.ln(e).div(d.ln(ve(t)))):(console.error("Could not invert due to no input being a variable"),0)}function Qa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e),i=o.add(n,1);return o.pow(r,i).div(i)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e);return o.pow(t,r).div(o.ln(t))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function eo(e,t){return I(t)?t.invert(d.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function to(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.pow10(n).div(o.ln(10))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function no(e,t,n){return I(t)?t.invert(d.ln(e).div(d.ln(ve(n)))):I(n)?n.invert(d.root(ve(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function ro(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.pow(n,r).div(o.ln(n))}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=n.getIntegralFormula(e),i=o.add(t,1);return o.pow(r,i).div(i)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function io(e,t,n){return I(t)?t.invert(d.root(e,d.recip(ve(n)))):I(n)?n.invert(d.ln(ve(t)).div(d.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const r=t.getIntegralFormula(e);return o.pow(r,o.recip(n).add(1)).times(n).div(o.add(n,1))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function oo(e,t){return I(t)?t.invert(d.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function so(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.exp(n)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function lo(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){const r=d.minabs(t,1e308).toNumber();return d.tetrate(e,r,n)}function uo(e,t,n,r){return I(t)?t.invert(d.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function co(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){const r=d.minabs(t,1e308).toNumber();return d.iteratedexp(e,r,new d(n))}function go(e,t,n,r){return I(t)?t.invert(d.iteratedlog(e,Math.E,d.minabs(1e308,ve(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function fo(e,t=10,n=2){const r=d.minabs(n,1e308).toNumber();return d.iteratedlog(e,t,r)}function mo(e,t=10){const n=d.minabs(t,1e308).toNumber();return d.slog(e,n)}function ho(e,t,n){return I(t)?t.invert(d.tetrate(e,d.minabs(1e308,ve(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function vo(e,t,n){const r=d.minabs(t,1e308).toNumber();return d.layeradd(e,r,n)}function po(e,t,n,r){return I(t)?t.invert(d.layeradd(e,d.minabs(1e308,ve(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function bo(e,t){return I(t)?t.invert(d.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function yo(e,t){return I(t)?t.invert(d.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function _o(e,t,n){const r=d.minabs(t,1e308).toNumber();return d.pentate(e,r,n)}function wo(e,t){return I(t)?t.invert(d.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function No(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function So(e,t){return I(t)?t.invert(d.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function Co(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.sin(n)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function ko(e,t){return I(t)?t.invert(d.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Mo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Io(e,t){return I(t)?t.invert(d.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function xo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.asin(n).times(n).add(o.sqrt(o.sub(1,o.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function $o(e,t){return I(t)?t.invert(d.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function To(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.acos(n).times(n).sub(o.sqrt(o.sub(1,o.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Fo(e,t){return I(t)?t.invert(d.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Po(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.atan(n).times(n).sub(o.ln(o.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Eo(e,t){return I(t)?t.invert(d.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Oo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.cosh(n)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Do(e,t){return I(t)?t.invert(d.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Vo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.sinh(n)}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ao(e,t){return I(t)?t.invert(d.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Lo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Bo(e,t){return I(t)?t.invert(d.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function qo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.asinh(n).times(n).sub(o.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Ro(e,t){return I(t)?t.invert(d.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function zo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.acosh(n).times(n).sub(o.add(n,1).sqrt().times(o.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Uo(e,t){return I(t)?t.invert(d.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function jo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),o.constant(0);const n=t.getIntegralFormula(e);return o.atanh(n).times(n).add(o.sub(1,o.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),o.constant(0)}function Pt(e){return(t,n)=>new o({inputs:[t,n],evaluate:e,invert:Dt})}function I(e){return e instanceof de&&e.hasVariable()}function ve(e,t){return e instanceof de?e.evaluate(t):c(e)}function Go(){return o.pow(this,2).div(2)}function Wo(){return this}const be=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&ct in n?n[ct]:n)),"variable"in e?(typeof e.variable=="object"&&ct in e.variable&&(e.variable=e.variable[ct]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:Go,internalIntegrateInner:Wo,applySubstitution:Dt}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var b,_;const{inputs:t,evaluate:n,invert:r,integrate:i,integrateInner:a,applySubstitution:u}=e,s=t.reduce((p,S)=>p+(S instanceof be?S.internalVariables:0),0),l=t.find(p=>p instanceof be&&p.hasVariable()),m=s===1?l==null?void 0:l.innermostVariable:void 0,y=(b=l==null?void 0:l.isInvertible())!=null?b:!1,v=(_=l==null?void 0:l.isIntegrable())!=null?_:!1;return{inputs:t,internalEvaluate:n,internalInvert:y?r:void 0,internalIntegrate:v?i:void 0,internalIntegrateInner:a,applySubstitution:u,innermostVariable:m,internalVariables:s}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,r;return(r=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(i=>ve(i,e))))!=null?n:this.hasVariable()?e:null)!=null?r:ve(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof be&&e.inputs[n]instanceof be?t.equals(e.inputs[n]):!(t instanceof be)&&!(e.inputs[n]instanceof be)&&d.eq(c(t),c(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new o({inputs:[e]})}static variable(e){return new o({variable:e})}static step(e,t,n){const r=n(o.variable(0)),i=An(t);function a(s){return d.lt(s,c(i))?s:d.add(r.evaluate(d.sub(s,c(i))),c(i))}function u(s,l){return I(l)&&r.isInvertible()?(d.gt(s,c(i))&&(s=d.add(r.invert(d.sub(s,c(i))),c(i))),l.invert(s)):(console.error("Could not invert due to no input being a variable"),0)}return new o({inputs:[e],evaluate:a,invert:r.isInvertible()&&r.hasVariable()?u:void 0})}static if(e,t,n,r){const i=O(0),a=o.variable(i),u=n(a),s=r==null?void 0:r(a),l=An(t);function m(v){return c(l)?(i.value=v,u.evaluate()):s?(i.value=v,s.evaluate()):v}function y(v,b){return!I(b)||!u.isInvertible()||s!=null&&!s.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):c(l)?b.invert(u.invert(v)):s?b.invert(s.invert(v)):b.invert(v)}return new o({inputs:[e],evaluate:m,invert:u.isInvertible()&&u.hasVariable()?y:void 0})}static conditional(e,t,n,r){return o.if(e,t,n,r)}static abs(e){return new o({inputs:[e],evaluate:d.abs})}static neg(e){return new o({inputs:[e],evaluate:d.neg,invert:ya,applySubstitution:wa,integrate:_a})}static sign(e){return new o({inputs:[e],evaluate:d.sign})}static round(e){return new o({inputs:[e],evaluate:d.round})}static floor(e){return new o({inputs:[e],evaluate:d.floor})}static ceil(e){return new o({inputs:[e],evaluate:d.ceil})}static trunc(e){return new o({inputs:[e],evaluate:d.trunc})}static add(e,t){return new o({inputs:[e,t],evaluate:d.add,invert:Na,integrate:Sa,integrateInner:Ca,applySubstitution:Dt})}static sub(e,t){return new o({inputs:[e,t],evaluate:d.sub,invert:ka,integrate:Ma,integrateInner:Ia,applySubstitution:Dt})}static mul(e,t){return new o({inputs:[e,t],evaluate:d.mul,invert:xa,integrate:$a,applySubstitution:Ta})}static div(e,t){return new o({inputs:[e,t],evaluate:d.div,invert:Fa,integrate:Pa,applySubstitution:Ea})}static recip(e){return new o({inputs:[e],evaluate:d.recip,invert:Oa,integrate:Da})}static clamp(e,t,n){return new o({inputs:[e,t,n],evaluate:d.clamp,invert:Dt})}static pLog10(e){return new o({inputs:[e],evaluate:d.pLog10})}static absLog10(e){return new o({inputs:[e],evaluate:d.absLog10})}static log10(e){return new o({inputs:[e],evaluate:d.log10,invert:Va,integrate:Ba})}static log(e,t){return new o({inputs:[e,t],evaluate:d.log,invert:qa,integrate:Ua})}static log2(e){return new o({inputs:[e],evaluate:d.log2,invert:ja,integrate:Ha})}static ln(e){return new o({inputs:[e],evaluate:d.ln,invert:Za,integrate:Xa})}static pow(e,t){return new o({inputs:[e,t],evaluate:d.pow,invert:Ka,integrate:Qa})}static pow10(e){return new o({inputs:[e],evaluate:d.pow10,invert:eo,integrate:to})}static pow_base(e,t){return new o({inputs:[e,t],evaluate:d.pow_base,invert:no,integrate:ro})}static root(e,t){return new o({inputs:[e,t],evaluate:d.root,invert:io,integrate:ao})}static factorial(e){return new o({inputs:[e],evaluate:d.factorial})}static gamma(e){return new o({inputs:[e],evaluate:d.gamma})}static lngamma(e){return new o({inputs:[e],evaluate:d.lngamma})}static exp(e){return new o({inputs:[e],evaluate:d.exp,invert:oo,integrate:so})}static sqr(e){return o.pow(e,2)}static sqrt(e){return o.root(e,2)}static cube(e){return o.pow(e,3)}static cbrt(e){return o.root(e,3)}static tetrate(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new o({inputs:[e,t,n],evaluate:lo,invert:uo})}static iteratedexp(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new o({inputs:[e,t,n],evaluate:co,invert:go})}static iteratedlog(e,t=10,n=1){return new o({inputs:[e,t,n],evaluate:fo})}static slog(e,t=10){return new o({inputs:[e,t],evaluate:mo,invert:ho})}static layeradd10(e,t){return new o({inputs:[e,t],evaluate:d.layeradd10})}static layeradd(e,t,n=10){return new o({inputs:[e,t,n],evaluate:vo,invert:po})}static lambertw(e){return new o({inputs:[e],evaluate:d.lambertw,invert:bo})}static ssqrt(e){return new o({inputs:[e],evaluate:d.ssqrt,invert:yo})}static pentate(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new o({inputs:[e,t,n],evaluate:_o})}static sin(e){return new o({inputs:[e],evaluate:d.sin,invert:Io,integrate:No})}static cos(e){return new o({inputs:[e],evaluate:d.cos,invert:$o,integrate:Co})}static tan(e){return new o({inputs:[e],evaluate:d.tan,invert:Fo,integrate:Mo})}static asin(e){return new o({inputs:[e],evaluate:d.asin,invert:wo,integrate:xo})}static acos(e){return new o({inputs:[e],evaluate:d.acos,invert:So,integrate:To})}static atan(e){return new o({inputs:[e],evaluate:d.atan,invert:ko,integrate:Po})}static sinh(e){return new o({inputs:[e],evaluate:d.sinh,invert:Bo,integrate:Oo})}static cosh(e){return new o({inputs:[e],evaluate:d.cosh,invert:Ro,integrate:Vo})}static tanh(e){return new o({inputs:[e],evaluate:d.tanh,invert:Uo,integrate:Lo})}static asinh(e){return new o({inputs:[e],evaluate:d.asinh,invert:Eo,integrate:qo})}static acosh(e){return new o({inputs:[e],evaluate:d.acosh,invert:Do,integrate:zo})}static atanh(e){return new o({inputs:[e],evaluate:d.atanh,invert:Ao,integrate:jo})}step(e,t){return o.step(this,e,t)}if(e,t){return o.if(this,e,t)}conditional(e,t){return o.if(this,e,t)}abs(){return o.abs(this)}neg(){return o.neg(this)}sign(){return o.sign(this)}round(){return o.round(this)}floor(){return o.floor(this)}ceil(){return o.ceil(this)}trunc(){return o.trunc(this)}add(e){return o.add(this,e)}sub(e){return o.sub(this,e)}mul(e){return o.mul(this,e)}div(e){return o.div(this,e)}recip(){return o.recip(this)}max(e){return o.max(this,e)}min(e){return o.min(this,e)}maxabs(e){return o.maxabs(this,e)}minabs(e){return o.minabs(this,e)}clamp(e,t){return o.clamp(this,e,t)}clampMin(e){return o.clampMin(this,e)}clampMax(e){return o.clampMax(this,e)}pLog10(){return o.pLog10(this)}absLog10(){return o.absLog10(this)}log10(){return o.log10(this)}log(e){return o.log(this,e)}log2(){return o.log2(this)}ln(){return o.ln(this)}pow(e){return o.pow(this,e)}pow10(){return o.pow10(this)}pow_base(e){return o.pow_base(this,e)}root(e){return o.root(this,e)}factorial(){return o.factorial(this)}gamma(){return o.gamma(this)}lngamma(){return o.lngamma(this)}exp(){return o.exp(this)}sqr(){return o.pow(this,2)}sqrt(){return o.root(this,2)}cube(){return o.pow(this,3)}cbrt(){return o.root(this,3)}tetrate(e=2,t=d.fromComponents_noNormalize(1,0,1)){return o.tetrate(this,e,t)}iteratedexp(e=2,t=d.fromComponents_noNormalize(1,0,1)){return o.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return o.iteratedlog(this,e,t)}slog(e=10){return o.slog(this,e)}layeradd10(e){return o.layeradd10(this,e)}layeradd(e,t){return o.layeradd(this,e,t)}lambertw(){return o.lambertw(this)}ssqrt(){return o.ssqrt(this)}pentate(e=2,t=d.fromComponents_noNormalize(1,0,1)){return o.pentate(this,e,t)}sin(){return o.sin(this)}cos(){return o.cos(this)}tan(){return o.tan(this)}asin(){return o.asin(this)}acos(){return o.acos(this)}atan(){return o.atan(this)}sinh(){return o.sinh(this)}cosh(){return o.cosh(this)}tanh(){return o.tanh(this)}asinh(){return o.asinh(this)}acosh(){return o.acosh(this)}atanh(){return o.atanh(this)}};let de=be;de.negate=be.neg;de.negated=be.neg;de.sgn=be.sign;de.plus=be.add;de.subtract=be.sub;de.minus=be.sub;de.multiply=be.mul;de.times=be.mul;de.divide=be.div;de.divideBy=be.div;de.dividedBy=be.div;de.reciprocal=be.recip;de.reciprocate=be.recip;de.max=Pt(d.max);de.min=Pt(d.min);de.minabs=Pt(d.minabs);de.maxabs=Pt(d.maxabs);de.clampMin=Pt(d.clampMin);de.clampMax=Pt(d.clampMax);de.logarithm=be.log;class o extends de{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=d.add(this.evaluate(0),this.evaluate(1)).div(2);return d.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),o.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(r=>n=r(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),o.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),o.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),o.constant(0)))}}const $t=Symbol("PersistentState"),jt=Symbol("DefaultValue"),tn=Symbol("StackTrace"),nn=Symbol("Deleted"),ct=Symbol("NonPersistent"),Nt=Symbol("SaveDataPath"),Ho=Symbol("SkipPersistence");function Zo(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function Ln(e,t){var n;d.isNaN(t)&&(me.hasNaN||(G.autosave=!1,me.hasNaN=!0,me.NaNPath=e[Nt],me.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[Nt])==null?void 0:n.join(".")}`)),e[$t].value=t}function Me(e,t=!0){const n=Le(e)?e:O(e);Le(e)&&(e=e.value);const r=T({get(){return n.value},set(a){t?Ln(i,a):i[$t].value=a}});r[jt]=e;const i={get value(){return n.value},set value(a){t?Ln(i,a):i[$t].value=a},__v_isRef:!0,[$t]:n,[jt]:e,[tn]:Zo(),[nn]:!1,[ct]:r,[Nt]:void 0};return Ae.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",i,`
Created at:
`+i[tn]):St[Ae[Ae.length-1]].add(i),i}function Yo(e){return e!=null&&typeof e=="object"&&$t in e}function Jo(e){Ae.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):St[Ae[Ae.length-1]].delete(e),e[nn]=!0}Te.on("addLayer",(e,t)=>{const n=[],r=(i,a=[])=>{let u=!1;return Object.keys(i).forEach(s=>{let l=i[s];if(l!=null&&typeof l=="object"){if(l[Ho]===!0)return;if(_t in l&&(l=l[_t]),Yo(l)){if(u=!0,l[nn]){console.warn("Deleted persistent ref present in returned object. Ignoring...",l,`
Created at:
`+l[tn]);return}St[e.id].delete(l);const m=[e.id,...a,s];l[Nt]!=null&&JSON.stringify(m)!==JSON.stringify(l[Nt])&&console.error(`Persistent ref is being saved to \`${m.join(".")}\` when it's already present at \`${l[Nt].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),l[Nt]=m;const y=a.reduce((b,_)=>(_ in b||(b[_]={}),b[_]),t),v=y[s];y[s]=l[$t],Nr(y)?v!=null?y[s]=v:y[s]=l[jt]:v!=null?y[s].value=v:y[s].value=l[jt]}else!(l instanceof d)&&!(l instanceof o)&&!Le(l)&&!n.includes(l)&&(typeof l.type=="symbol"&&n.push(l),r(l,[...a,s])&&($n(l)&&!$n(i)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",_t in i?i[_t]:i,s):u=!0))}}),u};r(e[_t]),St[e.id].forEach(i=>{i[nn]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+i[tn])}),St[e.id].clear()});const Sn=Symbol("RegisterNode"),Cn=Symbol("UnregisterNode"),Qn=Symbol("Nodes"),er=Symbol("Bounds"),Oe=hn({});window.layers=Oe;const St={},Ae=[];function kn(e,t){return Nn(()=>{const n={},r=n.emitter=Bn();if(n.on=r.on.bind(r),n.emit=r.emit.bind(r),n.nodes=O({}),n.id=e,Ae.push(e),St[e]=new Set,n.minimized=Me(!1,!1),Object.assign(n,t.call(n,n)),Ae[Ae.length-1]==null||Ae[Ae.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${Ae}
Trying to pop ${n.id}`);Ae.pop(),z(n,"color"),z(n,"display"),z(n,"classes"),z(n,"style"),z(n,"name"),ke(n,"name",n.id),z(n,"minWidth"),ke(n,"minWidth",600),z(n,"minimizable"),ke(n,"minimizable",!0),z(n,"minimizedDisplay");const i=n.style;return n.style=T(()=>{var u,s;let a=c(n.minWidth);return(typeof a=="number"||!Number.isNaN(parseInt(a)))&&(a=a+"px"),[(u=c(i))!=null?u:"",(s=n.minimized)!=null&&s.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:a,flexBasis:a,margin:""}]}),n})}function tr(e,t){if(console.info("Adding layer",e.id),Oe[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Oe[e.id]);return}ke(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Oe[e.id]=e,Te.emit("addLayer",e,t.layers[e.id])}function Xo(e){return Oe[e]}function nr(e){console.info("Removing layer",e.id),Te.emit("removeLayer",e),Oe[e.id]=void 0}function Ko(e){nr(e),tr(e,G)}function Qo(e){const t=O(!1);return{openModal:()=>t.value=!0,modal:Ie(()=>g(at,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>g("h2",null,[c(e.name)]),body:c(e.display)}))}}Te.on("update",function(t){Object.values(Oe).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Oe).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Oe).forEach(n=>{n==null||n.emit("postUpdate",t)})});var es=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:Sn,UnregisterNodeInjectionKey:Cn,NodesInjectionKey:Qn,BoundsInjectionKey:er,layers:Oe,persistentRefs:St,addingLayers:Ae,createLayer:kn,addLayer:tr,getLayer:Xo,removeLayer:nr,reloadLayer:Ko,setupLayerModal:Qo},Symbol.toStringTag,{value:"Module"}));const ts=K({components:{Context:Xn,ErrorVue:qn},props:{index:{type:Number,required:!0},display:{type:se(Object,String,Function),required:!0},minimizedDisplay:se(Object,String,Function),minimized:{type:Object,required:!0},name:{type:se(String),required:!0},color:se(String),minimizable:se(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:r,minimizedDisplay:i}=Be(e),a=ca(t),u=Wt(i),s=T(()=>X.allowGoBack&&n.value>0&&!Xe(r));function l(){G.tabs.splice(c(e.index),1/0)}function m(v){e.nodes.value=v}const y=O([]);return Sr((v,b,_)=>(console.warn(`Error caught in "${e.name}" layer`,v,b,_),y.value.push(v instanceof Error?v:new Error(JSON.stringify(v))),!1)),{component:a,minimizedComponent:u,showGoBack:s,updateNodes:m,unref:c,goBack:l,errors:y}}}),ns={key:1};function rs(e,t,n,r,i,a){const u=Bt("ErrorVue"),s=Bt("Context");return e.errors.length>0?(N(),J(u,{key:0,errors:e.errors},null,8,["errors"])):(N(),M("div",Ct({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(N(),M("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...l)=>e.goBack&&e.goBack(...l))},"\u274C")):A("",!0),e.unref(e.minimized)?(N(),M("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=l=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(N(),J(We(e.minimizedComponent),{key:0})):(N(),M("div",ns,Z(e.unref(e.name)),1))])):(N(),M("div",{key:2,class:ye(["layer-tab",{showGoBack:e.showGoBack}])},[g(s,{onUpdateNodes:e.updateNodes},{default:j(()=>[(N(),J(We(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(N(),M("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=l=>e.$emit("setMinimized",!0))}," \u25BC ")):A("",!0)],16))}var is=le(ts,[["render",rs],["__scopeId","data-v-a9f5b1da"]]);const rr=e=>(ft("data-v-4b4bda40"),e=e(),mt(),e),as=rr(()=>h("h2",null,"Changelog",-1)),os=rr(()=>h("details",{open:""},[h("summary",null,[$("v0.0 Initial Commit - "),h("time",null,"2021-09-04")]),$(" This is the first release :D "),h("ul",null,[h("li",{class:"feature"},"Did everything"),h("li",{class:"fix"},"Had some fun"),h("li",{class:"breaking"},"Removed everything"),h("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),ss=K({__name:"Changelog",setup(e,{expose:t}){const n=O(!1);return t({open(){n.value=!0}}),(r,i)=>(N(),J(at,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},{header:j(()=>[as]),body:j(()=>[os]),_:1},8,["modelValue"]))}});var ls=le(ss,[["__scopeId","data-v-4b4bda40"]]),us=K({props:{element:Object,display:{type:se(Object,String,Function),required:!0},style:se(Object,String,Array),classes:se(Object),direction:se(String),xoffset:se(String),yoffset:se(String),pinned:Object},setup(e){const{element:t,display:n,pinned:r}=Be(e),i=O(!1),a=T(()=>(Xe(r)||i.value)&&u.value),u=Wt(n),s=Gt(ht(Ie(()=>{const y=Xe(t);return y==null?"":ua(y)})));function l(y){const v=r;y.shiftKey&&v&&(v.value=!v.value,y.stopPropagation(),y.preventDefault())}const m=T(()=>Xe(r)&&Je[ie.theme].showPin);return{Direction:D,isHovered:i,isShown:a,comp:u,elementComp:s,unref:c,togglePinned:l,showPin:m}}});const cs={key:0,class:"material-icons pinned"};function ds(e,t,n,r,i,a){return N(),M("div",{class:ye(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=u=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=u=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...u)=>e.togglePinned&&e.togglePinned(...u))},[it(e.$slots,"default",{},void 0,!0),e.elementComp?(N(),J(We(e.elementComp),{key:0})):A("",!0),g(Lt,{name:"fade"},{default:j(()=>{var u;return[e.isShown?(N(),M("div",{key:0,class:ye(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:Re([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(u=e.unref(e.style))!=null?u:{}])},[e.showPin?(N(),M("span",cs,"push_pin")):A("",!0),e.comp?(N(),J(We(e.comp),{key:1})):A("",!0)],6)):A("",!0)]}),_:1})],34)}var Se=le(us,[["render",ds],["__scopeId","data-v-6102fa3a"]]);const kt=e=>(ft("data-v-1d8b74fd"),e=e(),mt(),e),gs={class:"info-modal-header"},fs=["src","alt"],ms={class:"info-modal-title"},hs={key:0},vs={key:0},ps={key:0},bs=kt(()=>h("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),ys=kt(()=>h("br",null,null,-1)),_s=kt(()=>h("br",null,null,-1)),ws=["href"],Ns=kt(()=>h("span",{class:"material-icons info-modal-discord"},"discord",-1)),Ss=kt(()=>h("div",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),$(" The Paper Pilot Community ")])],-1)),Cs=kt(()=>h("div",null,[h("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),$(" The Modding Tree ")])],-1)),ks=kt(()=>h("br",null,null,-1));var Ms=K({__name:"Info",props:{changelog:{}},setup(e,{expose:t}){const n=e,{title:r,logo:i,author:a,discordName:u,discordLink:s,versionNumber:l,versionTitle:m}=X,y=Be(n),v=O(!1),b=T(()=>an(G.timePlayed)),_=T(()=>ht(Ie(()=>g(he,null,[aa.map(ut)]))));t({open(){v.value=!0}});function p(){var S;console.log(y.changelog),(S=c(y.changelog))==null||S.open()}return(S,L)=>(N(),J(at,{modelValue:v.value,"onUpdate:modelValue":L[0]||(L[0]=P=>v.value=P)},{header:j(()=>[h("div",gs,[c(i)?(N(),M("img",{key:0,class:"info-modal-logo",src:c(i),alt:c(r)},null,8,fs)):A("",!0),h("div",ms,[h("h2",null,Z(c(r)),1),h("h4",null,[$(" v"+Z(c(l)),1),c(m)?(N(),M("span",hs,": "+Z(c(m)),1)):A("",!0)])])])]),body:j(({shown:P})=>[P?(N(),M("div",vs,[c(a)?(N(),M("div",ps,"By "+Z(c(a)),1)):A("",!0),bs,ys,h("div",{class:"link",onClick:p},"Changelog"),_s,h("div",null,[c(s)?(N(),M("a",{key:0,href:c(s),class:"info-modal-discord-link",target:"_blank"},[Ns,$(" "+Z(c(u)),1)],8,ws)):A("",!0)]),Ss,Cs,ks,h("div",null,"Time Played: "+Z(b.value),1),(N(),J(We(_.value)))])):A("",!0)]),_:1},8,["modelValue"]))}});var Is=le(Ms,[["__scopeId","data-v-1d8b74fd"]]);const xs={class:"field"},$s={key:0,class:"field-title"},ir=K({__name:"Select",props:{title:{type:[String,Object,Function]},modelValue:{},options:{},placeholder:{},closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var u;const n=e,r=Wt(gt(n,"title"),"span"),i=O((u=n.options.find(s=>s.value===n.modelValue))!=null?u:null);Qe(gt(n,"modelValue"),s=>{var l;Xe(i)!==s&&(i.value=(l=n.options.find(m=>m.value===s))!=null?l:null)});function a(s){t("update:modelValue",s.value)}return(s,l)=>(N(),M("div",xs,[c(r)?(N(),M("span",$s,[(N(),J(We(c(r))))])):A("",!0),g(c(xr),{options:s.options,modelValue:i.value,"onUpdate:modelValue":[l[0]||(l[0]=m=>i.value=m),a],min:1,"label-by":"label",placeholder:s.placeholder,"close-on-select":s.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const Ts={class:"field"},Fs=K({__name:"Toggle",props:{title:{type:[String,Object,Function]},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,r=T(()=>{var a;return ht((a=c(n.title))!=null?a:"<span></span>","span")}),i=T({get(){return!!n.modelValue},set(a){t("update:modelValue",a)}});return(a,u)=>(N(),M("label",Ts,[pn(h("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":u[0]||(u[0]=s=>i.value=s)},null,512),[[Cr,i.value]]),(N(),J(We(r.value)))]))}});var tt=le(Fs,[["__scopeId","data-v-11046116"]]);const Ps={class:"header"},Es=h("h2",null,"Settings",-1),Os={class:"option-tabs"},Ds={key:0},Vs={key:1};var As=K({__name:"Options",setup(e,{expose:t}){const n=O(!1),r=O("behaviour");function i(ge){return ge==r.value}function a(ge){r.value=ge}t({isTab:i,setTab:a,save:qe,open(){n.value=!0}});const u=Object.keys(Je).map(ge=>({label:Ji(ge),value:ge})),s=T(()=>ht(Ie(()=>g(he,null,[ia.map(ut)])))),{showTPS:l,theme:m,unthrottled:y,alignUnits:v}=Be(ie),{autosave:b,offlineProd:_}=Be(G),p=T({get(){return G.devSpeed===0},set(ge){G.devSpeed=ge?0:null}}),S=Ie(()=>g("span",{class:"option-title"},[$("Unthrottled"),g("desc",null,[$("Allow the game to run as fast as possible. Not battery friendly.")])])),L=Ie(()=>g("span",{class:"option-title"},[$("Offline Production"),g(Se,{display:"Save-specific",direction:D.Right},{default:()=>[$("*")]}),g("desc",null,[$("Simulate production that occurs while the game is closed.")])])),P=Ie(()=>g("span",{class:"option-title"},[$("Autosave"),g(Se,{display:"Save-specific",direction:D.Right},{default:()=>[$("*")]}),g("desc",null,[$("Automatically save the game every second or when the game is closed.")])])),C=Ie(()=>g("span",{class:"option-title"},[$("Pause game"),g(Se,{display:"Save-specific",direction:D.Right},{default:()=>[$("*")]}),g("desc",null,[$("Stop everything from moving.")])])),x=Ie(()=>g("span",{class:"option-title"},[$("Theme"),g("desc",null,[$("How the game looks.")])])),V=Ie(()=>g("span",{class:"option-title"},[$("Show TPS"),g("desc",null,[$("Show TPS meter at the bottom-left corner of the page.")])])),ae=Ie(()=>g("span",{class:"option-title"},[$("Align modifier units"),g("desc",null,[$("Align numbers to the beginning of the unit in modifier view.")])]));return(ge,ne)=>(N(),J(at,{modelValue:n.value,"onUpdate:modelValue":ne[10]||(ne[10]=re=>n.value=re)},{header:j(()=>[h("div",Ps,[Es,h("div",Os,[h("button",{class:ye({selected:i("behaviour")}),onClick:ne[0]||(ne[0]=re=>a("behaviour"))},"Behaviour",2),h("button",{class:ye({selected:i("appearance")}),onClick:ne[1]||(ne[1]=re=>a("appearance"))},"Appearance",2)])])]),body:j(()=>[i("behaviour")?(N(),M("div",Ds,[g(tt,{title:c(S),modelValue:c(y),"onUpdate:modelValue":ne[2]||(ne[2]=re=>Le(y)?y.value=re:null)},null,8,["title","modelValue"]),c(X).enablePausing?(N(),J(tt,{key:0,title:c(C),modelValue:p.value,"onUpdate:modelValue":ne[3]||(ne[3]=re=>p.value=re)},null,8,["title","modelValue"])):A("",!0),c(X).offlineLimit>0?(N(),J(tt,{key:1,title:c(L),modelValue:c(_),"onUpdate:modelValue":ne[4]||(ne[4]=re=>Le(_)?_.value=re:null)},null,8,["title","modelValue"])):A("",!0),g(tt,{title:c(P),modelValue:c(b),"onUpdate:modelValue":ne[5]||(ne[5]=re=>Le(b)?b.value=re:null)},null,8,["title","modelValue"]),c(b)?A("",!0):(N(),J(yn,{key:2,class:"button save-button",onClick:ne[6]||(ne[6]=re=>c(qe)())},{default:j(()=>[$("Manually save")]),_:1}))])):A("",!0),i("appearance")?(N(),M("div",Vs,[g(ir,{title:c(x),options:c(u),modelValue:c(m),"onUpdate:modelValue":ne[7]||(ne[7]=re=>Le(m)?m.value=re:null)},null,8,["title","options","modelValue"]),(N(),J(We(s.value))),g(tt,{title:c(V),modelValue:c(l),"onUpdate:modelValue":ne[8]||(ne[8]=re=>Le(l)?l.value=re:null)},null,8,["title","modelValue"]),g(tt,{title:c(ae),modelValue:c(v),"onUpdate:modelValue":ne[9]||(ne[9]=re=>Le(v)?v.value=re:null)},null,8,["title","modelValue"])])):A("",!0)]),_:1},8,["modelValue"]))}});const Ls=["onSubmit"],Bs={class:"field"},qs={key:0,class:"field-title"},Rs=["placeholder"],zs=K({__name:"Text",props:{title:{type:[String,Object,Function]},modelValue:{},textArea:{type:Boolean},placeholder:{},maxHeight:{},submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,r=Wt(gt(n,"title"),"span"),i=Gt(null);mn(()=>{var l;(l=i.value)==null||l.focus()});const a=T({get(){var l;return(l=c(n.modelValue))!=null?l:""},set(l){t("update:modelValue",l)}});function u(){t("submit")}function s(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(l,m)=>(N(),M("form",{onSubmit:Tt(u,["prevent"])},[h("div",Bs,[c(r)?(N(),M("span",qs,[(N(),J(We(c(r))))])):A("",!0),l.textArea?(N(),J(c(Tr),{key:1,modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=y=>a.value=y),placeholder:l.placeholder,maxHeight:l.maxHeight,onBlur:s,ref_key:"field",ref:i},null,8,["modelValue","placeholder","maxHeight"])):pn((N(),M("input",{key:2,type:"text","onUpdate:modelValue":m[1]||(m[1]=y=>a.value=y),placeholder:l.placeholder,class:ye({fullWidth:!l.title}),onBlur:s,ref_key:"field",ref:i},null,42,Rs)),[[kr,a.value]])])],40,Ls))}});var ar=le(zs,[["__scopeId","data-v-90bd4994"]]);const Us={key:0},js=["onClick","disabled"],Gs={key:0},Ws=["onClick"],Hs=K({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const r=Be(e),i=O(!1);Qe(i,s=>{t("confirmingChanged",s)});function a(){if(c(r.skipConfirm)){t("click");return}i.value&&t("click"),i.value=!i.value}function u(){i.value=!1}return(s,l)=>(N(),M("span",{class:ye(["container",{confirming:i.value}])},[i.value?(N(),M("span",Us,"Are you sure?")):A("",!0),h("button",{onClick:Tt(a,["stop"]),class:"button danger",disabled:s.disabled},[i.value?(N(),M("span",Gs,"Yes")):it(s.$slots,"default",{key:1},void 0,!0)],8,js),i.value?(N(),M("button",{key:1,class:"button",onClick:Tt(u,["stop"])},"No",8,Ws)):A("",!0)],2))}});var Zs=le(Hs,[["__scopeId","data-v-2f8ef34c"]]);const ot=e=>(ft("data-v-32313015"),e=e(),mt(),e),Ys=ot(()=>h("div",{class:"handle material-icons"},"drag_handle",-1)),Js={key:0,class:"actions"},Xs=ot(()=>h("span",{class:"material-icons"},"content_paste",-1)),Ks=ot(()=>h("span",{class:"material-icons"},"content_copy",-1)),Qs=ot(()=>h("span",{class:"material-icons"},"edit",-1)),el=ot(()=>h("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),tl={key:1,class:"actions"},nl=ot(()=>h("span",{class:"material-icons"},"check",-1)),rl=ot(()=>h("span",{class:"material-icons"},"close",-1)),il={key:2,class:"details"},al={class:"save-version"},ol=ot(()=>h("br",null,null,-1)),sl={key:0},ll={key:3,class:"details"},ul={key:4,class:"details error"},cl=ot(()=>h("br",null,null,-1)),dl=K({__name:"Save",props:{save:{}},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:r}=Be(n),i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),a=O(!1),u=O(!1),s=O("");Qe(a,()=>{var v;return s.value=(v=r.value.name)!=null?v:""});const l=T(()=>r.value!=null&&r.value.id===G.id),m=T(()=>{var v;return l.value?G.time:(v=r.value!=null&&r.value.time)!=null?v:0});function y(){t("editName",s.value),a.value=!1}return(v,b)=>(N(),M("div",{class:ye(["save",{active:l.value}])},[Ys,a.value?(N(),M("div",tl,[h("button",{onClick:y,class:"button"},[g(Se,{display:"Save",direction:c(D).Left,class:"info"},{default:j(()=>[nl]),_:1},8,["direction"])]),h("button",{onClick:b[5]||(b[5]=_=>a.value=!a.value),class:"button"},[g(Se,{display:"Cancel",direction:c(D).Left,class:"info"},{default:j(()=>[rl]),_:1},8,["direction"])])])):(N(),M("div",Js,[c(r).error==null&&!u.value?(N(),J(yn,{key:0,onClick:b[0]||(b[0]=_=>t("export")),class:"button",left:""},{default:j(()=>[g(Se,{display:"Export",direction:c(D).Left,class:"info"},{default:j(()=>[Xs]),_:1},8,["direction"])]),_:1})):A("",!0),c(r).error==null&&!u.value?(N(),M("button",{key:1,onClick:b[1]||(b[1]=_=>t("duplicate")),class:"button"},[g(Se,{display:"Duplicate",direction:c(D).Left,class:"info"},{default:j(()=>[Ks]),_:1},8,["direction"])])):A("",!0),c(r).error==null&&!u.value?(N(),M("button",{key:2,onClick:b[2]||(b[2]=_=>a.value=!a.value),class:"button"},[g(Se,{display:"Edit Name",direction:c(D).Left,class:"info"},{default:j(()=>[Qs]),_:1},8,["direction"])])):A("",!0),g(Zs,{disabled:l.value,onClick:b[3]||(b[3]=_=>t("delete")),onConfirmingChanged:b[4]||(b[4]=_=>u.value=_)},{default:j(()=>[g(Se,{display:"Delete",direction:c(D).Left,class:"info"},{default:j(()=>[el]),_:1},8,["direction"])]),_:1},8,["disabled"])])),c(r).error==null&&!a.value?(N(),M("div",il,[h("button",{class:"button open",onClick:b[6]||(b[6]=_=>t("open"))},[h("h3",null,Z(c(r).name),1)]),h("span",al,"v"+Z(c(r).modVersion),1),ol,m.value?(N(),M("div",sl,"Last played "+Z(c(i).format(m.value)),1)):A("",!0)])):c(r).error==null&&a.value?(N(),M("div",ll,[g(ar,{modelValue:s.value,"onUpdate:modelValue":b[7]||(b[7]=_=>s.value=_),class:"editname",onSubmit:y},null,8,["modelValue"])])):(N(),M("div",ul,[$(" Error: Failed to load save with id "+Z(c(r).id),1),cl,$(Z(c(r).error),1)]))],2))}});var gl=le(dl,[["__scopeId","data-v-32313015"]]);const Mn=e=>(ft("data-v-2a4275be"),e=e(),mt(),e),fl=Mn(()=>h("h2",null,"Saves Manager",-1)),ml={class:"modal-footer"},hl={class:"field"},vl=Mn(()=>h("span",{class:"field-title"},"Create Save",-1)),pl={class:"field-buttons"},bl={class:"footer"},yl=Mn(()=>h("div",{style:{"flex-grow":"1"}},null,-1)),_l=K({__name:"SavesManager",setup(e,{expose:t}){const n=O(!1),r=O(null);t({open(){n.value=!0}});const i=O(!1),a=O(""),u=O(null);Qe(a,C=>{C?At(()=>{try{if(C[0]!=="{")if(C[0]==="e")C=decodeURIComponent(escape(atob(C)));else if(C[0]==="\u1BE1")C=rt.decompressFromUTF16(C);else{console.warn("Unable to determine preset encoding",C),i.value=!0;return}const x=JSON.parse(C);if(typeof x!="object"){i.value=!0;return}const V=Xt();x.id=V,qe(x),a.value="",i.value=!1,ie.saves.push(V)}catch{i.value=!0}}):i.value=!1});let s={},l=O(Object.keys(s).reduce((C,x)=>(C.push({label:x.split("/").slice(-1)[0].slice(0,-4),value:s[x]}),C),[]));const m=hn({});function y(C){if(m[C]==null){let x=localStorage.getItem(C);if(x==null)m[C]={error:"Save doesn't exist in localStorage",id:C};else if(x==="dW5kZWZpbmVk")m[C]={error:"Save is undefined",id:C};else try{if(x[0]!=="{")if(x[0]==="e")x=decodeURIComponent(escape(atob(x)));else if(x[0]==="\u1BE1")x=rt.decompressFromUTF16(x);else return console.warn("Unable to determine preset encoding",x),i.value=!0,m[C]={error:"Unable to determine preset encoding",id:C},m[C];m[C]={...JSON.parse(x),id:C}}catch(V){m[C]={error:V,id:C},console.warn(`SavesManager: Failed to load info about save with id ${C}:
${V}
${x}`)}}return m[C]}Qe(n,C=>{C&&Object.keys(m).forEach(x=>delete m[x])});const v=T(()=>ie.saves.reduce((C,x)=>(C[x]=y(x),C),{}));function b(C){let x;switch(G.id===C?x=bn(G):x=JSON.stringify(v.value[C]),X.exportEncoding){default:console.warn(`Unknown save encoding: ${X.exportEncoding}. Defaulting to lz`);case"lz":x=rt.compressToUTF16(x);break;case"base64":x=btoa(unescape(encodeURIComponent(x)));break;case"plain":break}const V=document.createElement("textarea");V.value=x,document.body.appendChild(V),V.select(),V.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(V)}function _(C){G.id===C&&qe();const x={...v.value[C],id:Xt()};qe(x),ie.saves.push(x.id)}function p(C){ie.saves=ie.saves.filter(x=>x!==C),localStorage.removeItem(C),m[C]=void 0}function S(C){v.value[G.id].time=G.time,qe(),m[G.id]=void 0,wt(v.value[C]),m[C]=void 0}function L(C){if(u.value=C,At(()=>{u.value=null}),C[0]!=="{")if(C[0]==="e")C=decodeURIComponent(escape(atob(C)));else if(C[0]==="\u1BE1")C=rt.decompressFromUTF16(C);else{console.warn("Unable to determine preset encoding",C);return}const x=JSON.parse(C);x.id=Xt(),qe(x),ie.saves.push(x.id),S(x.id)}function P(C,x){const V=v.value[C];V!=null&&(V.name=x,G.id===C?(G.name=x,qe()):(qe(V),m[C]=void 0))}return(C,x)=>(N(),J(at,{modelValue:n.value,"onUpdate:modelValue":x[4]||(x[4]=V=>n.value=V),ref_key:"modal",ref:r},{header:j(()=>[fl]),body:j(({shown:V})=>[V?(N(),J(c($r),{key:0,list:c(ie).saves,handle:".handle",itemKey:ae=>ae},{item:j(({element:ae})=>[g(gl,{save:v.value[ae],onOpen:ge=>S(ae),onExport:ge=>b(ae),onEditName:ge=>P(ae,ge),onDuplicate:ge=>_(ae),onDelete:ge=>p(ae)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):A("",!0)]),footer:j(()=>[h("div",ml,[g(ar,{modelValue:a.value,"onUpdate:modelValue":x[0]||(x[0]=V=>a.value=V),title:"Import Save",placeholder:"Paste your save here!",class:ye({importingFailed:i.value})},null,8,["modelValue","class"]),h("div",hl,[vl,h("div",pl,[h("button",{class:"button",onClick:x[1]||(x[1]=V=>S(c(xt)().id))},"New Game"),Object.keys(c(l)).length>0?(N(),J(ir,{key:0,options:c(l),modelValue:u.value,"onUpdate:modelValue":x[2]||(x[2]=V=>L(V)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):A("",!0)])]),h("div",bl,[yl,h("button",{class:"button modal-default-button",onClick:x[3]||(x[3]=V=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var or=le(_l,[["__scopeId","data-v-2a4275be"]]);const Ue=e=>(ft("data-v-318a1c31"),e=e(),mt(),e),wl=["src","alt"],Nl={key:1,class:"title"},Sl=Ue(()=>h("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),Cl={class:"discord"},kl={class:"discord-links"},Ml={key:0},Il=["href"],xl=Ue(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),$l=Ue(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Tl={href:"https://forums.moddingtree.com/",target:"_blank"},Fl=Ue(()=>h("span",{class:"material-icons"},"forum",-1)),Pl=Ue(()=>h("span",{class:"material-icons"},"info",-1)),El=Ue(()=>h("span",{class:"material-icons"},"library_books",-1)),Ol=Ue(()=>h("span",{class:"material-icons"},"settings",-1)),Dl=Ue(()=>h("span",{class:"material-icons"},"library_books",-1)),Vl=Ue(()=>h("span",{class:"material-icons"},"settings",-1)),Al=Ue(()=>h("span",{class:"material-icons"},"info",-1)),Ll={href:"https://forums.moddingtree.com/",target:"_blank"},Bl=Ue(()=>h("span",{class:"material-icons"},"forum",-1)),ql={class:"discord"},Rl={class:"discord-links"},zl={key:0},Ul=["href"],jl=Ue(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),Gl=Ue(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Wl=K({__name:"Nav",setup(e){const t=O(null),n=O(null),r=O(null),i=O(null),{useHeader:a,banner:u,title:s,discordName:l,discordLink:m,versionNumber:y}=X;function v(){window.open(m,"mywindow")}return(b,_)=>(N(),M(he,null,[c(a)?(N(),M("div",Ct({key:0,class:"nav"},b.$attrs),[c(u)?(N(),M("img",{key:0,src:c(u),class:"banner",alt:c(s)},null,8,wl)):(N(),M("div",Nl,Z(c(s)),1)),h("div",{onClick:_[0]||(_[0]=p=>{var S;return(S=i.value)==null?void 0:S.open()}),class:"version-container"},[g(Se,{display:"Changelog",direction:c(D).Down,class:"version"},{default:j(()=>[h("span",null,"v"+Z(c(y)),1)]),_:1},8,["direction"])]),Sl,h("div",Cl,[h("span",{onClick:v,class:"material-icons"},"discord"),h("ul",kl,[c(m)?(N(),M("li",Ml,[h("a",{href:c(m),target:"_blank"},Z(c(l)),9,Il)])):A("",!0),xl,$l])]),h("div",null,[h("a",Tl,[g(Se,{display:"Forums",direction:c(D).Down,yoffset:"5px"},{default:j(()=>[Fl]),_:1},8,["direction"])])]),h("div",{onClick:_[1]||(_[1]=p=>{var S;return(S=t.value)==null?void 0:S.open()})},[g(Se,{display:"Info",direction:c(D).Down,class:"info"},{default:j(()=>[Pl]),_:1},8,["direction"])]),h("div",{onClick:_[2]||(_[2]=p=>{var S;return(S=n.value)==null?void 0:S.open()})},[g(Se,{display:"Saves",direction:c(D).Down,xoffset:"-20px"},{default:j(()=>[El]),_:1},8,["direction"])]),h("div",{onClick:_[3]||(_[3]=p=>{var S;return(S=r.value)==null?void 0:S.open()})},[g(Se,{display:"Settings",direction:c(D).Down,xoffset:"-66px"},{default:j(()=>[Ol]),_:1},8,["direction"])])],16)):(N(),M("div",Ct({key:1,class:"overlay-nav"},b.$attrs),[h("div",{onClick:_[4]||(_[4]=p=>{var S;return(S=i.value)==null?void 0:S.open()}),class:"version-container"},[g(Se,{display:"Changelog",direction:c(D).Right,xoffset:"25%",class:"version"},{default:j(()=>[h("span",null,"v"+Z(c(y)),1)]),_:1},8,["direction"])]),h("div",{onClick:_[5]||(_[5]=p=>{var S;return(S=n.value)==null?void 0:S.open()})},[g(Se,{display:"Saves",direction:c(D).Right},{default:j(()=>[Dl]),_:1},8,["direction"])]),h("div",{onClick:_[6]||(_[6]=p=>{var S;return(S=r.value)==null?void 0:S.open()})},[g(Se,{display:"Settings",direction:c(D).Right},{default:j(()=>[Vl]),_:1},8,["direction"])]),h("div",{onClick:_[7]||(_[7]=p=>{var S;return(S=t.value)==null?void 0:S.open()})},[g(Se,{display:"Info",direction:c(D).Right},{default:j(()=>[Al]),_:1},8,["direction"])]),h("div",null,[h("a",Ll,[g(Se,{display:"Forums",direction:c(D).Right,xoffset:"7px"},{default:j(()=>[Bl]),_:1},8,["direction"])])]),h("div",ql,[h("span",{onClick:v,class:"material-icons"},"discord"),h("ul",Rl,[c(m)?(N(),M("li",zl,[h("a",{href:c(m),target:"_blank"},Z(c(l)),9,Ul)])):A("",!0),jl,Gl])])],16)),g(Is,{ref_key:"info",ref:t,changelog:i.value},null,8,["changelog"]),g(or,{ref_key:"savesManager",ref:n},null,512),g(As,{ref_key:"options",ref:r},null,512),g(ls,{ref_key:"changelog",ref:i},null,512)],64))}});var sr=le(Wl,[["__scopeId","data-v-318a1c31"]]);const Hl={style:{display:"none"}},Zl={class:"inner-tab"},Yl=K({__name:"Game",setup(e){const t=gt(G,"tabs"),n=T(()=>Object.keys(Oe)),r=X.useHeader;function i(a){const{display:u,minimized:s,name:l,color:m,minimizable:y,nodes:v,minimizedDisplay:b}=a;return{display:u,minimized:s,name:l,color:m,minimizable:y,nodes:v,minimizedDisplay:b}}return(a,u)=>(N(),M("div",{class:ye(["tabs-container",{useHeader:c(r)}])},[(N(!0),M(he,null,nt(t.value,(s,l)=>{var m,y;return N(),M("div",{key:l,class:ye(["tab",c((m=c(Oe)[s])==null?void 0:m.classes)]),style:Re(c((y=c(Oe)[s])==null?void 0:y.style))},[h("div",Hl,[l===0&&!c(r)?(N(),J(sr,{key:0})):A("",!0)]),h("div",Zl,[n.value.includes(s)?(N(),J(is,Ct({key:0},i(c(Oe)[s]),{index:l,onSetMinimized:v=>c(Oe)[s].minimized.value=v}),null,16,["index","onSetMinimized"])):(N(),J(We(s),{key:1,index:l},null,8,["index"]))])],6)}),128))],2))}});var Jl=le(Yl,[["__scopeId","data-v-ad1e1194"]]);function lr(e,t="points",n=0,r=void 0){const i=Le(e)?e:Me(e);if(i.displayName=t,i.precision=n,i.small=r,!Le(e)){const a=i[ct];a.displayName=t,a.precision=n,a.small=r}return i}function ur(e){const t=Me(e.value);return Qe(e,(n,r)=>{Yn.value||d.gt(n,r)&&(t.value=d.add(t.value,d.sub(n,r)))}),t}new d("10^^8");new d("1e100");const Xl=["x1","y1","x2","y2"],Kl=K({__name:"BoardLink",props:{link:{},dragging:{},dragged:{}},setup(e){const n=Be(e),r=T(()=>{var u,s,l,m,y,v,b;const a={...n.link.value.startNode.position};return n.link.value.offsetStart&&(a.x+=c(n.link.value.offsetStart).x,a.y+=c(n.link.value.offsetStart).y),((u=n.dragging)==null?void 0:u.value)===n.link.value.startNode&&(a.x+=(m=(l=(s=n.dragged)==null?void 0:s.value)==null?void 0:l.x)!=null?m:0,a.y+=(b=(v=(y=n.dragged)==null?void 0:y.value)==null?void 0:v.y)!=null?b:0),a}),i=T(()=>{var u,s,l,m,y,v,b;const a={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(a.x+=c(n.link.value.offsetEnd).x,a.y+=c(n.link.value.offsetEnd).y),((u=n.dragging)==null?void 0:u.value)===n.link.value.endNode&&(a.x+=(m=(l=(s=n.dragged)==null?void 0:s.value)==null?void 0:l.x)!=null?m:0,a.y+=(b=(v=(y=n.dragged)==null?void 0:y.value)==null?void 0:v.y)!=null?b:0),a});return(a,u)=>(N(),M("line",Ct({class:"link"},{...a.link,"stroke-width":a.link.strokeWidth},{class:{pulsing:a.link.pulsing},x1:r.value.x,y1:r.value.y,x2:i.value.x,y2:i.value.y}),null,16,Xl))}});var Ql=le(Kl,[["__scopeId","data-v-28281ab6"]]);const eu={key:0},tu=["transform","onMousedown","onTouchstart","onMouseup","onTouchend"],nu=["fill","stroke-width","stroke"],ru=["fill"],iu=K({__name:"BoardNodeAction",props:{node:{},nodeType:{},actions:{},isSelected:{type:Boolean},selectedAction:{}},emits:["clickAction"],setup(e,{emit:t}){const r=Be(e),i=T(()=>te(r.nodeType.value.size,c(r.node))),a=T(()=>{var y;return(y=te(r.nodeType.value.outlineColor,c(r.node)))!=null?y:Je[ie.theme].variables["--outline"]}),u=T(()=>{var y;return(y=te(r.nodeType.value.titleColor,c(r.node)))!=null?y:Je[ie.theme].variables["--foreground"]}),s=T(()=>te(r.nodeType.value.actionDistance,c(r.node)));function l(y,v){t("clickAction",v.id),y.preventDefault(),y.stopPropagation()}function m(y,v){var b;((b=c(r.selectedAction))==null?void 0:b.id)===v.id&&(y.preventDefault(),y.stopPropagation())}return(y,v)=>(N(),J(Lt,{name:"actions",appear:""},{default:j(()=>[y.isSelected&&y.actions?(N(),M("g",eu,[(N(!0),M(he,null,nt(y.actions,(b,_)=>{var p,S;return N(),M("g",{key:b.id,class:ye(["action",{selected:((p=y.selectedAction)==null?void 0:p.id)===b.id}]),transform:`translate(
                        ${(-i.value-30)*Math.sin(((y.actions.length-1)/2-_)*s.value)},
                        ${(i.value+30)*Math.cos(((y.actions.length-1)/2-_)*s.value)}
                    )`,onMousedown:L=>l(L,b),onTouchstart:L=>l(L,b),onMouseup:L=>m(L,b),onTouchend:Tt(L=>m(L,b),["stop"])},[h("circle",{fill:c(te)(b.fillColor,y.node),r:"20","stroke-width":((S=y.selectedAction)==null?void 0:S.id)===b.id?4:0,stroke:a.value},null,8,nu),h("text",{fill:u.value,class:"material-icons"},Z(c(te)(b.icon,y.node)),9,ru)],42,tu)}),128))])):A("",!0)]),_:1}))}});var au=le(iu,[["__scopeId","data-v-9efb2a56"]]);const ou=["transform"],su={key:0},lu=["r","fill","stroke"],uu=["r","fill","stroke"],cu=["r","fill"],du=["r","stroke-dasharray","stroke-dashoffset","stroke"],gu={key:1,transform:"rotate(45, 0, 0)"},fu=["width","height","transform","fill","stroke"],mu=["width","height","transform","fill","stroke"],hu=["width","height","transform","fill"],vu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],pu={key:2},bu=["width","height","transform","fill","stroke"],yu=["width","height","transform","fill","stroke"],_u=["width","height","transform","fill"],wu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],Nu=["fill"],Su={key:0},Cu=["fill","y"],ku=["fill","y"],Mu=K({__name:"BoardNode",props:{node:{},nodeType:{},dragging:{},dragged:{},hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:{}},emits:["mouseDown","endDragging","clickAction"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=1+r/2,a=Be(n),u=T(()=>te(a.nodeType.value.draggable,c(a.node)));Qe(u,q=>{const ue=c(a.node);c(a.dragging)===ue&&!q&&t("endDragging",ue)});const s=T(()=>{var ue;const q=c(a.node);return(ue=te(a.nodeType.value.actions,q))==null?void 0:ue.filter(Fe=>_n(te(Fe.visibility,q)))}),l=T(()=>{var ue;const q=c(a.node);if(te(a.nodeType.value.draggable,q)&&((ue=c(a.dragging))==null?void 0:ue.id)===q.id&&c(a.dragged)!=null){const{x:Fe,y:et}=c(a.dragged);return{x:q.position.x+Math.round(Fe/25)*25,y:q.position.y+Math.round(et/25)*25}}return q.position}),m=T(()=>te(a.nodeType.value.shape,c(a.node))),y=T(()=>te(a.nodeType.value.title,c(a.node))),v=T(()=>{var q;return(q=a.isSelected.value?c(a.selectedAction)&&te(c(a.selectedAction).tooltip,c(a.node)):null)!=null?q:te(a.nodeType.value.label,c(a.node))}),b=T(()=>{var q,ue;return te((ue=(q=c(a.selectedAction))==null?void 0:q.confirmationLabel)!=null?ue:{text:"Tap again to confirm"},c(a.node))}),_=T(()=>te(a.nodeType.value.size,c(a.node))),p=T(()=>{var q;return(q=te(a.nodeType.value.progress,c(a.node)))!=null?q:0}),S=T(()=>Je[ie.theme].variables["--background"]),L=T(()=>{var q;return(q=te(a.nodeType.value.outlineColor,c(a.node)))!=null?q:Je[ie.theme].variables["--outline"]}),P=T(()=>{var q;return(q=te(a.nodeType.value.fillColor,c(a.node)))!=null?q:Je[ie.theme].variables["--raised-background"]}),C=T(()=>te(a.nodeType.value.progressColor,c(a.node))),x=T(()=>{var q;return(q=te(a.nodeType.value.titleColor,c(a.node)))!=null?q:Je[ie.theme].variables["--foreground"]}),V=T(()=>te(a.nodeType.value.progressDisplay,c(a.node))),ae=T(()=>a.dragging.value!=null&&c(a.hasDragged)&&te(a.nodeType.value.canAccept,c(a.node),a.dragging.value)),ge=T(()=>te(a.nodeType.value.style,c(a.node))),ne=T(()=>te(a.nodeType.value.classes,c(a.node)));function re(q){t("mouseDown",q,a.node.value,u.value)}function Mt(q){var ue,Fe,et;(ue=a.hasDragged)!=null&&ue.value||(t("endDragging",a.node.value),(et=(Fe=a.nodeType.value).onClick)==null||et.call(Fe,a.node.value),q.stopPropagation())}return(q,ue)=>{var Fe,et,Et;return N(),M("g",{class:ye(["boardnode",{[q.node.type]:!0,isSelected:q.isSelected,isDraggable:u.value,...ne.value}]),style:Re([{opacity:((Fe=q.dragging)==null?void 0:Fe.id)===q.node.id&&q.hasDragged?.5:1},(et=ge.value)!=null?et:[]]),transform:`translate(${l.value.x},${l.value.y})`},[g(au,{actions:(Et=s.value)!=null?Et:[],"is-selected":q.isSelected,node:q.node,"node-type":q.nodeType,"selected-action":q.selectedAction,onClickAction:ue[0]||(ue[0]=pe=>t("clickAction",pe))},null,8,["actions","is-selected","node","node-type","selected-action"]),h("g",{class:"node-container",onMousedown:re,onTouchstartPassive:re,onMouseup:Mt,onTouchendPassive:Mt},[m.value===c(ze).Circle?(N(),M("g",su,[ae.value?(N(),M("circle",{key:0,class:"receiver",r:_.value+8,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,lu)):A("",!0),h("circle",{class:"body",r:_.value,fill:P.value,stroke:L.value,"stroke-width":4},null,8,uu),V.value===c(Kt).Fill?(N(),M("circle",{key:1,class:"progress progressFill",r:Math.max(_.value*p.value-2,0),fill:C.value},null,8,cu)):(N(),M("circle",{key:2,r:_.value+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(_.value+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(_.value+4.5)*2*Math.PI-p.value*(_.value+4.5)*2*Math.PI,stroke:C.value},null,8,du))])):m.value===c(ze).Diamond?(N(),M("g",gu,[ae.value?(N(),M("rect",{key:0,class:"receiver",width:_.value*c(r)+16,height:_.value*c(r)+16,transform:`translate(${-(_.value*c(r)+16)/2}, ${-(_.value*c(r)+16)/2})`,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,fu)):A("",!0),h("rect",{class:"body",width:_.value*c(r),height:_.value*c(r),transform:`translate(${-_.value*c(r)/2}, ${-_.value*c(r)/2})`,fill:P.value,stroke:L.value,"stroke-width":4},null,8,mu),V.value===c(Kt).Fill?(N(),M("rect",{key:1,class:"progress progressFill",width:Math.max(_.value*c(r)*p.value-2,0),height:Math.max(_.value*c(r)*p.value-2,0),transform:`translate(${-Math.max(_.value*c(r)*p.value-2,0)/2}, ${-Math.max(_.value*c(r)*p.value-2,0)/2})`,fill:C.value},null,8,hu)):(N(),M("rect",{key:2,class:"progress progressDiamond",width:_.value*c(r)+9,height:_.value*c(r)+9,transform:`translate(${-(_.value*c(r)+9)/2}, ${-(_.value*c(r)+9)/2})`,fill:"transparent","stroke-dasharray":(_.value*c(r)+9)*4,"stroke-width":5,"stroke-dashoffset":(_.value*c(r)+9)*4-p.value*(_.value*c(r)+9)*4,stroke:C.value},null,8,vu))])):m.value===c(ze).Square?(N(),M("g",pu,[ae.value?(N(),M("rect",{key:0,class:"receiver",width:_.value*i+16,height:_.value*i+16,transform:`translate(${-(_.value*i+16)/2}, ${-(_.value*i+16)/2})`,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,bu)):A("",!0),h("rect",{class:"body",width:_.value*i,height:_.value*i,transform:`translate(${-_.value*i/2}, ${-_.value*i/2})`,fill:P.value,stroke:L.value,"stroke-width":4},null,8,yu),V.value===c(Kt).Fill?(N(),M("rect",{key:1,class:"progress progressFill",width:Math.max(_.value*i*p.value-2,0),height:Math.max(_.value*i*p.value-2,0),transform:`translate(${-Math.max(_.value*i*p.value-2,0)/2}, ${-Math.max(_.value*i*p.value-2,0)/2})`,fill:C.value},null,8,_u)):(N(),M("rect",{key:2,class:"progress progressDiamond",width:_.value*i+9,height:_.value*i+9,transform:`translate(${-(_.value*i+9)/2}, ${-(_.value*i+9)/2})`,fill:"transparent","stroke-dasharray":(_.value*i+9)*4,"stroke-width":5,"stroke-dashoffset":(_.value*i+9)*4-p.value*(_.value*i+9)*4,stroke:C.value},null,8,wu))])):A("",!0),h("text",{fill:x.value,class:"node-title"},Z(y.value),9,Nu)],32),g(Lt,{name:"fade",appear:""},{default:j(()=>{var pe;return[v.value?(N(),M("g",Su,[h("text",{fill:(pe=v.value.color)!=null?pe:x.value,class:ye(["node-title",{pulsing:v.value.pulsing}]),y:-_.value-20},Z(v.value.text),11,Cu)])):A("",!0)]}),_:1}),g(Lt,{name:"fade",appear:""},{default:j(()=>{var pe;return[q.isSelected&&q.selectedAction?(N(),M("text",{key:0,fill:(pe=b.value.color)!=null?pe:x.value,class:ye(["node-title",{pulsing:b.value.pulsing}]),y:_.value+75},Z(b.value.text),11,ku)):A("",!0)]}),_:1})],14,ou)}}});var Iu=le(Mu,[["__scopeId","data-v-3697ee2a"]]);const xu={class:"stage",width:"100%",height:"100%"},$u={class:"g1"},Tu=K({__name:"Board",props:{nodes:{},types:{},stage:{},state:{},visibility:{},width:{},height:{},style:{},classes:{},links:{},selectedAction:{},selectedNode:{},draggingNode:{},receivingNode:{},mousePosition:{},setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=Be(e),r=O({x:0,y:0}),i=O({x:0,y:0}),a=O(!1),u=O(!1),s=O(null),l=T(()=>{const p=n.nodes.value.slice();if(n.draggingNode.value){const S=p.splice(p.indexOf(n.draggingNode.value),1)[0];p.push(S)}return p});vn(()=>{const p=n.draggingNode.value;if(p==null)return null;const S={x:p.position.x+i.value.x,y:p.position.y+i.value.y};let L=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((P,C)=>{if(C.id===p.id)return P;const x=n.types.value[C.type];if(!te(x.canAccept,C,p))return P;const ae=Math.pow(S.x-C.position.x,2)+Math.pow(S.y-C.position.y,2);let ge=te(x.size,C);return ae>L||ae>ge*ge?P:(L=ae,C)},null))});function m(p){p.setTransformOrigin(null),p.moveTo(s.value.$el.clientWidth/2,s.value.$el.clientHeight/2),n.stage.value=p}function y(p,S=null,L=!1){if(n.draggingNode.value==null){p.preventDefault(),p.stopPropagation();let P,C;if("touches"in p)if(p.touches.length===1)P=p.touches[0].clientX,C=p.touches[0].clientY;else return;else P=p.clientX,C=p.clientY;r.value={x:P,y:C},i.value={x:0,y:0},u.value=!1,a.value=!0,L&&n.setDraggingNode.value(S)}}function v(p){const{x:S,y:L,scale:P}=s.value.panZoomInstance.getTransform();let C,x;if("touches"in p)if(p.touches.length===1)C=p.touches[0].clientX,x=p.touches[0].clientY;else{b(n.draggingNode.value),n.mousePosition.value=null;return}else C=p.clientX,x=p.clientY;n.mousePosition.value={x:(C-S)/P,y:(x-L)/P},i.value={x:i.value.x+(C-r.value.x)/P,y:i.value.y+(x-r.value.y)/P},r.value={x:C,y:x},(Math.abs(i.value.x)>10||Math.abs(i.value.y)>10)&&(u.value=!0),n.draggingNode.value!=null||a.value&&u.value&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function b(p,S=!1){var L,P;if(n.draggingNode.value!=null&&n.draggingNode.value===p){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(i.value.x/25)*25,n.draggingNode.value.position.y+=Math.round(i.value.y/25)*25);const C=n.nodes.value;C.push(C.splice(C.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((P=(L=n.types.value[n.receivingNode.value.type]).onDrop)==null||P.call(L,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else!u.value&&!S&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null);a.value=!1}function _(p,S){n.state.value.selectedAction===S?c(n.selectedAction).onClick(c(n.selectedNode)):n.state.value={...n.state.value,selectedAction:S}}return(p,S)=>{const L=Bt("panZoom");return c(_n)(p.visibility)?(N(),J(L,{key:0,style:Re([{width:p.width,height:p.height},p.style]),class:ye(p.classes),selector:".g1",options:{initialZoom:1,minZoom:.1,maxZoom:10,zoomDoubleClickSpeed:1},ref_key:"stage",ref:s,onInit:m,onMousemove:v,onTouchmove:v,onMousedown:S[0]||(S[0]=P=>y(P)),onTouchstart:S[1]||(S[1]=P=>y(P)),onMouseup:S[2]||(S[2]=()=>b(c(p.draggingNode))),onTouchendPassive:S[3]||(S[3]=()=>b(c(p.draggingNode))),onMouseleave:S[4]||(S[4]=()=>b(c(p.draggingNode),!0))},{default:j(()=>[(N(),M("svg",xu,[h("g",$u,[g(Tn,{name:"link",appear:""},{default:j(()=>[(N(!0),M(he,null,nt(c(p.links)||[],P=>(N(),M("g",{key:`${P.startNode.id}-${P.endNode.id}`},[g(Ql,{link:P,dragging:c(p.draggingNode),dragged:P.startNode===c(p.draggingNode)||P.endNode===c(p.draggingNode)?i.value:void 0},null,8,["link","dragging","dragged"])]))),128))]),_:1}),g(Tn,{name:"grow",duration:500,appear:""},{default:j(()=>[(N(!0),M(he,null,nt(l.value,P=>(N(),M("g",{key:P.id,style:{"transition-duration":"0s"}},[g(Iu,{node:P,nodeType:p.types[P.type],dragging:c(p.draggingNode),dragged:c(p.draggingNode)===P?i.value:void 0,hasDragged:c(p.draggingNode)==null?!1:u.value,receivingNode:c(p.receivingNode)===P,isSelected:c(p.selectedNode)===P,selectedAction:c(p.selectedNode)===P?c(p.selectedAction):null,onMouseDown:y,onEndDragging:b,onClickAction:C=>_(P,C)},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class"])):A("",!0)}}});Te.on("setupVue",e=>Fr.install(e));const cr=Symbol("Board");var Kt=(e=>(e.Outline="Outline",e.Fill="Fill",e))(Kt||{}),ze=(e=>(e.Circle="Circle",e.Diamond="Triangle",e.Square="Square",e))(ze||{});function dr(e){const t=Me({nodes:[],selectedNode:null,selectedAction:null},!1);return Nn(n=>{const r=e.call(n,n);r.id=Hn("board-"),r.type=cr,r[on]=Tu,r.state?(Jo(t),z(r,"state")):(t[jt]={nodes:r.startNodes().map((s,l)=>(s.id=l,s)),selectedNode:null,selectedAction:null},r.state=t),r.nodes=T(()=>c(u.state).nodes),r.selectedNode=T({get(){return u.nodes.value.find(s=>s.id===c(u.state).selectedNode)||null},set(s){var l,m;Le(u.state)?u.state.value={...u.state.value,selectedNode:(l=s==null?void 0:s.id)!=null?l:null}:u.state.selectedNode=(m=s==null?void 0:s.id)!=null?m:null}}),r.selectedAction=T({get(){const s=u.selectedNode.value;if(s==null)return null;const l=u.types[s.type];return l.actions==null?null:l.actions.find(m=>m.id===c(u.state).selectedAction)||null},set(s){var l,m;Le(u.state)?u.state.value={...u.state.value,selectedAction:(l=s==null?void 0:s.id)!=null?l:null}:u.state.selectedAction=(m=s==null?void 0:s.id)!=null?m:null}}),r.mousePosition=O(null),r.links?z(r,"links"):r.links=T(()=>u.selectedAction.value==null?null:u.selectedAction.value.links&&u.selectedNode.value?te(u.selectedAction.value.links,u.selectedNode.value):null),r.draggingNode=O(null),r.receivingNode=O(null),r.stage=O(null),z(r,"visibility"),ke(r,"visibility",zt.Visible),z(r,"width"),ke(r,"width","100%"),z(r,"height"),ke(r,"height","100%"),z(r,"classes"),z(r,"style");for(const s in r.types){const l=r.types[s];if(z(l,"title"),z(l,"label"),z(l,"size"),ke(l,"size",50),z(l,"style"),z(l,"classes"),z(l,"draggable"),ke(l,"draggable",!1),z(l,"shape"),ke(l,"shape","Circle"),z(l,"canAccept"),ke(l,"canAccept",!1),z(l,"progress"),z(l,"progressDisplay"),ke(l,"progressDisplay","Fill"),z(l,"progressColor"),ke(l,"progressColor","none"),z(l,"fillColor"),z(l,"outlineColor"),z(l,"titleColor"),z(l,"actionDistance"),ke(l,"actionDistance",Math.PI/6),l.nodes=T(()=>c(u.state).nodes.filter(m=>m.type===s)),ke(l,"onClick",function(m){c(u.state).selectedNode=m.id}),l.actions)for(const m of l.actions)z(m,"visibility"),ke(m,"visibility",zt.Visible),z(m,"icon"),z(m,"fillColor"),z(m,"tooltip"),z(m,"confirmationLabel"),ke(m,"confirmationLabel",{text:"Tap again to confirm"}),z(m,"links")}function i(s){r.draggingNode.value=s}function a(s){r.receivingNode.value=s}r.placeInAvailableSpace=function(s,l=100,m=D.Right){const y=u.nodes.value.slice().filter(v=>v===s||(m===D.Down||m===D.Up)&&Math.abs(v.position.x-s.position.x)>l||(m===D.Left||m===D.Right)&&Math.abs(v.position.y-s.position.y)>l?!1:!(m===D.Right&&v.position.x<s.position.x-l||m===D.Left&&v.position.x>s.position.x+l||m===D.Up&&v.position.y>s.position.y+l||m===D.Down&&v.position.y<s.position.y-l)).sort(m===D.Right?(v,b)=>v.position.x-b.position.x:m===D.Left?(v,b)=>b.position.x-v.position.x:m===D.Up?(v,b)=>b.position.y-v.position.y:(v,b)=>v.position.y-b.position.y);for(let v=0;v<y.length;v++){const b=y[v],_=m===D.Right||m===D.Left?Math.abs(s.position.x-b.position.x):Math.abs(s.position.y-b.position.y);if(_<l)m===D.Right?s.position.x=b.position.x+l:m===D.Left?s.position.x=b.position.x-l:m===D.Up?s.position.y=b.position.y-l:m===D.Down&&(s.position.y=b.position.y+l);else if(v>0&&_>l)break}},r[sn]=function(){const{nodes:s,types:l,stage:m,state:y,visibility:v,width:b,height:_,style:p,classes:S,links:L,selectedAction:P,selectedNode:C,mousePosition:x,draggingNode:V,receivingNode:ae}=this;return{nodes:s,types:l,stage:m,state:y,visibility:v,width:b,height:_,style:c(p),classes:S,links:L,selectedAction:P,selectedNode:C,mousePosition:x,draggingNode:V,receivingNode:ae,setDraggingNode:i,setReceivingNode:a}};const u=r;return u})}function te(e,t,...n){return en(e)?e(t,...n):c(e)}const Vt={};Te.on("addLayer",e=>{const t=Qi(e,cr);Vt[e.id]=e.on("postUpdate",n=>{t.forEach(r=>{Object.values(r.types).forEach(i=>i.nodes.value.forEach(a=>{var u;return(u=i.update)==null?void 0:u.call(i,a,n)}))})})});Te.on("removeLayer",e=>{var t;(t=Vt[e.id])==null||t.call(Vt),Vt[e.id]=void 0});const Ye=Symbol("BoardID"),$e=Symbol("BoardConnections"),Fu={name:"Beamer",icon:"\u{1F4A0}",color:"#afcfef",class:"damager",description:"Beams one random enemy on the loop it's on once every a certain amount of time.",baseCost:{energy:100},upgrades:{damage:{name:"Damage",effect:e=>10+2*e,cost:e=>({energy:50*1.2**e}),unit:"/hit"},interval:{name:"Interval",max:15,effect:e=>2*.9**e,cost:e=>({energy:50*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var r,i,a,u;if(t.enemies.length){if(e.data.prg=((r=e.data.prg)!=null?r:0)+n/this.upgrades.interval.effect((i=e.upgrades.interval)!=null?i:0),e.data.prg>=1){let s=t.enemies[Math.floor(Math.random()*t.enemies.length)];s.health-=this.upgrades.damage.effect((a=e.upgrades.damage)!=null?a:0),s[$e]||(s[$e]={}),s[$e][(u=t[Ye])!=null?u:0]=0,e.data.prg--}}else e.data.prg=0}},Pu={name:"Plasma",icon:"\u{1F53A}",color:"#efbfbf",class:"damager",description:"Deal damage per second to all enemies on the loop it's on.",baseCost:{energy:400},upgrades:{damage:{name:"Damage",effect:e=>3+e,cost:e=>({energy:200*1.2**e}),unit:"/s"}},onUpdate(e,t,n){var i,a;let r=this.upgrades.damage.effect((i=e.upgrades.damage)!=null?i:0);for(let u of t.enemies)u.health-=r*n,u[$e]||(u[$e]={}),u[$e][(a=t[Ye])!=null?a:0]=0}},Eu={name:"Freezer",icon:"\u2744\uFE0F",color:"#afcfef",class:"effector",description:"Slows down enemies when they move to the next loop. Does not deal any damage to enemies.",baseCost:{energy:500},upgrades:{duration:{name:"Duration",effect:e=>2+.4*e,cost:e=>({energy:300*1.4**e}),precision:1,unit:"rad"}},onEnemyExit(e,t,n){var r;n.effects.freeze=this.upgrades.duration.effect((r=e.upgrades.duration)!=null?r:0)}},Ou={name:"Energizer",icon:"\u26A1",color:"#efefaf",class:"generator",description:"Infuse enemies with Energy while they are on the loop it's on, resulting in them dropping more Energy when defeated.",baseCost:{energy:200},upgrades:{amount:{name:"Amount",effect:e=>4+e*(e+1),cost:e=>({energy:400*3**e}),unit:"/s"}},onUpdate(e,t,n){var i,a,u;let r=this.upgrades.amount.effect((i=e.upgrades.amount)!=null?i:0);for(let s of t.enemies)s.loot.energy=((a=s.loot.energy)!=null?a:0)+r*n,s[$e]||(s[$e]={}),s[$e][(u=t[Ye])!=null?u:0]=0}};var gr=Object.freeze(Object.defineProperty({__proto__:null,beamer:Fu,plasma:Pu,freezer:Eu,energizer:Ou},Symbol.toStringTag,{value:"Module"}));const gn=gr,Du={shape:ze.Circle,size:50,title:"",classes:{loop:!0}},Vu={shape:ze.Circle,size:8,title:"",classes:{enemy:!0}},Au={shape:e=>{var t;return{damager:ze.Circle,effector:ze.Diamond,generator:ze.Square}[(t=gn[e.state.target.type])==null?void 0:t.class]},size:30,title:e=>{var t;return(t=gn[e.state.target.type])==null?void 0:t.icon},fillColor:e=>{var t;return(t=gn[e.state.target.type])==null?void 0:t.color},classes:{building:!0}};var Lu=Object.freeze(Object.defineProperty({__proto__:null,loop:Du,enemy:Vu,building:Au},Symbol.toStringTag,{value:"Module"}));const Bu={key:0},qu={key:0,class:"mark star"},Ru=["src"],zu=K({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>t.mark?(N(),M("div",Bu,[t.mark===!0?(N(),M("div",qu)):(N(),M("img",{key:1,class:"mark",src:t.mark},null,8,Ru))])):A("",!0)}});var Uu=le(zu,[["__scopeId","data-v-2207999f"]]);const ju=K({__name:"Node",props:{id:{}},setup(e){const n=Be(e),r=Fn(Sn,()=>{}),i=Fn(Cn,()=>{}),a=Gt(null),u=T(()=>a.value&&a.value.parentElement);return Qe([u,n.id],([s,l],[m,y])=>{m&&i(c(y)),s&&r(l,s)}),Mr(()=>i(c(n.id))),(s,l)=>(N(),M("div",{class:"node",ref_key:"node",ref:a},null,512))}});var Gu=le(ju,[["__scopeId","data-v-a48cb382"]]);const Wu=K({props:{progress:{type:se(String,Object,Number),required:!0},width:{type:se(Number),required:!0},height:{type:se(Number),required:!0},direction:{type:se(String),required:!0},display:se(Object,String,Function),visibility:{type:se(Number,Boolean),required:!0},style:se(Object,String,Array),classes:se(Object),borderStyle:se(Object,String,Array),textStyle:se(Object,String,Array),baseStyle:se(Object,String,Array),fillStyle:se(Object,String,Array),mark:se(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:Uu,Node:Gu},setup(e){const{progress:t,width:n,height:r,direction:i,display:a}=Be(e),u=T(()=>{let m=t.value instanceof d?t.value.toNumber():Number(t.value);return(1-Math.min(Math.max(m,0),1))*100}),s=T(()=>{const m={width:Xe(n)+1+"px",height:Xe(r)+.5+"px"};switch(c(i)){case D.Up:m.clipPath=`inset(${u.value}% 0% 0% 0%)`,m.width=Xe(n)+1+"px";break;case D.Down:m.clipPath=`inset(0% 0% ${u.value}% 0%)`,m.width=Xe(n)+1+"px";break;case D.Right:m.clipPath=`inset(0% ${u.value}% 0% 0%)`;break;case D.Left:m.clipPath=`inset(0% 0% 0% ${u.value}%)`;break;case D.Default:m.clipPath="inset(0% 50% 0% 0%)";break}return m}),l=Wt(a);return{normalizedProgress:u,barStyle:s,component:l,unref:c,Visibility:zt,isVisible:_n,isHidden:Ki}}});function Hu(e,t,n,r,i,a){var l,m,y,v,b,_,p;const u=Bt("MarkNode"),s=Bt("Node");return e.isVisible(e.visibility)?(N(),M("div",{key:0,style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px",visibility:e.isHidden(e.visibility)?"hidden":void 0},(l=e.unref(e.style))!=null?l:{}]),class:ye({bar:!0,...e.unref(e.classes)})},[h("div",{class:"overlayTextContainer border",style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(m=e.unref(e.borderStyle))!=null?m:{}])},[e.component?(N(),M("span",{key:0,class:"overlayText",style:Re(e.unref(e.textStyle))},[(N(),J(We(e.component)))],4)):A("",!0)],4),h("div",{class:"border",style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(y=e.unref(e.style))!=null?y:{},(v=e.unref(e.baseStyle))!=null?v:{},(b=e.unref(e.borderStyle))!=null?b:{}])},[h("div",{class:"fill",style:Re([e.barStyle,(_=e.unref(e.style))!=null?_:{},(p=e.unref(e.fillStyle))!=null?p:{}])},null,4)],4),g(u,{mark:e.unref(e.mark)},null,8,["mark"]),g(s,{id:e.id},null,8,["id"])],6)):A("",!0)}var Zu=le(Wu,[["render",Hu],["__scopeId","data-v-368a68be"]]);const Yu=Symbol("Bar");function fn(e,...t){const n=t.reduce((r,i)=>{var a;return Object.assign(r,(a=i.getPersistentData)==null?void 0:a.call(i))},{});return Nn(r=>{var u,s;const i=e.call(r,r);i.id=Hn("bar-"),i.type=Yu,i[on]=Zu;for(const l of t)(u=l.preConstruct)==null||u.call(l,i);Object.assign(i,n),z(i,"visibility"),ke(i,"visibility",zt.Visible),z(i,"width"),z(i,"height"),z(i,"direction"),z(i,"style"),z(i,"classes"),z(i,"borderStyle"),z(i,"baseStyle"),z(i,"textStyle"),z(i,"fillStyle"),z(i,"progress"),z(i,"display"),z(i,"mark");for(const l of t)(s=l.postConstruct)==null||s.call(l,i);const a=t.reduce((l,m)=>{var y;return Object.assign(l,(y=m.getGatheredProps)==null?void 0:y.call(m,i))},{});return i[sn]=function(){const{progress:l,width:m,height:y,direction:v,display:b,visibility:_,style:p,classes:S,borderStyle:L,textStyle:P,baseStyle:C,fillStyle:x,mark:V,id:ae}=this;return{progress:l,width:m,height:y,direction:v,display:b,visibility:_,style:c(p),classes:S,borderStyle:L,textStyle:P,baseStyle:C,fillStyle:x,mark:V,id:ae,...a}},i})}const xe=gr,Ju="game";function Jt(e){let[t,n]=e.split("x");return{x:+t,y:+n}}function Ne(e,t){return e+"x"+t}var je=function(e){return e.New="",e.Started="start",e.Stopped="stop",e.Idle="idle",e}(je||{});const fr=kn(Ju,function(){const e="Game",t=Me(0),n=Me(0),r=Me(0),i=O(0),a=Me({}),u=Me(0),s={energy:lr(0,"Energy")},l=Object.fromEntries(Object.entries(s).map(([k,F])=>[k,ur(F)])),m=Me(0),y=Me({});function v(k){var F;return 1.1**(m.value+((F=y.value[k])!=null?F:0))}const b=Me("",!1),_=Me(0),p=O(0);function S(){switch(t.value=0,n.value=0,s.energy.value=100,l.energy.value=0,m.value=0,y.value={},u.value=0,b.value=je.Started,_.value=1,Ze.selectedGameMode.value){case"standard":r.value=100;break;case"boosted":r.value=50;break;case"hardcore":r.value=Number.EPSILON;break}let k=()=>setTimeout(()=>{V.stage.value?(V.stage.value.getTransform(),V.stage.value.zoomAbs(window.innerWidth/2,window.innerHeight/2,1),V.stage.value.moveTo(window.innerWidth/2,window.innerHeight/2)):k()},0);k(),a.value={"0x0":{enemies:[{angle:0,lifetime:0,speed:Number.EPSILON,health:20,maxHealth:20,effects:{},loot:{energy:100}}]}}}function L(){b.value=je.Stopped,_.value=.1,Ze.bestCycle[Ze.selectedGameMode.value].value=Math.max(Ze.bestCycle[Ze.selectedGameMode.value].value,t.value);let k={x:0,y:0},F={x:0,y:0};for(let Q in a.value){let{x:ce,y:De}=Jt(Q);k.x=Math.min(k.x,ce),k.y=Math.min(k.y,De),F.x=Math.max(F.x,ce),F.y=Math.max(F.y,De)}let R=(k.x+F.x)*-50,B=(k.y+F.y)*-50,U=Math.min(window.innerWidth/(F.x-k.x+1)/120,window.innerHeight/(F.y-k.y+1)/120,1),H=()=>setTimeout(()=>{V.stage.value?(V.stage.value.smoothMoveTo(R+window.innerWidth/2,B+window.innerHeight/2),V.stage.value.smoothZoomAbs(window.innerWidth/2,window.innerHeight/2,U)):H()},0);H(),setTimeout(()=>{for(let Q of c(V.state).nodes)Q.state.velocity={x:Math.random()*450-225,y:Math.random()*-450}},3e3),setTimeout(()=>{p.value=Math.sqrt(t.value)*Math.sqrt(u.value/60)*Object.values(l).reduce((Q,ce)=>Q+Math.log10(new d(ce.value).toNumber()+1),1),p.value*=He[Ze.selectedGameMode.value].multiplier,Zt.value=!0},6e3)}function P(){let k=1+.1*t.value+.01*t.value*t.value;k=Math.floor(k)+(Math.random()<k%1?1:0);let F=Object.values(a.value);if(F.length<=0)return;let R=1;switch(Ze.selectedGameMode.value){case"standard":R=1;break;case"boosted":R=2;break;case"hardcore":R=3;break}for(let B=0;B<k;B++){let U=18*1.05**(t.value*R)*(Math.random()*.2+.9);F[Math.floor(Math.random()*F.length)].enemies.push({angle:Math.random(),lifetime:0,speed:(Math.random()*.4+.8+.05*t.value)*(Math.random()<.5?1:-1),health:U,maxHealth:U,effects:{},loot:{energy:25}})}}function C(){let k=Object.entries(a.value),F="";for(;k.length;){let R=Math.floor(Math.random()*k.length),B=k[R],{x:U,y:H}=Jt(B[0]),Q=[];if(a.value[Ne(U+1,H)]||Q.push(Ne(U+1,H)),a.value[Ne(U-1,H)]||Q.push(Ne(U-1,H)),a.value[Ne(U,H+1)]||Q.push(Ne(U,H+1)),a.value[Ne(U,H-1)]||Q.push(Ne(U,H-1)),Q.length){F=Q[Math.floor(Math.random()*Q.length)];break}else k.splice(R,1)}a.value[F]={enemies:[]}}Te.on("onLoad",()=>{b.value==je.New?S():b.value==je.Stopped&&L()}),Te.on("update",k=>{var F,R,B,U,H,Q,ce,De;if(b.value==je.Started){if(_.value<=0)return;k*=_.value,u.value+=k,t.value>=1&&(n.value+=k/(15+Math.sqrt(t.value)),n.value>=1&&(n.value--,t.value++,P(),(t.value+1)%2==0&&C()));let _e=!1;for(let ee in a.value)_e||(_e=a.value[ee].enemies.length>0);_e||(n.value=0,t.value++,P(),(t.value+1)%2==0&&C());let Ce=[];i.value=0;for(let ee in a.value){let Pe=a.value[ee],{x:we,y:fe}=Jt(ee);for(let E of Pe.enemies){let Ee=E.angle,Ve=E.speed*.1*k;E.effects.freeze&&(Ve*=.5),E.angle+=Ve,E.lifetime+=Math.abs(Ve),i.value+=E.lifetime,E.angle=(E.angle%1+1)%1;let[Ke,st]=[Math.min(Ee,E.angle),Math.max(Ee,E.angle)];if(E.health<=0){Pe.enemies.splice(Pe.enemies.indexOf(E),1);for(let[vt,yr]of Object.entries(E.loot))s[vt].value+=yr}Ke<.25&&st>.75?a.value[Ne(we,fe+1)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we,fe+1)]}),E.angle=.5-E.angle,E.speed=-E.speed):Ke<.25&&st>.25?a.value[Ne(we+1,fe)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we+1,fe)]}),E.angle=1-E.angle,E.speed=-E.speed):Ke<.5&&st>.5?a.value[Ne(we,fe-1)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we,fe-1)]}),E.angle=.5-E.angle,E.speed=-E.speed):Ke<.75&&st>.75&&a.value[Ne(we-1,fe)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we-1,fe)]}),E.angle=1-E.angle,E.speed=-E.speed),E.angle=(E.angle%1+1)%1;for(let vt in E.effects)E.effects[vt]-=Math.abs(Ve),E.effects[vt]<=0&&delete E.effects[vt];if(E[$e])for(let vt in E[$e])E[$e][vt]-=k}Pe.building&&((R=(F=xe[Pe.building.type]).onUpdate)==null||R.call(F,Pe.building,Pe,k))}i.value/=Object.values(a.value).length*10,i.value>1&&(r.value-=2**i.value*k),r.value<=0&&L();for(let ee of Ce)ee.from.enemies.splice(ee.from.enemies.indexOf(ee.enemy),1),ee.to.enemies.push(ee.enemy),ee.from.building&&((U=(B=xe[ee.from.building.type]).onEnemyExit)==null||U.call(B,ee.from.building,ee.from,ee.enemy)),ee.to.building&&((Q=(H=xe[ee.to.building.type]).onEnemyEnter)==null||Q.call(H,ee.to.building,ee.to,ee.enemy));if(pe.value)if(un(pe.value)){if(((ce=V.selectedNode.value)==null?void 0:ce.type)=="loop"){let ee=V.selectedNode.value.state.target;if(ee.building)c(V.state).selectedNode=null;else{ee.building={type:pe.value,upgrades:{},data:{}};for(let[Pe,we]of Object.entries(xe[pe.value].baseCost))s[Pe].value-=we*v(pe.value);m.value++,y.value[pe.value]=((De=y.value[pe.value])!=null?De:0)+1,pe.value=""}}}else pe.value=""}else if(b.value==je.Stopped){for(let _e in a.value)for(let Ce of a.value[_e].enemies)Ce.angle+=.001*k;for(let _e of c(V.state).nodes){let Ce=_e.state;Ce.velocity?(_e.position.x+=Ce.velocity.x*k,_e.position.y+=Ce.velocity.y*k,Ce.velocity.y+=250*k):(_e.position.x+=Math.random()*2-1,_e.position.y+=Math.random()*2-1)}}});let x=0;const V=dr(()=>({startNodes:()=>[],state(){var F,R,B,U,H,Q,ce,De,_e,Ce,ee,Pe,we;let k=[];{let fe=[];for(let[E,Ee]of Object.entries(a.value)){let{x:Ve,y:Ke}=Jt(E);for(let st of Ee.enemies)st[Ye]||(st[Ye]=x,x+=1),fe.push({...st,position:{x:Ve,y:Ke}});Ve=Ve*100,Ke=Ke*100,Ee[Ye]||(Ee[Ye]=x,x+=2),k.push({id:(F=Ee[Ye])!=null?F:0,position:{x:Ve,y:Ke},type:"loop",state:{target:Ee}}),Ee.building&&k.push({id:((R=Ee[Ye])!=null?R:0)+1,position:{x:Ve,y:Ke},type:"building",state:{target:Ee.building}})}for(let E of fe){let{x:Ee,y:Ve}=E.position;k.push({id:(B=E[Ye])!=null?B:0,position:{x:(Ee+Math.sin(E.angle*2*Math.PI)*.5)*100,y:(Ve+Math.cos(E.angle*2*Math.PI)*.5)*100},type:"enemy",state:{target:E}})}}if(b.value==je.Stopped&&((U=c(V.state))==null?void 0:U.nodes.length)>0){let fe=(H=c(V.state))==null?void 0:H.nodes;for(let E in k)k[E].position.x=(ce=(Q=fe[E])==null?void 0:Q.position.x)!=null?ce:k[E].position.x,k[E].position.y=(_e=(De=fe[E])==null?void 0:De.position.y)!=null?_e:k[E].position.y,k[E].state=(ee=(Ce=fe[E])==null?void 0:Ce.state)!=null?ee:k[E].state}return{nodes:k,selectedNode:(we=(Pe=c(V.state))==null?void 0:Pe.selectedNode)!=null?we:null,selectedAction:null}},links(){let k=[];for(let[F,R]of Object.entries(a.value))for(let B of R.enemies)if(B[$e])for(let U in B[$e]){let H=V.nodes.value.find(ce=>ce.id==+U),Q=V.nodes.value.find(ce=>ce.id==B[Ye]);H&&Q&&k.push({startNode:H,endNode:Q,stroke:"white",strokeWidth:2}),B[$e][U]<=0&&delete B[$e][U]}return k},classes:{"game-board":!0},types:Lu})),ae=fn(()=>({width:500,height:31,direction:D.Right,progress:T(()=>n.value),display:Ie(()=>g("span",{class:"bar-label"},[$("Cycle "),oe(t.value)])),fillStyle:{backgroundColor:"#50637c"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),ge=fn(()=>({width:249,height:31,direction:D.Right,progress:T(()=>i.value),display:Ie(()=>g("span",{class:"bar-label left"},[$("Stress: "),oe(i.value*100),$("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),ne=fn(()=>({width:249,height:31,direction:D.Left,progress:T(()=>r.value/100),display:Ie(()=>g("span",{class:"bar-label right"},[$("HP: "),oe(r.value),$("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderLeft:"2px solid var(--outline)",borderRadius:"0 0 4px 0"}}));let re=0,Mt=O(!1),q=O(""),ue=O(D.Default),Fe=O({});function et(k,F,R=D.Default){q.value=k,Mt.value=!0,ue.value=R,setTimeout(()=>{var De;let B=(De=document.querySelector(".game-tooltip"))==null?void 0:De.getBoundingClientRect(),U=F.getBoundingClientRect();if(!B)return;(B.right+B.left)/2,(B.bottom+B.top)/2;let H={x:(U.right+U.left)/2,y:(U.bottom+U.top)/2},Q=_e=>Math.min(Math.max(_e,8),window.innerHeight-B.height-8),ce=_e=>Math.min(Math.max(_e,8),window.innerWidth-B.width-8);R==D.Left?Fe.value={right:window.innerWidth-(U.left-12)+"px",top:Q(H.y-B.height/2)+"px"}:R==D.Right?Fe.value={left:U.right+12+"px",top:Q(H.y-B.height/2)+"px"}:R==D.Up?Fe.value={left:ce(H.x-B.width/2)+"px",bottom:window.innerHeight-(U.top-12)+"px"}:R==D.Down&&(Fe.value={left:ce(H.x-B.width/2)+"px",top:U.bottom+12+"px"})},0)}function Et(){Mt.value=!1}let pe=O("");function un(k){if(!xe[k])return!1;let F=v(k);for(let[R,B]of Object.entries(xe[k].baseCost))if(s[R].value<B*F)return!1;return!0}function xn(k,F){var R,B;if(xe[k.type].upgrades[F].max!==void 0&&k.upgrades[F]>=((R=xe[k.type].upgrades[F].max)!=null?R:0)-1)return!1;for(let[U,H]of Object.entries(xe[k.type].upgrades[F].cost((B=k.upgrades[F])!=null?B:0)))if(s[U].value<H)return!1;return!0}function hr(k,F){var R,B;if(xn(k,F)){for(let[U,H]of Object.entries(xe[k.type].upgrades[F].cost((R=k.upgrades[F])!=null?R:0)))s[U].value-=H;k.upgrades[F]=((B=k.upgrades[F])!=null?B:0)+1}}function vr(k,F,R){re=setTimeout(()=>{let B=v(R);et(g(he,null,[g("h3",null,[F.name])," ",g("h5",{style:"display: inline-block; margin: 0"},[g("i",null,[$("- "),F.class.toUpperCase()])]),g("br",null,null),g("i",null,[F.description]),g("hr",null,null),g("h5",null,[$("BUILDING COST:")]),g("div",{class:"stat-entries"},[Object.entries(F.baseCost).map(([U,H])=>g("div",{class:{red:s[U].value<H*B}},[g("div",{class:"name"},[s[U].displayName]),g("div",{class:"value"},[oe(H*B)])]))]),g("hr",null,null),g("h5",null,[$("STARTING SPECS:")]),g("div",{class:"stat-entries"},[Object.entries(F.upgrades).map(([U,H])=>{var Q,ce;return g("div",null,[g("div",{class:"name"},[H.name]),g("div",{class:"value"},[dt(H.effect(0),(Q=H.precision)!=null?Q:0)+((ce=H.unit)!=null?ce:"")])])})])]),k.target,D.Left)},500)}function pr(k,F,R){clearTimeout(re),Et()}function br(k,F,R){clearTimeout(re),Et(),un(R)&&(pe.value=pe.value==R?"":R)}const Zt=O(!1);return{name:e,color:"#afcfef",cycle:t,cycleProgress:n,cycleBar:ae,health:r,healthBar:ne,gameState:b,gameSpeed:_,loops:a,buildingFactor:m,buildingFactors:y,resources:s,resourcesTotal:l,lifetime:u,board:V,startGame:S,endGame:L,display:Ie(()=>g(he,null,[ut(V),g("div",{class:{"game-top":!0,hidden:b.value!=je.Started||t.value<=0}},[g("div",{style:"display: flex; height: 31px"},[g("span",{class:"bar-label"},[oe(s.energy.value),$(" energy")])]),ut(ae),g("div",{style:"display: flex"},[ut(ge),ut(ne)])]),g("div",{class:{"game-bottom":!0,hidden:b.value!=je.Started}},[(()=>{var F;let k=(F=V.selectedNode.value)==null?void 0:F.state;return g(he,null,[k?g("div",{style:"display: flex; height: 31px"},[k.target.building?g("div",{class:"building-upgrades",style:{"--layer-color":xe[k.target.building.type].color}},[Object.entries(xe[k.target.building.type].upgrades).map(([R,B])=>{var H,Q,ce,De,_e,Ce,ee,Pe,we,fe,E;let U=(Q=(H=k==null?void 0:k.target.building)==null?void 0:H.upgrades[R])!=null?Q:0;return xe[(De=(ce=k==null?void 0:k.target.building)==null?void 0:ce.type)!=null?De:""].upgrades[R].max!==void 0&&U>=((ee=xe[(Ce=(_e=k==null?void 0:k.target.building)==null?void 0:_e.type)!=null?Ce:""].upgrades[R].max)!=null?ee:0)-1,g("button",{class:{feature:!0,can:xn(k==null?void 0:k.target.building,R)},onClick:()=>hr(k==null?void 0:k.target.building,R)},[$("Level "),oe(U+1)+(B.max?" / "+oe(B.max):""),g("br",null,null),g("h3",null,[B.name]),g("hr",null,null),$("\u2191 "),dt(B.effect(U+1),(Pe=B.precision)!=null?Pe:0)+((we=B.unit)!=null?we:""),$(" \u2191"),g("br",null,null),dt(B.effect(U),(fe=B.precision)!=null?fe:0)+((E=B.unit)!=null?E:""),g("br",null,null),g("hr",null,null),Object.entries(B.cost(U)).map(([Ee,Ve])=>oe(Ve)+" "+s[Ee].displayName).join(", ")])})]):g("span",{class:"bar-label"},[$("Select a building to build \u2192")])]):"",g("div",{style:"display: flex; height: 31px"},[g("span",null,[k?k.target.building?xe[k.target.building.type].name:g("i",null,[$("No building")]):pe.value?"\u25B2 Select a loop to build \u25B2":"\u25B2 Select a loop from above \u25B2"])])])})()]),g("div",{class:{"game-right":!0,hidden:b.value!=je.Started}},[g("div",{class:"building-list"},[Object.entries(xe).map(([k,F])=>g("button",{class:Object.fromEntries([[F.class,!0],["selected",pe.value==k],["disabled",!un(k)]]),onMouseenter:R=>vr(R,F,k),onMouseleave:R=>pr(),onClick:R=>br(R,F,k)},[g("div",{class:"background",style:{background:F.color}},[g("div",{class:"icon"},[F.icon])])]))])]),g("div",{class:{"game-tooltip":!0,hidden:!Mt.value,left:ue.value==D.Left,right:ue.value==D.Right,top:ue.value==D.Up,bottom:ue.value==D.Down},style:Fe.value},[q.value]),g(at,{modelValue:Zt.value},{header:()=>g("div",{style:"text-align: center"},[g("h1",{class:"result-title"},[$("GAME OVER")]),g("h2",{style:"font-style: italic;"},[$("- The cycle has been broken. -")])]),body:()=>g("div",{style:"text-align: center"},[g("div",{class:"result-entry"},[g("div",{class:"name"},[$("Cycles reached")]),g("h1",{class:"value"},[oe(t.value)])]),g("div",{class:"result-entry"},[g("div",{class:"name"},[$("Relative lifetime")]),g("div",{class:"value"},[an(u.value)])]),g("div",{style:"width: 75%; margin-top: 10px;"},[g("div",{class:"name"},[$("Total resources gained:")]),g("div",{class:"stat-entries"},[Object.entries(l).filter(([k,F])=>d.gt(F.value,0)).map(([k,F])=>g("div",null,[g("div",{class:"name"},[s[k].displayName]),g("div",{class:"value"},[oe(F.value)])]))||"Nothing :("])]),g("div",{style:"width: 75%; margin-top: 10px;"},[g("div",{class:"name"},[$("Hub rewards:")]),g("div",{class:"stat-entries"},[g("div",null,[g("div",{class:"name"},[$("XP")]),g("div",{class:"value"},[oe(p.value)])])])])]),footer:()=>g("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[g("button",{class:"feature can",onClick:()=>{setTimeout(()=>{Ze.points.value+=p.value,S()},1e3),Zt.value=!1}},[$("Replay")]),g("button",{class:"feature can",onClick:k=>{try{navigator.share({title:"Delooped",text:"I reached Cycle "+oe(t.value)+" on Delooped!",url:"https://ducdat0507.itch.io/delooped"})}catch(F){F instanceof TypeError&&(navigator.clipboard.writeText("I reached Cycle "+oe(t.value)+` on Delooped!
https://ducdat0507.itch.io/delooped`),clearTimeout(re),k.target.innerText="Copied to clipboard",re=setTimeout(()=>k.target.innerText="Share",2e3))}}},[$("Share")]),g("div",{style:"flex-grow: 1"},null),g("button",{class:"feature can",onClick:()=>{setTimeout(()=>{Ze.points.value+=p.value,b.value=je.Idle,G.tabs=["main"]},1e3),Zt.value=!1}},[$("Return to Hub")])])})])),minimizable:!1,classes:{game:!0}}});let He={standard:{name:"Standard",description:`The default game mode.
Standard rules apply.`,multiplier:1},boosted:{name:"Boosted",description:`Harder enemies.
Less health.`,multiplier:1.5},hardcore:{name:"Hardcore",description:`Hardest enemies.
No speed changes.
No overstressing.`,multiplier:2}},yt=["standard","boosted","hardcore"];const Ze=kn("main",function(){const e=lr(0),t=ur(e);let n={standard:Me(0),boosted:Me(0),hardcore:Me(0)},r=Me("standard",!1);const i=dr(()=>({startNodes:()=>[],state(){return{nodes:[{id:0,type:"play",position:{x:0,y:0}},{id:1,type:"info",position:{x:Math.sin(G.timePlayed/20)*150,y:Math.cos(G.timePlayed/20)*150}},{id:2,type:"setting",position:{x:Math.sin(G.timePlayed/20+Math.PI*.66667)*150,y:Math.cos(G.timePlayed/20+Math.PI*.66667)*150}},{id:3,type:"saves",position:{x:Math.sin(G.timePlayed/20+Math.PI*1.33333)*150,y:Math.cos(G.timePlayed/20+Math.PI*1.33333)*150}}],selectedNode:null,selectedAction:null}},classes:{"hub-board":!0},types:{play:{shape:ze.Circle,fillColor:"#afcfef",size:80,title:"\u25B6",onClick(y){a()}},info:{shape:ze.Circle,fillColor:"#afcfef",size:30,title:"i",onClick(y){var v;(v=document.querySelector(".overlay-nav :nth-child(4)"))==null||v.click()}},setting:{shape:ze.Circle,fillColor:"#afcfef",size:30,title:"\u2699\uFE0F",onClick(y){var v;(v=document.querySelector(".overlay-nav :nth-child(3)"))==null||v.click()}},saves:{shape:ze.Circle,fillColor:"#afcfef",size:30,title:"\u{1F4BE}",onClick(y){var v;(v=document.querySelector(".overlay-nav :nth-child(2)"))==null||v.click()}}}}));function a(){s.value=g("div",{style:"text-align: center"},[g("h1",{class:"result-title"},[$("NEW GAME")]),g("h2",{style:"font-style: italic;"},[$("- Select your game mode. -")])]),l.value=()=>{let y=yt.indexOf(r.value),v=yt[(y+yt.length-1)%yt.length],b=yt[(y+1)%yt.length];return g(he,null,[g("div",{class:"game-mode-holder"},[g("button",{class:"feature game-mode-card prev",onClick:()=>r.value=v},[g("h2",null,[He[v].name]),g("hr",null,null),g("i",null,[He[v].description,g("br",null,null),dt(He[v].multiplier,1),$("\xD7 XP gain.")]),g("hr",null,null),$("Highest cycle reached:"),g("br",null,null),g("h1",null,[It(n[v].value)])]),g("button",{class:"feature game-mode-card"},[g("h2",null,[He[r.value].name]),g("hr",null,null),g("i",null,[He[r.value].description,g("br",null,null),dt(He[r.value].multiplier,1),$("\xD7 XP gain.")]),g("hr",null,null),$("Highest cycle reached:"),g("br",null,null),g("h1",null,[It(n[r.value].value)])]),g("button",{class:"feature game-mode-card next",onClick:()=>r.value=b},[g("h2",null,[He[b].name]),g("hr",null,null),g("i",null,[He[b].description,g("br",null,null),dt(He[b].multiplier,1),$("\xD7 XP gain.")]),g("hr",null,null),$("Highest cycle reached:"),g("br",null,null),g("h1",null,[It(n[b].value)])])])])},m.value=g("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[g("button",{class:"feature can",onClick:()=>{u.value=!1}},[$("Back")]),g("div",{style:"flex-grow: 1"},null),g("button",{class:"feature can",onClick:()=>{G.tabs=["game"],fr.startGame(),u.value=!1}},[$("Start game")])]),u.value=!0,console.log("show game modal")}let u=O(!1),s=O(""),l=O(""),m=O("");return{name:"Tree",color:"#afcfef",classes:{hub:!0},minimizable:!1,points:e,total:t,bestCycle:n,selectedGameMode:r,board:i,display:Ie(()=>g(he,null,[ut(i),g("div",{class:"game-top"},[g("div",{style:"display: flex; height: 31px"},[g("span",{class:"bar-label"},[It(e.value),$(" xp")])])]),g(at,{modelValue:u.value,"onUpdate:modelValue":y=>u.value=y},{header:s.value,body:l.value,footer:m.value})]))}}),Xu=e=>[Ze,fr],mr=T(()=>!1);function Ku(e,t){}var Qu=Object.freeze(Object.defineProperty({__proto__:null,gameModes:He,gameModeArray:yt,main:Ze,getInitialLayers:Xu,hasWon:mr,fixOldSave:Ku},Symbol.toStringTag,{value:"Module"}));const Ht=e=>(ft("data-v-4a50ce42"),e=e(),mt(),e),ec={class:"game-over-modal-header"},tc=["src","alt"],nc={class:"game-over-modal-title"},rc=Ht(()=>h("h2",null,"Congratulations!",-1)),ic={key:0},ac=Ht(()=>h("br",null,null,-1)),oc=Ht(()=>h("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),sc=Ht(()=>h("br",null,null,-1)),lc=["href"],uc=Ht(()=>h("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),cc=K({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:r,discordLink:i,versionNumber:a,versionTitle:u}=X,s=T(()=>an(G.timePlayed)),l=T(()=>mr.value&&!G.keepGoing),m=gt(G,"autosave");function y(){G.keepGoing=!0}function v(){wt(xt())}return(b,_)=>(N(),J(at,{"model-value":l.value},{header:j(()=>[h("div",ec,[c(n)?(N(),M("img",{key:0,class:"game-over-modal-logo",src:c(n),alt:c(t)},null,8,tc)):A("",!0),h("div",nc,[rc,h("h4",null,"You've beaten "+Z(c(t))+" v"+Z(c(a))+": "+Z(c(u)),1)])])]),body:j(({shown:p})=>[p?(N(),M("div",ic,[h("div",null,"It took you "+Z(s.value)+" to beat the game.",1),ac,oc,sc,h("div",null,[h("a",{href:c(i),class:"game-over-modal-discord-link"},[uc,$(" "+Z(c(r)),1)],8,lc)]),g(tt,{title:"Autosave",modelValue:m.value,"onUpdate:modelValue":_[0]||(_[0]=S=>m.value=S)},null,8,["modelValue"])])):A("",!0)]),footer:j(()=>[h("div",{class:"game-over-footer"},[h("button",{onClick:y,class:"button"},"Keep Going"),h("button",{onClick:v,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var dc=le(cc,[["__scopeId","data-v-4a50ce42"]]);const ln=e=>(ft("data-v-2776d67d"),e=e(),mt(),e),gc=ln(()=>h("div",{class:"nan-modal-header"},[h("h2",null,"NaN value detected!")],-1)),fc={key:0},mc=ln(()=>h("br",null,null,-1)),hc=["href"],vc=ln(()=>h("span",{class:"material-icons nan-modal-discord"},"discord",-1)),pc=ln(()=>h("br",null,null,-1)),bc={class:"nan-footer"},yc=K({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=X,r=O(!0),i=O(!0),a=gt(me,"hasNaN"),u=O(null);Qe(a,b=>{b?(r.value=G.autosave,i.value=G.devSpeed===0):(G.autosave=r.value,G.devSpeed=i.value?0:null)});const s=T(()=>{var b;return(b=me.NaNPath)==null?void 0:b.join(".")}),l=T(()=>me.NaNPersistent!=null?me.NaNPersistent.value:null);function m(){me.NaNPersistent!=null&&(me.NaNPersistent.value=new d(0),me.hasNaN=!1)}function y(){me.NaNPersistent&&(me.NaNPersistent.value=new d(1),me.hasNaN=!1)}function v(){me.NaNPersistent&&(me.NaNPersistent.value=new d(NaN),me.hasNaN=!1)}return(b,_)=>(N(),M(he,null,[g(at,Ct({modelValue:a.value,"onUpdate:modelValue":_[4]||(_[4]=p=>a.value=p)},b.$attrs),{header:j(()=>[gc]),body:j(()=>[h("div",null,[$(' Attempted to assign "'+Z(s.value)+'" to NaN',1),l.value?(N(),M("span",fc,Z(" ")+"(previously "+Z(c(dt)(l.value))+")",1)):A("",!0),$(". Auto-saving has been "+Z(r.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),mc,h("div",null,[h("a",{href:c(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[vc,$(" "+Z(c(t)||"The Paper Pilot Community"),1)],8,hc)]),pc,g(tt,{title:"Autosave",modelValue:r.value,"onUpdate:modelValue":_[0]||(_[0]=p=>r.value=p)},null,8,["modelValue"]),c(X).enablePausing?(N(),J(tt,{key:0,title:"Pause game",modelValue:i.value,"onUpdate:modelValue":_[1]||(_[1]=p=>i.value=p)},null,8,["modelValue"])):A("",!0)]),footer:j(()=>[h("div",bc,[h("button",{onClick:_[2]||(_[2]=p=>{var S;return(S=u.value)==null?void 0:S.open()}),class:"button"},"Open Saves Manager"),h("button",{onClick:m,class:"button"},"Set to 0"),h("button",{onClick:y,class:"button"},"Set to 1"),l.value&&c(d).neq(l.value,0)&&c(d).neq(l.value,1)?(N(),M("button",{key:0,onClick:_[3]||(_[3]=p=>a.value=!1),class:"button"}," Set to previous ")):A("",!0),h("button",{onClick:v,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),g(or,{ref_key:"savesManager",ref:u},null,512)],64))}});var _c=le(yc,[["__scopeId","data-v-2776d67d"]]);const wc={key:0,class:"tpsDisplay"},Nc=K({__name:"TPS",setup(e){const t=T(()=>d.div(me.lastTenTicks.length,me.lastTenTicks.reduce((n,r)=>n+r,0)));return(n,r)=>t.value.isNan()?A("",!0):(N(),M("div",wc,"TPS: "+Z(c(It)(t.value)),1))}});var Sc=le(Nc,[["__scopeId","data-v-89b89152"]]);var Cc=K({__name:"App",setup(e){const t=X.useHeader,n=T(()=>Je[ie.theme].variables),r=gt(ie,"showTPS"),i=gt(me,"errors"),a=T(()=>ht(Ie(()=>g(he,null,[oa.map(ut)]))));return(u,s)=>i.value.length>0?(N(),M("div",{key:0,class:"error-container",style:Re(n.value)},[g(qn,{errors:i.value},null,8,["errors"])],4)):(N(),M(he,{key:1},[h("div",{id:"modal-root",style:Re(n.value)},null,4),h("div",{class:ye(["app",{useHeader:c(t)}]),style:Re(n.value)},[c(t)?(N(),J(sr,{key:0})):A("",!0),g(Jl),c(r.value)?(N(),J(Sc,{key:1})):A("",!0),g(dc),g(_c),(N(),J(We(a.value)))],6)],64))}});var kc=le(Cc,[["__scopeId","data-v-2d818346"]]);Te.on("setupVue",e=>e.use(Pr));function Mc(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e;let s,l,m,y;const v=async(_=!0)=>{await m,_&&(s==null||s.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()})),await(y==null?void 0:y())};async function b(){if("serviceWorker"in navigator){const{Workbox:_,messageSW:p}=await qt(()=>import("./workbox-window.4a8794bb.js"),[]);y=async()=>{l&&l.waiting&&await p(l.waiting,{type:"SKIP_WAITING"})},s=new _("./sw.js",{scope:"./",type:"classic"}),s.addEventListener("activated",S=>{S.isUpdate||r==null||r()});{const S=()=>{n==null||n()};s.addEventListener("waiting",S),s.addEventListener("externalwaiting",S)}s.register({immediate:t}).then(S=>{l=S,a?a("./sw.js",S):i==null||i(S)}).catch(S=>{u==null||u(S)})}}return m=b(),v}function Ic(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e,s=O(!1),l=O(!1);return{updateServiceWorker:Mc({immediate:t,onNeedRefresh(){s.value=!0,n==null||n()},onOfflineReady(){l.value=!0,r==null||r()},onRegistered:i,onRegisteredSW:a,onRegisterError:u}),offlineReady:l,needRefresh:s}}const In=console.error;console.error=function(...e){In(...e)};window.onerror=function(e,t,n,r,i){return me.errors.push(i instanceof Error?i:new Error(JSON.stringify(i))),In(i),!0};window.onunhandledrejection=function(e){me.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),In(e.reason)};document.title=X.title;window.projInfo=X;X.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await ta();const{globalBus:e}=await qt(()=>Promise.resolve().then(function(){return ea}),void 0),{startGameLoop:t}=await qt(()=>import("./gameLoop.ee9454f3.js"),["assets/gameLoop.ee9454f3.js","assets/@fontsource.719f4e79.css","assets/vue.d3924a70.js","assets/amator.0d8662e6.js","assets/bezier-easing.a990b400.js","assets/@vue.f39bd477.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.90a10463.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.09420910.js","assets/sortablejs.c81ffc7d.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.84096fdf.js","assets/panzoom.a3919164.js","assets/wheel.e9936e98.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.1036abd4.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=Ir(kc);n.config.errorHandler=function(r,i,a){console.error(r,a,i)},e.emit("setupVue",n),n.mount("#app"),At(()=>{const r=Er(),{updateServiceWorker:i}=Ic({onNeedRefresh(){r.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){i()}})},onOfflineReady(){r.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(a){a&&setInterval(()=>a.update(),60*60*1e3)}})}),t()});export{d as D,qt as _,me as a,X as b,Qu as c,Te as g,Yn as l,G as p,ie as s};
