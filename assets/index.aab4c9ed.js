/* empty css                    */import"./vue.d3924a70.js";import{q as Mt,D as c,ad as K,t as V,aM as N,a3 as M,aS as tt,bD as kt,H as ye,az as Et,a0 as $,aG as dn,a4 as h,K as H,Q as be,aR as Qe,a2 as B,J as Re,aa as F,ab as m,bf as U,aP as lt,aN as ut,l as Ae,u as gn,ba as Je,w as Rt,bb as fn,aO as Wt,A as Le,a1 as X,bh as mn,bB as yr,ay as _t,bk as Ot,V as _r,j as wr,bE as xn,aF as Nr,aT as Dt,aV as We,z as st,bw as Sr,bA as Cr,bl as $n,as as Tn,aK as kr,bn as Mr}from"./@vue.f39bd477.js";import{L as et}from"./lz-string.dccec454.js";import{c as Ln}from"./nanoevents.1080beb7.js";import{Y as Ir}from"./vue-next-select.90a10463.js";import{D as xr}from"./vuedraggable.09420910.js";import{p as $r}from"./vue-textarea-autosize.35804eaf.js";import{P as Tr}from"./vue-panzoom.84096fdf.js";import{s as Fr,u as Pr}from"./vue-toastification.1036abd4.js";import"./amator.0d8662e6.js";import"./bezier-easing.a990b400.js";import"./sortablejs.c81ffc7d.js";import"./panzoom.a3919164.js";import"./wheel.e9936e98.js";import"./ngraph.events.083734c6.js";const Er=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}};Er();const Or="modulepreload",Fn={},Dr="./",Vt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Dr}${r}`,r in Fn)return;Fn[r]=!0;const i=r.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${a}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":Or,i||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),i)return new Promise((o,s)=>{u.addEventListener("load",o),u.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},Vr="./projInfo-schema.json",Ar="Delooped",Lr="A project made in Profectus",Br="delooped",qr="",Rr="",zr="",Ur="0.0",jr="Initial Commit",Wr=!0,Gr=!1,Hr=2,Zr=!0,Yr=null,Jr="",Kr=["game"],Xr=1,Qr=0,ei=!0,ti="base64";var J={$schema:Vr,title:Ar,description:Lr,id:Br,author:qr,discordName:Rr,discordLink:zr,versionNumber:Ur,versionTitle:jr,allowGoBack:Wr,defaultShowSmall:Gr,defaultDecimalsShown:Hr,useHeader:Zr,banner:Yr,logo:Jr,initialTabs:Kr,maxTickLength:Xr,offlineLimit:Qr,enablePausing:ei,exportEncoding:ti};const ni=Mt({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var Z=window.player=ni;function hn(e){return JSON.stringify(e,(t,n)=>c(n))}var le=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n};const ri=["onClick"],ii=K({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=V(!1),r=V(null);function i(){t("click"),r.value&&clearTimeout(r.value),n.value=!1,Et(()=>{n.value=!0,r.value=setTimeout(()=>n.value=!1,500)})}return(a,u)=>(N(),M("button",{onClick:kt(i,["stop"]),class:ye(["feedback",{activated:n.value,left:a.left}])},[tt(a.$slots,"default",{},void 0,!0)],10,ri))}});var vn=le(ii,[["__scopeId","data-v-01a1b95c"]]);const en=e=>(lt("data-v-ac351c02"),e=e(),ut(),e),ai={class:"error"},oi={class:"error-title"},si={class:"error-details",style:{"margin-top":"-10px"}},li={key:0},ui={class:"instructions"},ci=["href"],di=en(()=>h("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),gi=en(()=>h("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),fi=en(()=>h("br",null,null,-1)),mi={key:0,style:{"margin-top":"20px"}},hi=en(()=>h("h3",null,"Other errors",-1)),vi=[hi],pi={class:"error-details"},bi={key:0,style:{"margin-top":"10px"}},yi={key:1,style:{"margin-top":"10px"}},_i=K({__name:"Error",props:{errors:{}},setup(e){const t=e,n=$(()=>t.errors[0]),r=$(()=>t.errors.map(u=>u.stack==null?[]:u.stack.split(`
`))),i=$(()=>t.errors.map(u=>u.cause==null?[]:(typeof u.cause=="string"?u.cause:JSON.stringify(u.cause)).split(`
`)));function a(){let u=hn(Z);switch(J.exportEncoding){default:console.warn(`Unknown save encoding: ${J.exportEncoding}. Defaulting to lz`);case"lz":u=et.compressToUTF16(u);break;case"base64":u=btoa(unescape(encodeURIComponent(u)));break;case"plain":break}console.log(u);const o=document.createElement("textarea");o.value=u,document.body.appendChild(o),o.select(),o.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(o)}return dn(()=>{Z.autosave=!1,Z.devSpeed=0}),(u,o)=>(N(),M("div",ai,[h("h1",oi,H(n.value.name)+": "+H(n.value.message),1),h("div",si,[n.value.cause?(N(),M("div",li,[(N(!0),M(be,null,Qe(i.value[0],s=>(N(),M("div",{key:s},H(s),1))),128))])):B("",!0),n.value.stack?(N(),M("div",{key:1,style:Re(n.value.cause?"margin-top: 10px":"")},[(N(!0),M(be,null,Qe(r.value[0],s=>(N(),M("div",{key:s},H(s),1))),128))],4)):B("",!0)]),h("div",ui,[F(" Check the console for more details, and consider sharing it with the developers on "),h("a",{href:c(J).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,ci),F("! "),m(vn,{onClick:a,class:"button",style:{display:"inline-flex"}},{default:U(()=>[di,gi]),_:1}),fi,u.errors.length>1?(N(),M("div",mi,vi)):B("",!0),(N(!0),M(be,null,Qe(u.errors.slice(1),(s,g)=>(N(),M("div",{key:g,style:{"margin-top":"20px"}},[h("details",pi,[h("summary",null,H(s.name)+": "+H(s.message),1),s.cause?(N(),M("div",bi,[(N(!0),M(be,null,Qe(i.value[g+1],_=>(N(),M("div",{key:_},H(_),1))),128))])):B("",!0),s.stack?(N(),M("div",yi,[(N(!0),M(be,null,Qe(r.value[g+1],_=>(N(),M("div",{key:_},H(_),1))),128))])):B("",!0)])]))),128))])]))}});var Bn=le(_i,[["__scopeId","data-v-ac351c02"]]);class wi{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const r=new Ni(t,n);for(this.first===void 0?(this.first=r,this.last=r):(r.next=this.first,this.first.prev=r,this.first=r),this.map.set(t,r);this.map.size>this.maxSize;){const i=this.last;this.map.delete(i.key),this.last=i.prev,this.last.next=void 0}}}class Ni{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const sn=17,Si=9e15,Ci=Math.log10(9e15),ki=1/9e15,Mi=308,Ii=-324,Pn=5,xi=(1<<10)-1,$i=function(){const e=[];for(let n=Ii+1;n<=Mi;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),ft=[2,Math.E,3,4,5,6,7,8,9,10],Ti=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],Fi=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let w=function(t){return d.fromValue_noAlloc(t)},W=function(e,t,n){return d.fromComponents(e,t,n)},Y=function(t,n,r){return d.fromComponents_noNormalize(t,n,r)};const at=function(t,n){const r=n+1,i=Math.ceil(Math.log10(Math.abs(t))),a=Math.round(t*Math.pow(10,r-i))*Math.pow(10,i-r);return parseFloat(a.toFixed(Math.max(r-i,0)))},ln=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},Pi=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const r=e*e;let i=e;return n=n+1/(12*i),i=i*r,n=n+1/(360*i),i=i*r,n=n+1/(1260*i),i=i*r,n=n+1/(1680*i),i=i*r,n=n+1/(1188*i),i=i*r,n=n+691/(360360*i),i=i*r,n=n+7/(1092*i),i=i*r,n=n+3617/(122400*i),Math.exp(n)/t},qn=.5671432904097838,En=function(e,t=1e-10){let n,r;if(!Number.isFinite(e)||e===0)return e;if(e===1)return qn;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let i=0;i<100;++i){if(r=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(r-n)<t*Math.abs(r))return r;n=r}throw Error(`Iteration failed to converge: ${e.toString()}`)};function On(e,t=1e-10){let n,r,i,a;if(!Number.isFinite(e.mag)||e.eq(d.dZero))return e;if(e.eq(d.dOne))return d.fromNumber(qn);n=d.ln(e);for(let u=0;u<100;++u){if(r=n.neg().exp(),i=n.sub(e.mul(r)),a=n.sub(i.div(n.add(1).sub(n.add(2).mul(i).div(d.mul(2,n).add(2))))),d.abs(a.sub(n)).lt(d.abs(a).mul(t)))return a;n=a}throw Error(`Iteration failed to converge: ${e.toString()}`)}const f=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof f?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/$i(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new f().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new f().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new f().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new f().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new f().fromDecimal(e)}static fromNumber(e){return new f().fromNumber(e)}static fromString(e){return new f().fromString(e)}static fromValue(e){return new f().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof f)return e;if(typeof e=="string"){const t=f.fromStringCache.get(e);return t!==void 0?t:f.fromString(e)}else return typeof e=="number"?f.fromNumber(e):f.dZero}static abs(e){return w(e).abs()}static neg(e){return w(e).neg()}static negate(e){return w(e).neg()}static negated(e){return w(e).neg()}static sign(e){return w(e).sign}static sgn(e){return w(e).sign}static round(e){return w(e).round()}static floor(e){return w(e).floor()}static ceil(e){return w(e).ceil()}static trunc(e){return w(e).trunc()}static add(e,t){return w(e).add(t)}static plus(e,t){return w(e).add(t)}static sub(e,t){return w(e).sub(t)}static subtract(e,t){return w(e).sub(t)}static minus(e,t){return w(e).sub(t)}static mul(e,t){return w(e).mul(t)}static multiply(e,t){return w(e).mul(t)}static times(e,t){return w(e).mul(t)}static div(e,t){return w(e).div(t)}static divide(e,t){return w(e).div(t)}static recip(e){return w(e).recip()}static reciprocal(e){return w(e).recip()}static reciprocate(e){return w(e).reciprocate()}static cmp(e,t){return w(e).cmp(t)}static cmpabs(e,t){return w(e).cmpabs(t)}static compare(e,t){return w(e).cmp(t)}static isNaN(e){return e=w(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=w(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return w(e).eq(t)}static equals(e,t){return w(e).eq(t)}static neq(e,t){return w(e).neq(t)}static notEquals(e,t){return w(e).notEquals(t)}static lt(e,t){return w(e).lt(t)}static lte(e,t){return w(e).lte(t)}static gt(e,t){return w(e).gt(t)}static gte(e,t){return w(e).gte(t)}static max(e,t){return w(e).max(t)}static min(e,t){return w(e).min(t)}static minabs(e,t){return w(e).minabs(t)}static maxabs(e,t){return w(e).maxabs(t)}static clamp(e,t,n){return w(e).clamp(t,n)}static clampMin(e,t){return w(e).clampMin(t)}static clampMax(e,t){return w(e).clampMax(t)}static cmp_tolerance(e,t,n){return w(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return w(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return w(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return w(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return w(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return w(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return w(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return w(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return w(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return w(e).gte_tolerance(t,n)}static pLog10(e){return w(e).pLog10()}static absLog10(e){return w(e).absLog10()}static log10(e){return w(e).log10()}static log(e,t){return w(e).log(t)}static log2(e){return w(e).log2()}static ln(e){return w(e).ln()}static logarithm(e,t){return w(e).logarithm(t)}static pow(e,t){return w(e).pow(t)}static pow10(e){return w(e).pow10()}static pow_base(e,t){return w(e).pow_base(t)}static root(e,t){return w(e).root(t)}static factorial(e,t){return w(e).factorial()}static gamma(e,t){return w(e).gamma()}static lngamma(e,t){return w(e).lngamma()}static exp(e){return w(e).exp()}static sqr(e){return w(e).sqr()}static sqrt(e){return w(e).sqrt()}static cube(e){return w(e).cube()}static cbrt(e){return w(e).cbrt()}static tetrate(e,t=2,n=Y(1,0,1)){return w(e).tetrate(t,n)}static iteratedexp(e,t=2,n=Y(1,0,1)){return w(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return w(e).iteratedlog(t,n)}static layeradd10(e,t){return w(e).layeradd10(t)}static layeradd(e,t,n=10){return w(e).layeradd(t,n)}static slog(e,t=10){return w(e).slog(t)}static lambertw(e){return w(e).lambertw()}static ssqrt(e){return w(e).ssqrt()}static pentate(e,t=2,n=Y(1,0,1)){return w(e).pentate(t,n)}static sin(e){return w(e).sin()}static cos(e){return w(e).cos()}static tan(e){return w(e).tan()}static asin(e){return w(e).asin()}static acos(e){return w(e).acos()}static atan(e){return w(e).atan()}static sinh(e){return w(e).sinh()}static cosh(e){return w(e).cosh()}static tanh(e){return w(e).tanh()}static asinh(e){return w(e).asinh()}static acosh(e){return w(e).acosh()}static atanh(e){return w(e).atanh()}static affordGeometricSeries(e,t,n,r){return this.affordGeometricSeries_core(w(e),w(t),w(n),r)}static sumGeometricSeries(e,t,n,r){return this.sumGeometricSeries_core(e,w(t),w(n),r)}static affordArithmeticSeries(e,t,n,r){return this.affordArithmeticSeries_core(w(e),w(t),w(n),w(r))}static sumArithmeticSeries(e,t,n,r){return this.sumArithmeticSeries_core(w(e),w(t),w(n),w(r))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(w(e),w(t),w(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return Y(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return Y(t,0,1);const n=Math.floor(Math.random()*(e+1));let r=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(r=Math.trunc(r));let i=Math.pow(10,r);return Math.random()>.9&&(i=Math.trunc(i)),W(t,n,i)}static affordGeometricSeries_core(e,t,n,r){const i=t.mul(n.pow(r));return f.floor(e.div(i).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,r){return t.mul(n.pow(r)).mul(f.sub(1,n.pow(e))).div(f.sub(1,n))}static affordArithmeticSeries_core(e,t,n,r){const a=t.add(r.mul(n)).sub(n.div(2)),u=a.pow(2);return a.neg().add(u.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,r){const i=t.add(r.mul(n));return e.div(2).mul(i.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<ki)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=Si)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<Ci&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=f.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const r=e.split("^^^");if(r.length===2){const v=parseFloat(r[0]),S=parseFloat(r[1]),A=r[1].split(";");let P=1;if(A.length===2&&(P=parseFloat(A[1]),isFinite(P)||(P=1)),isFinite(v)&&isFinite(S)){const C=f.pentate(v,S,P);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const i=e.split("^^");if(i.length===2){const v=parseFloat(i[0]),S=parseFloat(i[1]),A=i[1].split(";");let P=1;if(A.length===2&&(P=parseFloat(A[1]),isFinite(P)||(P=1)),isFinite(v)&&isFinite(S)){const C=f.tetrate(v,S,P);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const a=e.split("^");if(a.length===2){const v=parseFloat(a[0]),S=parseFloat(a[1]);if(isFinite(v)&&isFinite(S)){const A=f.pow(v,S);return this.sign=A.sign,this.layer=A.layer,this.mag=A.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}e=e.trim().toLowerCase();let u,o,s=e.split("pt");if(s.length===2){u=10,o=parseFloat(s[0]),s[1]=s[1].replace("(",""),s[1]=s[1].replace(")","");let v=parseFloat(s[1]);if(isFinite(v)||(v=1),isFinite(u)&&isFinite(o)){const S=f.tetrate(u,o,v);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}if(s=e.split("p"),s.length===2){u=10,o=parseFloat(s[0]),s[1]=s[1].replace("(",""),s[1]=s[1].replace(")","");let v=parseFloat(s[1]);if(isFinite(v)||(v=1),isFinite(u)&&isFinite(o)){const S=f.tetrate(u,o,v);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}const g=e.split("e"),_=g.length-1;if(_===0){const v=parseFloat(e);if(isFinite(v))return this.fromNumber(v),f.fromStringCache.size>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}else if(_===1){const v=parseFloat(e);if(isFinite(v)&&v!==0)return this.fromNumber(v),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}const b=e.split("e^");if(b.length===2){this.sign=1,b[0].charAt(0)=="-"&&(this.sign=-1);let v="";for(let S=0;S<b[1].length;++S){const A=b[1].charCodeAt(S);if(A>=43&&A<=57||A===101)v+=b[1].charAt(S);else return this.layer=parseFloat(v),this.mag=parseFloat(b[1].substr(S+1)),this.normalize(),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}}if(_<1)return this.sign=0,this.layer=0,this.mag=0,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this;const p=parseFloat(g[0]);if(p===0)return this.sign=0,this.layer=0,this.mag=0,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this;let y=parseFloat(g[g.length-1]);if(_>=2){const v=parseFloat(g[g.length-2]);isFinite(v)&&(y*=Math.sign(v),y+=ln(v))}if(!isFinite(p))this.sign=g[0]==="-"?-1:1,this.layer=_,this.mag=y;else if(_===1)this.sign=Math.sign(p),this.layer=1,this.mag=y+Math.log10(Math.abs(p));else if(this.sign=Math.sign(p),this.layer=_,_===2){const v=f.mul(W(1,2,y),w(p));return this.sign=v.sign,this.layer=v.layer,this.mag=v.mag,f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}else this.mag=y;return this.normalize(),f.fromStringCache.maxSize>=1&&f.fromStringCache.set(t,f.fromDecimal(this)),this}fromValue(e){return e instanceof f?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:at(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:at(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=Pn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):at(this.m,e)+"e"+at(this.e,e):this.layer===1?at(this.m,e)+"e"+at(this.e,e):this.layer<=Pn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+at(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+at(this.mag,e)}abs(){return Y(this.sign===0?0:1,this.layer,this.mag)}neg(){return Y(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?f.dZero:this.layer===0?W(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=w(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return Y(0,0,0);let n,r;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(f.cmpabs(this,t)>0?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return f.fromNumber(n.sign*n.mag+r.sign*r.mag);const i=n.layer*Math.sign(n.mag),a=r.layer*Math.sign(r.mag);if(i-a>=2)return n;if(i===0&&a===-1){if(Math.abs(r.mag-Math.log10(n.mag))>sn)return n;{const u=Math.pow(10,Math.log10(n.mag)-r.mag),o=r.sign+n.sign*u;return W(Math.sign(o),1,r.mag+Math.log10(Math.abs(o)))}}if(i===1&&a===0){if(Math.abs(n.mag-Math.log10(r.mag))>sn)return n;{const u=Math.pow(10,n.mag-Math.log10(r.mag)),o=r.sign+n.sign*u;return W(Math.sign(o),1,Math.log10(r.mag)+Math.log10(Math.abs(o)))}}if(Math.abs(n.mag-r.mag)>sn)return n;{const u=Math.pow(10,n.mag-r.mag),o=r.sign+n.sign*u;return W(Math.sign(o),1,r.mag+Math.log10(Math.abs(o)))}}plus(e){return this.add(e)}sub(e){return this.add(w(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=w(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return Y(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return Y(this.sign*t.sign,0,1);let n,r;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return f.fromNumber(n.sign*r.sign*n.mag*r.mag);if(n.layer>=3||n.layer-r.layer>=2)return W(n.sign*r.sign,n.layer,n.mag);if(n.layer===1&&r.layer===0)return W(n.sign*r.sign,1,n.mag+Math.log10(r.mag));if(n.layer===1&&r.layer===1)return W(n.sign*r.sign,1,n.mag+r.mag);if(n.layer===2&&r.layer===1){const i=W(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(W(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return W(n.sign*r.sign,i.layer+1,i.sign*i.mag)}if(n.layer===2&&r.layer===2){const i=W(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(W(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return W(n.sign*r.sign,i.layer+1,i.sign*i.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=w(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?f.dNaN:this.layer===0?W(this.sign,0,1/this.mag):W(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=w(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=w(e),n=this.mag>0?this.layer:-this.layer,r=t.mag>0?t.layer:-t.layer;return n>r?1:n<r?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=w(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=w(e);return this.lt(t)?t:this}min(e){const t=w(e);return this.gt(t)?t:this}maxabs(e){const t=w(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=w(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=w(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let r=this.mag,i=n.mag;return this.layer>n.layer&&(i=ln(i)),this.layer<n.layer&&(r=ln(r)),Math.abs(r-i)<=t*Math.max(Math.abs(r),Math.abs(i))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=w(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=w(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=w(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(f.dZero)?f.dZero:this.log10()}absLog10(){return this.sign===0?f.dNaN:this.layer>0?W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):W(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?f.dNaN:this.layer>0?W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):W(this.sign,0,Math.log10(this.mag))}log(e){return e=w(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?f.dNaN:this.layer===0&&e.layer===0?W(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):f.div(this.log10(),e.log10())}log2(){return this.sign<=0?f.dNaN:this.layer===0?W(this.sign,0,Math.log2(this.mag)):this.layer===1?W(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?W(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?f.dNaN:this.layer===0?W(this.sign,0,Math.log(this.mag)):this.layer===1?W(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?W(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):W(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=w(e),n=this,r=t;if(n.sign===0)return r.eq(0)?Y(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(r.sign===0)return Y(1,0,1);if(r.sign===1&&r.layer===0&&r.mag===1)return n;const i=n.absLog10().mul(r).pow10();return this.sign===-1?Math.abs(r.toNumber()%2)%2===1?i.neg():Math.abs(r.toNumber()%2)%2===0?i:f.dNaN:i}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return f.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return W(1,0,t);if(e.sign===0)return f.dOne;e=Y(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?W(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?W(-e.sign,e.layer+1,-e.mag):f.dOne}pow_base(e){return w(e).pow(this)}root(e){const t=w(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?f.exp(f.mul(this,f.ln(this).sub(1))):f.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(Y(1,0,24)))return f.fromNumber(Pi(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let r=e,i=12*r,a=1/i,u=t+a;if(u===t||(t=u,r=r*n,i=360*r,a=1/i,u=t-a,u===t))return f.exp(t);t=u,r=r*n,i=1260*r;let o=1/i;return t=t+o,r=r*n,i=1680*r,o=1/i,t=t-o,f.exp(t)}else return this.layer===1?f.exp(f.mul(this,f.ln(this).sub(1))):f.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?f.dOne:this.layer===0&&this.mag<=709.7?f.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?W(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?W(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):W(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return f.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return W(1,2,Math.log10(this.mag)-.3010299956639812);{const e=f.div(Y(this.sign,this.layer-1,this.mag),Y(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=Y(1,0,1)){if(e===1)return f.pow(this,t);if(e===0)return new f(t);if(this.eq(f.dOne))return f.dOne;if(this.eq(-1))return f.pow(this,t);if(e===Number.POSITIVE_INFINITY){const i=this.toNumber();if(i<=1.444667861009766&&i>=.06598803584531254){if(i>1.444667861009099)return f.fromNumber(Math.E);const a=f.ln(this).neg();return a.lambertw().div(a)}else return i>1.444667861009766?f.fromNumber(Number.POSITIVE_INFINITY):f.dNaN}if(this.eq(f.dZero)){let i=Math.abs((e+1)%2);return i>1&&(i=2-i),f.fromNumber(i)}if(e<0)return f.iteratedlog(t,this,-e);t=w(t);const n=e;e=Math.trunc(e);const r=n-e;if(this.gt(f.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let i=0;i<e;++i){const a=t;if(t=this.pow(t),a.eq(t))return t}if(r!=0){const i=this.pow(t);return t.mul(1-r).add(i.mul(r))}return t}r!==0&&(t.eq(f.dOne)?this.gt(10)?t=this.pow(r):(t=f.fromNumber(f.tetrate_critical(this.toNumber(),r)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return Y(t.sign,t.layer+(e-i-1),t.mag);if(i>1e4)return t}return t}iteratedexp(e=2,t=Y(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return f.tetrate(e,-t,this);e=w(e);let n=f.fromDecimal(this);const r=t;t=Math.trunc(t);const i=r-t;if(n.layer-e.layer>3){const a=Math.min(t,n.layer-e.layer-3);t-=a,n.layer-=a}for(let a=0;a<t;++a){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(a>1e4)return n}return i>0&&i<1&&(e.eq(10)?n=n.layeradd10(-i):n=n.layeradd(-i,e)),n}slog(e=10,t=100){let n=.001,r=!1,i=!1,a=this.slog_internal(e).toNumber();for(let u=1;u<t;++u){const s=new f(e).tetrate(a).gt(this);if(u>1&&i!=s&&(r=!0),i=s,r?n/=2:n*=2,n=Math.abs(n)*(s?-1:1),a+=n,n===0)break}return f.fromNumber(a)}slog_internal(e=10){if(e=w(e),e.lte(f.dZero)||e.eq(f.dOne))return f.dNaN;if(e.lt(f.dOne))return this.eq(f.dOne)?f.dZero:this.eq(f.dZero)?f.dNegOne:f.dNaN;if(this.mag<0||this.eq(f.dZero))return f.dNegOne;let t=0,n=f.fromDecimal(this);if(n.layer-e.layer>3){const r=n.layer-e.layer-3;t+=r,n.layer-=r}for(let r=0;r<100;++r)if(n.lt(f.dZero))n=f.pow(e,n),t-=1;else{if(n.lte(f.dOne))return f.fromNumber(t+f.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=f.log(n,e)}return f.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:f.critical_section(e,t,Fi)}static tetrate_critical(e,t){return f.critical_section(e,t,Ti)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let r=0,i=0;for(let u=0;u<ft.length;++u)if(ft[u]==e){r=n[u][Math.floor(t)],i=n[u][Math.ceil(t)];break}else if(ft[u]<e&&ft[u+1]>e){const o=(e-ft[u])/(ft[u+1]-ft[u]);r=n[u][Math.floor(t)]*(1-o)+n[u+1][Math.floor(t)]*o,i=n[u][Math.ceil(t)]*(1-o)+n[u+1][Math.ceil(t)]*o;break}const a=t-Math.floor(t);return r<=0||i<=0?r*(1-a)+i*a:Math.pow(e,Math.log(r)/Math.log(e)*(1-a)+Math.log(i)/Math.log(e)*a)}layeradd10(e){e=f.fromValue_noAlloc(e).toNumber();const t=f.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let r=0;r<100;++r){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const r=this.slog(t).toNumber()+e;return r>=0?f.tetrate(t,r):Number.isFinite(r)?r>=-1?f.log(f.tetrate(t,r+1),t):f.log(f.log(f.tetrate(t,r+2),t),t):f.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return f.fromNumber(En(this.toNumber()));if(this.layer===0)return f.fromNumber(En(this.sign*this.mag));if(this.layer===1)return On(this);if(this.layer===2)return On(this);if(this.layer>=3)return Y(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return Y(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=Y(1,0,1)){t=w(t);const n=e;e=Math.trunc(e);const r=n-e;r!==0&&(t.eq(f.dOne)?(++e,t=f.fromNumber(r)):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(i>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.sin(this.sign*this.mag)):Y(0,0,0)}cos(){return this.mag<0?f.dOne:this.layer===0?f.fromNumber(Math.cos(this.sign*this.mag)):Y(0,0,0)}tan(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.tan(this.sign*this.mag)):Y(0,0,0)}asin(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.asin(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?f.fromNumber(Math.acos(this.toNumber())):this.layer===0?f.fromNumber(Math.acos(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?f.fromNumber(Math.atan(this.sign*this.mag)):f.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return f.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return f.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?Y(Number.NaN,Number.NaN,Number.NaN):f.ln(this.add(1).div(f.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(f.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let d=f;d.fromStringCache=new wi(xi);d.dZero=Y(0,0,0);d.dOne=Y(1,0,1);d.dNegOne=Y(-1,0,1);d.dTwo=Y(1,0,2);d.dTen=Y(1,0,10);d.dNaN=Y(Number.NaN,Number.NaN,Number.NaN);d.dInf=Y(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);d.dNegInf=Y(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);d.dNumberMax=W(1,0,Number.MAX_VALUE);d.dNumberMin=W(1,0,Number.MIN_VALUE);w=d.fromValue_noAlloc;W=d.fromComponents;Y=d.fromComponents_noNormalize;d.fromMantissaExponent;d.fromMantissaExponent_noNormalize;const Ei=new d(1);function $t(e,t,n=!0){let r=d.log10(e).floor(),i=d.div(e,d.pow(10,r));i.toStringWithDecimalPlaces(t)==="10"&&(i=Ei,r=r.add(1));const a=r.gte(1e9)?je(r,Math.max(Math.max(t,3),J.defaultDecimalsShown)):r.gte(1e4)?Yt(r,0):r.toStringWithDecimalPlaces(0);return n?i.toStringWithDecimalPlaces(t)+"e"+a:"e"+a}function Yt(e,t){if(e==null)return"NaN";if(e=new d(e),e.mag<.001)return 0 .toFixed(t);const r=e.toStringWithDecimalPlaces(t).split(".");return r[0]=r[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),r.length==1?r[0]:r[0]+"."+r[1]}function Rn(e,t){return e==null?"NaN":(e=new d(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),J.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const Oi=new d("eeee1000"),Di=new d("e100000"),Dn=new d("e1000"),zn=new d(1e9),Vi=new d(1e6),Ai=new d(1e3),Li=new d(.98),Bi=new d(.001),Un=new d(0);function je(e,t,n){if(t==null&&(t=J.defaultDecimalsShown),n=n!=null?n:J.defaultShowSmall,e=new d(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+je(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(Oi)){const r=e.slog();return r.gte(Vi)?"F"+je(r.floor()):d.pow(10,r.sub(r.floor())).toStringWithDecimalPlaces(3)+"F"+Yt(r.floor(),0)}else{if(e.gte(Di))return $t(e,0,!1);if(e.gte(Dn))return $t(e,0);if(e.gte(zn))return $t(e,t);if(e.gte(Ai))return Yt(e,0);if(e.gte(Bi)||!n)return Rn(e,t);if(e.eq(Un))return 0 .toFixed(t)}return e=Wn(e),e.lt(Dn)?$t(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):je(e,t)+"\u207B\xB9"}function oe(e){return e=new d(e),e.sign<0?"-"+oe(e.neg()):e.gte(zn)||e.lte(Li)&&!e.eq(Un)?je(e):je(e,0)}function jn(e){return d.lt(e,0)?"-"+jn(d.neg(e)):d.gt(e,2**51)?je(d.div(e,31536e3))+"y":(e=new d(e).toNumber(),e<60?je(e)+"s":e<3600?oe(Math.floor(e/60))+"m "+je(e%60)+"s":e<86400?oe(Math.floor(e/3600))+"h "+oe(Math.floor(e/60)%60)+"m "+oe(e%60)+"s":e<31536e3?oe(Math.floor(e/84600)%365)+"d "+oe(Math.floor(e/3600)%24)+"h "+oe(Math.floor(e/60)%60)+"m":oe(Math.floor(e/31536e3))+"y "+oe(Math.floor(e/84600)%365)+"d "+oe(Math.floor(e/3600)%24)+"h")}function qi(e,t,n){e=new d(e);let r=e.toStringWithDecimalPlaces(t);return new d(r).gte(n)&&(r=d.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),r}function Ri(e,t){return je(e,t,!0)}function Wn(e){let t=d.log10(e).ceil();const n=d.div(e,d.pow(10,t));return t=t.neg(),e=new d(10).pow(t).times(n),e}var zi=Object.freeze(Object.defineProperty({__proto__:null,default:d,exponentialFormat:$t,commaFormat:Yt,regularFormat:Rn,format:je,formatWhole:oe,formatTime:jn,toPlaces:qi,formatSmall:Ri,invertOOM:Wn},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:Ui,commaFormat:ji,regularFormat:Wi,format:Pt,formatWhole:pn,formatTime:tn,toPlaces:Gi,formatSmall:Hi,invertOOM:Zi}=zi;window.Decimal=d;window.exponentialFormat=Ui;window.commaFormat=ji;window.regularFormat=Wi;window.format=Pt;window.formatWhole=pn;window.formatTime=tn;window.toPlaces=Gi;window.formatSmall=Hi;window.invertOOM=Zi;function Yi(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function Jt(e){return typeof e=="function"}var O=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(O||{});const At=Symbol("DoNotCache");function R(e,t){const n=e[t];Jt(n)&&n.length===0&&!n[At]?e[t]=$(n.bind(e)):Jt(n)&&(e[t]=n.bind(e),e[t][At]=!0)}function Vn(e){return Jt(e)&&!e[At]&&(e=$(e)),e}const nn=Symbol("Component"),rn=Symbol("GatherProps");let Ji=0;function Gn(e="feature-"){return e+Ji++}var Lt=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(Lt||{});function bn(e){const t=c(e);return t!==2&&t!==!1}function Ki(e){return c(e)===1}function Me(e){return e[At]=!0,e}function ke(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function Xi(e,...t){const n=[],r=i=>{Object.keys(i).forEach(a=>{const u=i[a];u!=null&&typeof u=="object"&&(t.includes(u.type)?n.push(u):!(u instanceof d)&&!Ae(u)&&r(u))})};return r(e),n}var me=window.state=gn({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:Mt([])});const mt={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var yn=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(yn||{}),He={classic:mt,paper:{...mt,variables:{...mt.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...mt,variables:{...mt.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...mt,variables:{...mt.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const Ie=Ln();"fonts"in document&&(document.fonts.onloadingdone=()=>Ie.emit("fontsLoaded"));var Qi=Object.freeze(Object.defineProperty({__proto__:null,globalBus:Ie},Symbol.toStringTag,{value:"Module"}));function Hn(e={}){return Object.assign({id:`${J.id}-0`,name:"Default Save",tabs:J.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:J.id,modVersion:J.versionNumber,layers:{}},e)}function qe(e){const t=et.compressToUTF16(hn(e!=null?e:Z));return localStorage.setItem((e!=null?e:Z).id,t),t}async function ea(){na();try{let e=localStorage.getItem(ie.active);if(e==null){await vt(St());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=et.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==J.id){await vt(St());return}t.id=ie.active,await vt(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await vt(St())}}function St(){const e=Ht(),t=Hn({id:e});return qe(t),ie.saves.push(e),t}function Ht(){let e,t=0;do e=`${J.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const Zn=V(!1);async function vt(e){console.info("Loading save",e),Zn.value=!0;const{layers:t,removeLayer:n,addLayer:r}=await Vt(()=>Promise.resolve().then(function(){return Qo}),void 0),{fixOldSave:i,getInitialLayers:a}=await Vt(()=>Promise.resolve().then(function(){return Ju}),void 0);for(const u in t){const o=t[u];o&&n(o)}a(e).forEach(u=>r(u,e)),e=Hn(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,J.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==J.versionNumber&&(i(e.modVersion,e),e.modVersion=J.versionNumber),Object.assign(Z,e),ie.active=Z.id,Ie.emit("onLoad")}setInterval(()=>{Z.autosave&&qe()},1e3);window.onbeforeunload=()=>{Z.autosave&&qe()};window.save=qe;const ta=window.hardReset=async()=>{await vt(St())};window.deleteLowerSaves=()=>{const e=Object.values(ie.saves).indexOf(Z.id)+1;Object.values(ie.saves).slice(e).forEach(t=>localStorage.removeItem(t)),ie.saves=ie.saves.slice(0,e)};const Bt=Mt({active:"",saves:[],showTPS:!0,theme:yn.Nordic,unthrottled:!1,alignUnits:!1});Je(Bt,e=>{const t=et.compressToUTF16(JSON.stringify(e));localStorage.setItem(J.id,t)},{deep:!0});var ie=window.settings=Bt;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:yn.Nordic,alignUnits:!1};Ie.emit("loadSettings",e),Object.assign(Bt,e),ta()};function na(){try{let e=localStorage.getItem(J.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=et.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(Bt,t)}Ie.emit("loadSettings",Bt)}catch{}}const ra=Mt([]),ia=Mt([]),aa=Mt([]),oa={class:"table"};K({__name:"Column",setup(e){const t=$(()=>He[ie.theme].mergeAdjacent);return(n,r)=>(N(),M("div",oa,[h("div",{class:ye(["col",{mergeAdjacent:t.value}])},[tt(n.$slots,"default")],2)]))}});const sa={class:"table"};K({__name:"Row",setup(e){const t=$(()=>He[ie.theme].mergeAdjacent);return(n,r)=>(N(),M("div",sa,[h("div",{class:ye(["row",{mergeAdjacent:t.value}])},[tt(n.$slots,"default")],2)]))}});function ct(e,t="span"){return typeof e=="function"?K({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),K({template:e})):K({render:()=>({})}):e}function pt(e){if(Yn(e))return typeof e=="function"?e():ct(e);const t=e[nn];return m(t,e[rn](),null)}function la(e){if(Yn(e))return typeof e=="function"?e():typeof e=="string"?m(be,null,[e]):m(e,null,null);const t=e[nn];return m(t,e[rn](),null)}function Yn(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[At]===!0}function ua(e,t="div"){const n=Rt();return fn(()=>{n.value=ct(Ze(e),t)}),n}function zt(e,t="div"){const n=Rt(null);return fn(()=>{const r=Ze(e);n.value=r==""||r==null?null:ct(r,t)}),n}function Ze(e){return c(c(e))}function se(...e){return e.includes(Object)||e.push(Object),e}const ca=K({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var _;const n=V({}),r=new ResizeObserver(o),i=V(null);dn(()=>{const b=i.value;b!=null&&r.observe(b)});let a=!0,u=V((_=i.value)==null?void 0:_.getBoundingClientRect());function o(){a&&(a=!1,Et(()=>{var b;u.value=(b=i.value)==null?void 0:b.getBoundingClientRect(),Object.values(n.value).filter(p=>p).forEach(p=>p.rect=p.element.getBoundingClientRect()),t("updateNodes",n.value),a=!0}))}Ie.on("fontsLoaded",o);const s={attributes:!1,childList:!0,subtree:!1};Wt(wn,(b,p)=>{const y=new MutationObserver(()=>g(b));y.observe(p,s),n.value[b]={element:p,observer:y,rect:p.getBoundingClientRect()},o()}),Wt(Nn,b=>{var p;(p=n.value[b])==null||p.observer.disconnect(),n.value[b]=void 0,o()}),Wt(Xn,n),Wt(Qn,u);function g(b){const p=n.value[b];p!=null&&(p.rect=p.element.getBoundingClientRect(),t("updateNodes",n.value))}return(b,p)=>(N(),M(be,null,[tt(b.$slots,"default",{},void 0,!0),h("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Jn=le(ca,[["__scopeId","data-v-2b1dc1bc"]]);const da=["onPointerdown"],ga={class:"modal-wrapper"},fa={class:"modal-container"},ma={class:"modal-header"},ha={class:"modal-body"},va={class:"modal-footer"},pa=h("div",{class:"modal-default-flex-grow"},null,-1),dt=K({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const i=Le(e),a=$(()=>c(i.modelValue)||o.value);function u(){n("update:modelValue",!1)}const o=V(!1),s=V(null),g=$(()=>{var _,b;return(b=(_=s.value)==null?void 0:_.nodes)!=null?b:null});return t({isOpen:a,nodes:g}),(_,b)=>(N(),X(_r,{to:"#modal-root"},[m(Ot,{name:"modal",onBeforeEnter:b[0]||(b[0]=p=>o.value=!0),onAfterLeave:b[1]||(b[1]=p=>o.value=!1)},{default:U(()=>[mn(h("div",_t({class:"modal-mask",onPointerdown:kt(u,["self"])},_.$attrs),[h("div",ga,[h("div",fa,[h("div",ma,[tt(_.$slots,"header",{shown:a.value},()=>[F(" default header ")])]),h("div",ha,[m(Jn,{ref_key:"contextRef",ref:s},{default:U(()=>[tt(_.$slots,"body",{shown:a.value},()=>[F(" default body ")])]),_:3},512)]),h("div",va,[tt(_.$slots,"footer",{shown:a.value},()=>[h("div",{class:"modal-default-footer"},[pa,h("button",{class:"button modal-default-button",onClick:u}," Close ")])])])])])],16,da),[[yr,_.modelValue]])]),_:3})]))}}),ht=Symbol("ProxyState");function _n(e,t={}){const n=t;let r=!1,i=!1;function a(){return r||(i&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),i=!0,Object.assign(n,e.call(n,n)),r=!0),n}return new Proxy(n,{get(u,o){if(o===ht)return a();const s=a()[o];return s!=null&&typeof s=="object"&&ot in s?s[ot]:s},set(u,o,s){return a()[o]=s,!0},has(u,o){return o===ht?!0:Reflect.has(a(),o)},ownKeys(){return Reflect.ownKeys(a())},getOwnPropertyDescriptor(u,o){return r||(Object.assign(n,e.call(n,n)),r=!0),Object.getOwnPropertyDescriptor(u,o)}})}const Kn=d.ln(10);function Tt(e){return e}function ba(e,t){return I(t)?t.invert(d.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function ya(e,t){return I(t)?t.isIntegrable()?l.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),l.constant(0)):(console.error("Could not integrate due to no input being a variable"),l.constant(0))}function _a(e){return l.neg(e)}function wa(e,t,n){return I(t)?t.invert(d.sub(e,he(n))):I(n)?n.invert(d.sub(e,he(t))):(console.error("Could not invert due to no input being a variable"),0)}function Na(e,t,n){var r,i;if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const a=t.getIntegralFormula(e);return l.times(n,(r=t.innermostVariable)!=null?r:0).add(a)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const a=n.getIntegralFormula(e);return l.times(t,(i=n.innermostVariable)!=null?i:0).add(a)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Sa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.add(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e);return l.add(r,t)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Ca(e,t,n){return I(t)?t.invert(d.add(e,he(n))):I(n)?n.invert(d.sub(he(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function ka(e,t,n){var r,i;if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const a=t.getIntegralFormula(e);return l.sub(a,l.times(n,(r=t.innermostVariable)!=null?r:0))}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const a=n.getIntegralFormula(e);return l.times(t,(i=n.innermostVariable)!=null?i:0).sub(a)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Ma(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.sub(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e);return l.sub(r,t)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Ia(e,t,n){return I(t)?t.invert(d.div(e,he(n))):I(n)?n.invert(d.div(e,he(t))):(console.error("Could not invert due to no input being a variable"),0)}function xa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.times(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e);return l.times(r,t)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function $a(e,t,n){return I(t)?l.div(e,n):I(n)?l.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),l.constant(0))}function Ta(e,t,n){return I(t)?t.invert(d.mul(e,he(n))):I(n)?n.invert(d.div(he(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Fa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.div(r,n)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e);return l.div(t,r)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Pa(e,t,n){return I(t)?l.mul(e,n):I(n)?l.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),l.constant(0))}function Ea(e,t){return I(t)?t.invert(d.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function Oa(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.ln(n)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Da(e,t){return I(t)?t.invert(d.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function Va(e){return d.ln(e).sub(1).times(e).div(Kn)}function Aa(e,t){if(I(t)){const n=Kn.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function La(e,t){return I(t)?t.isIntegrable()?new l({inputs:[t.getIntegralFormula(e)],evaluate:Va,invert:Aa}):(console.error("Could not integrate due to variable not being integrable"),l.constant(0)):(console.error("Could not integrate due to no input being a variable"),l.constant(0))}function Ba(e,t,n){return I(t)?t.invert(d.pow(he(n),e)):I(n)?n.invert(d.root(he(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function qa(e,t){return d.ln(e).sub(1).times(e).div(d.ln(t))}function Ra(e,t,n){if(I(t)){const r=d.ln(he(n)).times(e);return t.invert(r.div(r.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function za(e,t,n){return I(t)?t.isIntegrable()?new l({inputs:[t.getIntegralFormula(e),n],evaluate:qa,invert:Ra}):(console.error("Could not integrate due to variable not being integrable"),l.constant(0)):(console.error("Could not integrate due to no input being a variable"),l.constant(0))}function Ua(e,t){return I(t)?t.invert(d.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function ja(e){return d.ln(e).sub(1).times(e).div(d.ln(2))}function Wa(e,t){if(I(t)){const n=d.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Ga(e,t){return I(t)?t.isIntegrable()?new l({inputs:[t.getIntegralFormula(e)],evaluate:ja,invert:Wa}):(console.error("Could not integrate due to variable not being integrable"),l.constant(0)):(console.error("Could not integrate due to no input being a variable"),l.constant(0))}function Ha(e,t){return I(t)?t.invert(d.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function Za(e){return d.ln(e).sub(1).times(e)}function Ya(e,t){return I(t)?t.invert(d.div(e,d.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Ja(e,t){return I(t)?t.isIntegrable()?new l({inputs:[t.getIntegralFormula(e)],evaluate:Za,invert:Ya}):(console.error("Could not integrate due to variable not being integrable"),l.constant(0)):(console.error("Could not integrate due to no input being a variable"),l.constant(0))}function Ka(e,t,n){return I(t)?t.invert(d.root(e,he(n))):I(n)?n.invert(d.ln(e).div(d.ln(he(t)))):(console.error("Could not invert due to no input being a variable"),0)}function Xa(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e),i=l.add(n,1);return l.pow(r,i).div(i)}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e);return l.pow(t,r).div(l.ln(t))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Qa(e,t){return I(t)?t.invert(d.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function eo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.pow10(n).div(l.ln(10))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function to(e,t,n){return I(t)?t.invert(d.ln(e).div(d.ln(he(n)))):I(n)?n.invert(d.root(he(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function no(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.pow(n,r).div(l.ln(n))}else if(I(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=n.getIntegralFormula(e),i=l.add(t,1);return l.pow(r,i).div(i)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function ro(e,t,n){return I(t)?t.invert(d.root(e,d.recip(he(n)))):I(n)?n.invert(d.ln(he(t)).div(d.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function io(e,t,n){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const r=t.getIntegralFormula(e);return l.pow(r,l.recip(n).add(1)).times(n).div(l.add(n,1))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function ao(e,t){return I(t)?t.invert(d.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function oo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.exp(n)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function so(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){const r=d.minabs(t,1e308).toNumber();return d.tetrate(e,r,n)}function lo(e,t,n,r){return I(t)?t.invert(d.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function uo(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){const r=d.minabs(t,1e308).toNumber();return d.iteratedexp(e,r,new d(n))}function co(e,t,n,r){return I(t)?t.invert(d.iteratedlog(e,Math.E,d.minabs(1e308,he(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function go(e,t=10,n=2){const r=d.minabs(n,1e308).toNumber();return d.iteratedlog(e,t,r)}function fo(e,t=10){const n=d.minabs(t,1e308).toNumber();return d.slog(e,n)}function mo(e,t,n){return I(t)?t.invert(d.tetrate(e,d.minabs(1e308,he(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function ho(e,t,n){const r=d.minabs(t,1e308).toNumber();return d.layeradd(e,r,n)}function vo(e,t,n,r){return I(t)?t.invert(d.layeradd(e,d.minabs(1e308,he(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function po(e,t){return I(t)?t.invert(d.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function bo(e,t){return I(t)?t.invert(d.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function yo(e,t,n){const r=d.minabs(t,1e308).toNumber();return d.pentate(e,r,n)}function _o(e,t){return I(t)?t.invert(d.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function wo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function No(e,t){return I(t)?t.invert(d.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function So(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.sin(n)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Co(e,t){return I(t)?t.invert(d.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function ko(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Mo(e,t){return I(t)?t.invert(d.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function Io(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.asin(n).times(n).add(l.sqrt(l.sub(1,l.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function xo(e,t){return I(t)?t.invert(d.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function $o(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.acos(n).times(n).sub(l.sqrt(l.sub(1,l.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function To(e,t){return I(t)?t.invert(d.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Fo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.atan(n).times(n).sub(l.ln(l.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Po(e,t){return I(t)?t.invert(d.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Eo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.cosh(n)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Oo(e,t){return I(t)?t.invert(d.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Do(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.sinh(n)}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Vo(e,t){return I(t)?t.invert(d.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ao(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function Lo(e,t){return I(t)?t.invert(d.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Bo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.asinh(n).times(n).sub(l.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function qo(e,t){return I(t)?t.invert(d.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ro(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.acosh(n).times(n).sub(l.add(n,1).sqrt().times(l.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function zo(e,t){return I(t)?t.invert(d.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Uo(e,t){if(I(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),l.constant(0);const n=t.getIntegralFormula(e);return l.atanh(n).times(n).add(l.sub(1,l.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),l.constant(0)}function It(e){return(t,n)=>new l({inputs:[t,n],evaluate:e,invert:Tt})}function I(e){return e instanceof de&&e.hasVariable()}function he(e,t){return e instanceof de?e.evaluate(t):c(e)}function jo(){return l.pow(this,2).div(2)}function Wo(){return this}const pe=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&ot in n?n[ot]:n)),"variable"in e?(typeof e.variable=="object"&&ot in e.variable&&(e.variable=e.variable[ot]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:jo,internalIntegrateInner:Wo,applySubstitution:Tt}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var p,y;const{inputs:t,evaluate:n,invert:r,integrate:i,integrateInner:a,applySubstitution:u}=e,o=t.reduce((v,S)=>v+(S instanceof pe?S.internalVariables:0),0),s=t.find(v=>v instanceof pe&&v.hasVariable()),g=o===1?s==null?void 0:s.innermostVariable:void 0,_=(p=s==null?void 0:s.isInvertible())!=null?p:!1,b=(y=s==null?void 0:s.isIntegrable())!=null?y:!1;return{inputs:t,internalEvaluate:n,internalInvert:_?r:void 0,internalIntegrate:b?i:void 0,internalIntegrateInner:a,applySubstitution:u,innermostVariable:g,internalVariables:o}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,r;return(r=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(i=>he(i,e))))!=null?n:this.hasVariable()?e:null)!=null?r:he(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof pe&&e.inputs[n]instanceof pe?t.equals(e.inputs[n]):!(t instanceof pe)&&!(e.inputs[n]instanceof pe)&&d.eq(c(t),c(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new l({inputs:[e]})}static variable(e){return new l({variable:e})}static step(e,t,n){const r=n(l.variable(0)),i=Vn(t);function a(o){return d.lt(o,c(i))?o:d.add(r.evaluate(d.sub(o,c(i))),c(i))}function u(o,s){return I(s)&&r.isInvertible()?(d.gt(o,c(i))&&(o=d.add(r.invert(d.sub(o,c(i))),c(i))),s.invert(o)):(console.error("Could not invert due to no input being a variable"),0)}return new l({inputs:[e],evaluate:a,invert:r.isInvertible()&&r.hasVariable()?u:void 0})}static if(e,t,n,r){const i=V(0),a=l.variable(i),u=n(a),o=r==null?void 0:r(a),s=Vn(t);function g(b){return c(s)?(i.value=b,u.evaluate()):o?(i.value=b,o.evaluate()):b}function _(b,p){return!I(p)||!u.isInvertible()||o!=null&&!o.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):c(s)?p.invert(u.invert(b)):o?p.invert(o.invert(b)):p.invert(b)}return new l({inputs:[e],evaluate:g,invert:u.isInvertible()&&u.hasVariable()?_:void 0})}static conditional(e,t,n,r){return l.if(e,t,n,r)}static abs(e){return new l({inputs:[e],evaluate:d.abs})}static neg(e){return new l({inputs:[e],evaluate:d.neg,invert:ba,applySubstitution:_a,integrate:ya})}static sign(e){return new l({inputs:[e],evaluate:d.sign})}static round(e){return new l({inputs:[e],evaluate:d.round})}static floor(e){return new l({inputs:[e],evaluate:d.floor})}static ceil(e){return new l({inputs:[e],evaluate:d.ceil})}static trunc(e){return new l({inputs:[e],evaluate:d.trunc})}static add(e,t){return new l({inputs:[e,t],evaluate:d.add,invert:wa,integrate:Na,integrateInner:Sa,applySubstitution:Tt})}static sub(e,t){return new l({inputs:[e,t],evaluate:d.sub,invert:Ca,integrate:ka,integrateInner:Ma,applySubstitution:Tt})}static mul(e,t){return new l({inputs:[e,t],evaluate:d.mul,invert:Ia,integrate:xa,applySubstitution:$a})}static div(e,t){return new l({inputs:[e,t],evaluate:d.div,invert:Ta,integrate:Fa,applySubstitution:Pa})}static recip(e){return new l({inputs:[e],evaluate:d.recip,invert:Ea,integrate:Oa})}static clamp(e,t,n){return new l({inputs:[e,t,n],evaluate:d.clamp,invert:Tt})}static pLog10(e){return new l({inputs:[e],evaluate:d.pLog10})}static absLog10(e){return new l({inputs:[e],evaluate:d.absLog10})}static log10(e){return new l({inputs:[e],evaluate:d.log10,invert:Da,integrate:La})}static log(e,t){return new l({inputs:[e,t],evaluate:d.log,invert:Ba,integrate:za})}static log2(e){return new l({inputs:[e],evaluate:d.log2,invert:Ua,integrate:Ga})}static ln(e){return new l({inputs:[e],evaluate:d.ln,invert:Ha,integrate:Ja})}static pow(e,t){return new l({inputs:[e,t],evaluate:d.pow,invert:Ka,integrate:Xa})}static pow10(e){return new l({inputs:[e],evaluate:d.pow10,invert:Qa,integrate:eo})}static pow_base(e,t){return new l({inputs:[e,t],evaluate:d.pow_base,invert:to,integrate:no})}static root(e,t){return new l({inputs:[e,t],evaluate:d.root,invert:ro,integrate:io})}static factorial(e){return new l({inputs:[e],evaluate:d.factorial})}static gamma(e){return new l({inputs:[e],evaluate:d.gamma})}static lngamma(e){return new l({inputs:[e],evaluate:d.lngamma})}static exp(e){return new l({inputs:[e],evaluate:d.exp,invert:ao,integrate:oo})}static sqr(e){return l.pow(e,2)}static sqrt(e){return l.root(e,2)}static cube(e){return l.pow(e,3)}static cbrt(e){return l.root(e,3)}static tetrate(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new l({inputs:[e,t,n],evaluate:so,invert:lo})}static iteratedexp(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new l({inputs:[e,t,n],evaluate:uo,invert:co})}static iteratedlog(e,t=10,n=1){return new l({inputs:[e,t,n],evaluate:go})}static slog(e,t=10){return new l({inputs:[e,t],evaluate:fo,invert:mo})}static layeradd10(e,t){return new l({inputs:[e,t],evaluate:d.layeradd10})}static layeradd(e,t,n=10){return new l({inputs:[e,t,n],evaluate:ho,invert:vo})}static lambertw(e){return new l({inputs:[e],evaluate:d.lambertw,invert:po})}static ssqrt(e){return new l({inputs:[e],evaluate:d.ssqrt,invert:bo})}static pentate(e,t=2,n=d.fromComponents_noNormalize(1,0,1)){return new l({inputs:[e,t,n],evaluate:yo})}static sin(e){return new l({inputs:[e],evaluate:d.sin,invert:Mo,integrate:wo})}static cos(e){return new l({inputs:[e],evaluate:d.cos,invert:xo,integrate:So})}static tan(e){return new l({inputs:[e],evaluate:d.tan,invert:To,integrate:ko})}static asin(e){return new l({inputs:[e],evaluate:d.asin,invert:_o,integrate:Io})}static acos(e){return new l({inputs:[e],evaluate:d.acos,invert:No,integrate:$o})}static atan(e){return new l({inputs:[e],evaluate:d.atan,invert:Co,integrate:Fo})}static sinh(e){return new l({inputs:[e],evaluate:d.sinh,invert:Lo,integrate:Eo})}static cosh(e){return new l({inputs:[e],evaluate:d.cosh,invert:qo,integrate:Do})}static tanh(e){return new l({inputs:[e],evaluate:d.tanh,invert:zo,integrate:Ao})}static asinh(e){return new l({inputs:[e],evaluate:d.asinh,invert:Po,integrate:Bo})}static acosh(e){return new l({inputs:[e],evaluate:d.acosh,invert:Oo,integrate:Ro})}static atanh(e){return new l({inputs:[e],evaluate:d.atanh,invert:Vo,integrate:Uo})}step(e,t){return l.step(this,e,t)}if(e,t){return l.if(this,e,t)}conditional(e,t){return l.if(this,e,t)}abs(){return l.abs(this)}neg(){return l.neg(this)}sign(){return l.sign(this)}round(){return l.round(this)}floor(){return l.floor(this)}ceil(){return l.ceil(this)}trunc(){return l.trunc(this)}add(e){return l.add(this,e)}sub(e){return l.sub(this,e)}mul(e){return l.mul(this,e)}div(e){return l.div(this,e)}recip(){return l.recip(this)}max(e){return l.max(this,e)}min(e){return l.min(this,e)}maxabs(e){return l.maxabs(this,e)}minabs(e){return l.minabs(this,e)}clamp(e,t){return l.clamp(this,e,t)}clampMin(e){return l.clampMin(this,e)}clampMax(e){return l.clampMax(this,e)}pLog10(){return l.pLog10(this)}absLog10(){return l.absLog10(this)}log10(){return l.log10(this)}log(e){return l.log(this,e)}log2(){return l.log2(this)}ln(){return l.ln(this)}pow(e){return l.pow(this,e)}pow10(){return l.pow10(this)}pow_base(e){return l.pow_base(this,e)}root(e){return l.root(this,e)}factorial(){return l.factorial(this)}gamma(){return l.gamma(this)}lngamma(){return l.lngamma(this)}exp(){return l.exp(this)}sqr(){return l.pow(this,2)}sqrt(){return l.root(this,2)}cube(){return l.pow(this,3)}cbrt(){return l.root(this,3)}tetrate(e=2,t=d.fromComponents_noNormalize(1,0,1)){return l.tetrate(this,e,t)}iteratedexp(e=2,t=d.fromComponents_noNormalize(1,0,1)){return l.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return l.iteratedlog(this,e,t)}slog(e=10){return l.slog(this,e)}layeradd10(e){return l.layeradd10(this,e)}layeradd(e,t){return l.layeradd(this,e,t)}lambertw(){return l.lambertw(this)}ssqrt(){return l.ssqrt(this)}pentate(e=2,t=d.fromComponents_noNormalize(1,0,1)){return l.pentate(this,e,t)}sin(){return l.sin(this)}cos(){return l.cos(this)}tan(){return l.tan(this)}asin(){return l.asin(this)}acos(){return l.acos(this)}atan(){return l.atan(this)}sinh(){return l.sinh(this)}cosh(){return l.cosh(this)}tanh(){return l.tanh(this)}asinh(){return l.asinh(this)}acosh(){return l.acosh(this)}atanh(){return l.atanh(this)}};let de=pe;de.negate=pe.neg;de.negated=pe.neg;de.sgn=pe.sign;de.plus=pe.add;de.subtract=pe.sub;de.minus=pe.sub;de.multiply=pe.mul;de.times=pe.mul;de.divide=pe.div;de.divideBy=pe.div;de.dividedBy=pe.div;de.reciprocal=pe.recip;de.reciprocate=pe.recip;de.max=It(d.max);de.min=It(d.min);de.minabs=It(d.minabs);de.maxabs=It(d.maxabs);de.clampMin=It(d.clampMin);de.clampMax=It(d.clampMax);de.logarithm=pe.log;class l extends de{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=d.add(this.evaluate(0),this.evaluate(1)).div(2);return d.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),l.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(r=>n=r(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),l.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),l.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),l.constant(0)))}}const Ct=Symbol("PersistentState"),qt=Symbol("DefaultValue"),Kt=Symbol("StackTrace"),Xt=Symbol("Deleted"),ot=Symbol("NonPersistent"),bt=Symbol("SaveDataPath"),Go=Symbol("SkipPersistence");function Ho(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function An(e,t){var n;d.isNaN(t)&&(me.hasNaN||(Z.autosave=!1,me.hasNaN=!0,me.NaNPath=e[bt],me.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[bt])==null?void 0:n.join(".")}`)),e[Ct].value=t}function Be(e,t=!0){const n=Ae(e)?e:V(e);Ae(e)&&(e=e.value);const r=$({get(){return n.value},set(a){t?An(i,a):i[Ct].value=a}});r[qt]=e;const i={get value(){return n.value},set value(a){t?An(i,a):i[Ct].value=a},__v_isRef:!0,[Ct]:n,[qt]:e,[Kt]:Ho(),[Xt]:!1,[ot]:r,[bt]:void 0};return Ve.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",i,`
Created at:
`+i[Kt]):yt[Ve[Ve.length-1]].add(i),i}function Zo(e){return e!=null&&typeof e=="object"&&Ct in e}function Yo(e){Ve.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):yt[Ve[Ve.length-1]].delete(e),e[Xt]=!0}Ie.on("addLayer",(e,t)=>{const n=[],r=(i,a=[])=>{let u=!1;return Object.keys(i).forEach(o=>{let s=i[o];if(s!=null&&typeof s=="object"){if(s[Go]===!0)return;if(ht in s&&(s=s[ht]),Zo(s)){if(u=!0,s[Xt]){console.warn("Deleted persistent ref present in returned object. Ignoring...",s,`
Created at:
`+s[Kt]);return}yt[e.id].delete(s);const g=[e.id,...a,o];s[bt]!=null&&JSON.stringify(g)!==JSON.stringify(s[bt])&&console.error(`Persistent ref is being saved to \`${g.join(".")}\` when it's already present at \`${s[bt].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),s[bt]=g;const _=a.reduce((p,y)=>(y in p||(p[y]={}),p[y]),t),b=_[o];_[o]=s[Ct],wr(_)?b!=null?_[o]=b:_[o]=s[qt]:b!=null?_[o].value=b:_[o].value=s[qt]}else!(s instanceof d)&&!(s instanceof l)&&!Ae(s)&&!n.includes(s)&&(typeof s.type=="symbol"&&n.push(s),r(s,[...a,o])&&(xn(s)&&!xn(i)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",ht in i?i[ht]:i,o):u=!0))}}),u};r(e[ht]),yt[e.id].forEach(i=>{i[Xt]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+i[Kt])}),yt[e.id].clear()});const wn=Symbol("RegisterNode"),Nn=Symbol("UnregisterNode"),Xn=Symbol("Nodes"),Qn=Symbol("Bounds"),Ee=gn({});window.layers=Ee;const yt={},Ve=[];function Sn(e,t){return _n(()=>{const n={},r=n.emitter=Ln();if(n.on=r.on.bind(r),n.emit=r.emit.bind(r),n.nodes=V({}),n.id=e,Ve.push(e),yt[e]=new Set,n.minimized=Be(!1,!1),Object.assign(n,t.call(n,n)),Ve[Ve.length-1]==null||Ve[Ve.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${Ve}
Trying to pop ${n.id}`);Ve.pop(),R(n,"color"),R(n,"display"),R(n,"classes"),R(n,"style"),R(n,"name"),ke(n,"name",n.id),R(n,"minWidth"),ke(n,"minWidth",600),R(n,"minimizable"),ke(n,"minimizable",!0),R(n,"minimizedDisplay");const i=n.style;return n.style=$(()=>{var u,o;let a=c(n.minWidth);return(typeof a=="number"||!Number.isNaN(parseInt(a)))&&(a=a+"px"),[(u=c(i))!=null?u:"",(o=n.minimized)!=null&&o.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:a,flexBasis:a,margin:""}]}),n})}function er(e,t){if(console.info("Adding layer",e.id),Ee[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Ee[e.id]);return}ke(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Ee[e.id]=e,Ie.emit("addLayer",e,t.layers[e.id])}function Jo(e){return Ee[e]}function tr(e){console.info("Removing layer",e.id),Ie.emit("removeLayer",e),Ee[e.id]=void 0}function Ko(e){tr(e),er(e,Z)}function Xo(e){const t=V(!1);return{openModal:()=>t.value=!0,modal:Me(()=>m(dt,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>m("h2",null,[c(e.name)]),body:c(e.display)}))}}Ie.on("update",function(t){Object.values(Ee).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Ee).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Ee).forEach(n=>{n==null||n.emit("postUpdate",t)})});var Qo=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:wn,UnregisterNodeInjectionKey:Nn,NodesInjectionKey:Xn,BoundsInjectionKey:Qn,layers:Ee,persistentRefs:yt,addingLayers:Ve,createLayer:Sn,addLayer:er,getLayer:Jo,removeLayer:tr,reloadLayer:Ko,setupLayerModal:Xo},Symbol.toStringTag,{value:"Module"}));const es=K({components:{Context:Jn,ErrorVue:Bn},props:{index:{type:Number,required:!0},display:{type:se(Object,String,Function),required:!0},minimizedDisplay:se(Object,String,Function),minimized:{type:Object,required:!0},name:{type:se(String),required:!0},color:se(String),minimizable:se(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:r,minimizedDisplay:i}=Le(e),a=ua(t),u=zt(i),o=$(()=>J.allowGoBack&&n.value>0&&!Ze(r));function s(){Z.tabs.splice(c(e.index),1/0)}function g(b){e.nodes.value=b}const _=V([]);return Nr((b,p,y)=>(console.warn(`Error caught in "${e.name}" layer`,b,p,y),_.value.push(b instanceof Error?b:new Error(JSON.stringify(b))),!1)),{component:a,minimizedComponent:u,showGoBack:o,updateNodes:g,unref:c,goBack:s,errors:_}}}),ts={key:1};function ns(e,t,n,r,i,a){const u=Dt("ErrorVue"),o=Dt("Context");return e.errors.length>0?(N(),X(u,{key:0,errors:e.errors},null,8,["errors"])):(N(),M("div",_t({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(N(),M("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...s)=>e.goBack&&e.goBack(...s))},"\u274C")):B("",!0),e.unref(e.minimized)?(N(),M("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=s=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(N(),X(We(e.minimizedComponent),{key:0})):(N(),M("div",ts,H(e.unref(e.name)),1))])):(N(),M("div",{key:2,class:ye(["layer-tab",{showGoBack:e.showGoBack}])},[m(o,{onUpdateNodes:e.updateNodes},{default:U(()=>[(N(),X(We(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(N(),M("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=s=>e.$emit("setMinimized",!0))}," \u25BC ")):B("",!0)],16))}var rs=le(es,[["render",ns],["__scopeId","data-v-a9f5b1da"]]);const nr=e=>(lt("data-v-4b4bda40"),e=e(),ut(),e),is=nr(()=>h("h2",null,"Changelog",-1)),as=nr(()=>h("details",{open:""},[h("summary",null,[F("v0.0 Initial Commit - "),h("time",null,"2021-09-04")]),F(" This is the first release :D "),h("ul",null,[h("li",{class:"feature"},"Did everything"),h("li",{class:"fix"},"Had some fun"),h("li",{class:"breaking"},"Removed everything"),h("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),os=K({__name:"Changelog",setup(e,{expose:t}){const n=V(!1);return t({open(){n.value=!0}}),(r,i)=>(N(),X(dt,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},{header:U(()=>[is]),body:U(()=>[as]),_:1},8,["modelValue"]))}});var rr=le(os,[["__scopeId","data-v-4b4bda40"]]),ss=K({props:{element:Object,display:{type:se(Object,String,Function),required:!0},style:se(Object,String,Array),classes:se(Object),direction:se(String),xoffset:se(String),yoffset:se(String),pinned:Object},setup(e){const{element:t,display:n,pinned:r}=Le(e),i=V(!1),a=$(()=>(Ze(r)||i.value)&&u.value),u=zt(n),o=Rt(ct(Me(()=>{const _=Ze(t);return _==null?"":la(_)})));function s(_){const b=r;_.shiftKey&&b&&(b.value=!b.value,_.stopPropagation(),_.preventDefault())}const g=$(()=>Ze(r)&&He[ie.theme].showPin);return{Direction:O,isHovered:i,isShown:a,comp:u,elementComp:o,unref:c,togglePinned:s,showPin:g}}});const ls={key:0,class:"material-icons pinned"};function us(e,t,n,r,i,a){return N(),M("div",{class:ye(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=u=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=u=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...u)=>e.togglePinned&&e.togglePinned(...u))},[tt(e.$slots,"default",{},void 0,!0),e.elementComp?(N(),X(We(e.elementComp),{key:0})):B("",!0),m(Ot,{name:"fade"},{default:U(()=>{var u;return[e.isShown?(N(),M("div",{key:0,class:ye(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:Re([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(u=e.unref(e.style))!=null?u:{}])},[e.showPin?(N(),M("span",ls,"push_pin")):B("",!0),e.comp?(N(),X(We(e.comp),{key:1})):B("",!0)],6)):B("",!0)]}),_:1})],34)}var Se=le(ss,[["render",us],["__scopeId","data-v-6102fa3a"]]);const wt=e=>(lt("data-v-1d8b74fd"),e=e(),ut(),e),cs={class:"info-modal-header"},ds=["src","alt"],gs={class:"info-modal-title"},fs={key:0},ms={key:0},hs={key:0},vs=wt(()=>h("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),ps=wt(()=>h("br",null,null,-1)),bs=wt(()=>h("br",null,null,-1)),ys=["href"],_s=wt(()=>h("span",{class:"material-icons info-modal-discord"},"discord",-1)),ws=wt(()=>h("div",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),F(" The Paper Pilot Community ")])],-1)),Ns=wt(()=>h("div",null,[h("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),F(" The Modding Tree ")])],-1)),Ss=wt(()=>h("br",null,null,-1));var Cs=K({__name:"Info",props:{changelog:{}},setup(e,{expose:t}){const n=e,{title:r,logo:i,author:a,discordName:u,discordLink:o,versionNumber:s,versionTitle:g}=J,_=Le(n),b=V(!1),p=$(()=>tn(Z.timePlayed)),y=$(()=>ct(Me(()=>m(be,null,[ia.map(pt)]))));t({open(){b.value=!0}});function v(){var S;console.log(_.changelog),(S=c(_.changelog))==null||S.open()}return(S,A)=>(N(),X(dt,{modelValue:b.value,"onUpdate:modelValue":A[0]||(A[0]=P=>b.value=P)},{header:U(()=>[h("div",cs,[c(i)?(N(),M("img",{key:0,class:"info-modal-logo",src:c(i),alt:c(r)},null,8,ds)):B("",!0),h("div",gs,[h("h2",null,H(c(r)),1),h("h4",null,[F(" v"+H(c(s)),1),c(g)?(N(),M("span",fs,": "+H(c(g)),1)):B("",!0)])])])]),body:U(({shown:P})=>[P?(N(),M("div",ms,[c(a)?(N(),M("div",hs,"By "+H(c(a)),1)):B("",!0),vs,ps,h("div",{class:"link",onClick:v},"Changelog"),bs,h("div",null,[c(o)?(N(),M("a",{key:0,href:c(o),class:"info-modal-discord-link",target:"_blank"},[_s,F(" "+H(c(u)),1)],8,ys)):B("",!0)]),ws,Ns,Ss,h("div",null,"Time Played: "+H(p.value),1),(N(),X(We(y.value)))])):B("",!0)]),_:1},8,["modelValue"]))}});var ir=le(Cs,[["__scopeId","data-v-1d8b74fd"]]);const ks={class:"field"},Ms={key:0,class:"field-title"},ar=K({__name:"Select",props:{title:{type:[String,Object,Function]},modelValue:{},options:{},placeholder:{},closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var u;const n=e,r=zt(st(n,"title"),"span"),i=V((u=n.options.find(o=>o.value===n.modelValue))!=null?u:null);Je(st(n,"modelValue"),o=>{var s;Ze(i)!==o&&(i.value=(s=n.options.find(g=>g.value===o))!=null?s:null)});function a(o){t("update:modelValue",o.value)}return(o,s)=>(N(),M("div",ks,[c(r)?(N(),M("span",Ms,[(N(),X(We(c(r))))])):B("",!0),m(c(Ir),{options:o.options,modelValue:i.value,"onUpdate:modelValue":[s[0]||(s[0]=g=>i.value=g),a],min:1,"label-by":"label",placeholder:o.placeholder,"close-on-select":o.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const Is={class:"field"},xs=K({__name:"Toggle",props:{title:{type:[String,Object,Function]},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,r=$(()=>{var a;return ct((a=c(n.title))!=null?a:"<span></span>","span")}),i=$({get(){return!!n.modelValue},set(a){t("update:modelValue",a)}});return(a,u)=>(N(),M("label",Is,[mn(h("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o)},null,512),[[Sr,i.value]]),(N(),X(We(r.value)))]))}});var Xe=le(xs,[["__scopeId","data-v-11046116"]]);const $s={class:"header"},Ts=h("h2",null,"Settings",-1),Fs={class:"option-tabs"},Ps={key:0},Es={key:1};var or=K({__name:"Options",setup(e,{expose:t}){const n=V(!1),r=V("behaviour");function i(ge){return ge==r.value}function a(ge){r.value=ge}t({isTab:i,setTab:a,save:qe,open(){n.value=!0}});const u=Object.keys(He).map(ge=>({label:Yi(ge),value:ge})),o=$(()=>ct(Me(()=>m(be,null,[ra.map(pt)])))),{showTPS:s,theme:g,unthrottled:_,alignUnits:b}=Le(ie),{autosave:p,offlineProd:y}=Le(Z),v=$({get(){return Z.devSpeed===0},set(ge){Z.devSpeed=ge?0:null}}),S=Me(()=>m("span",{class:"option-title"},[F("Unthrottled"),m("desc",null,[F("Allow the game to run as fast as possible. Not battery friendly.")])])),A=Me(()=>m("span",{class:"option-title"},[F("Offline Production"),m(Se,{display:"Save-specific",direction:O.Right},{default:()=>[F("*")]}),m("desc",null,[F("Simulate production that occurs while the game is closed.")])])),P=Me(()=>m("span",{class:"option-title"},[F("Autosave"),m(Se,{display:"Save-specific",direction:O.Right},{default:()=>[F("*")]}),m("desc",null,[F("Automatically save the game every second or when the game is closed.")])])),C=Me(()=>m("span",{class:"option-title"},[F("Pause game"),m(Se,{display:"Save-specific",direction:O.Right},{default:()=>[F("*")]}),m("desc",null,[F("Stop everything from moving.")])])),x=Me(()=>m("span",{class:"option-title"},[F("Theme"),m("desc",null,[F("How the game looks.")])])),D=Me(()=>m("span",{class:"option-title"},[F("Show TPS"),m("desc",null,[F("Show TPS meter at the bottom-left corner of the page.")])])),ae=Me(()=>m("span",{class:"option-title"},[F("Align modifier units"),m("desc",null,[F("Align numbers to the beginning of the unit in modifier view.")])]));return(ge,ne)=>(N(),X(dt,{modelValue:n.value,"onUpdate:modelValue":ne[10]||(ne[10]=re=>n.value=re)},{header:U(()=>[h("div",$s,[Ts,h("div",Fs,[h("button",{class:ye({selected:i("behaviour")}),onClick:ne[0]||(ne[0]=re=>a("behaviour"))},"Behaviour",2),h("button",{class:ye({selected:i("appearance")}),onClick:ne[1]||(ne[1]=re=>a("appearance"))},"Appearance",2)])])]),body:U(()=>[i("behaviour")?(N(),M("div",Ps,[m(Xe,{title:c(S),modelValue:c(_),"onUpdate:modelValue":ne[2]||(ne[2]=re=>Ae(_)?_.value=re:null)},null,8,["title","modelValue"]),c(J).enablePausing?(N(),X(Xe,{key:0,title:c(C),modelValue:v.value,"onUpdate:modelValue":ne[3]||(ne[3]=re=>v.value=re)},null,8,["title","modelValue"])):B("",!0),c(J).offlineLimit>0?(N(),X(Xe,{key:1,title:c(A),modelValue:c(y),"onUpdate:modelValue":ne[4]||(ne[4]=re=>Ae(y)?y.value=re:null)},null,8,["title","modelValue"])):B("",!0),m(Xe,{title:c(P),modelValue:c(p),"onUpdate:modelValue":ne[5]||(ne[5]=re=>Ae(p)?p.value=re:null)},null,8,["title","modelValue"]),c(p)?B("",!0):(N(),X(vn,{key:2,class:"button save-button",onClick:ne[6]||(ne[6]=re=>c(qe)())},{default:U(()=>[F("Manually save")]),_:1}))])):B("",!0),i("appearance")?(N(),M("div",Es,[m(ar,{title:c(x),options:c(u),modelValue:c(g),"onUpdate:modelValue":ne[7]||(ne[7]=re=>Ae(g)?g.value=re:null)},null,8,["title","options","modelValue"]),(N(),X(We(o.value))),m(Xe,{title:c(D),modelValue:c(s),"onUpdate:modelValue":ne[8]||(ne[8]=re=>Ae(s)?s.value=re:null)},null,8,["title","modelValue"]),m(Xe,{title:c(ae),modelValue:c(b),"onUpdate:modelValue":ne[9]||(ne[9]=re=>Ae(b)?b.value=re:null)},null,8,["title","modelValue"])])):B("",!0)]),_:1},8,["modelValue"]))}});const Os=["onSubmit"],Ds={class:"field"},Vs={key:0,class:"field-title"},As=["placeholder"],Ls=K({__name:"Text",props:{title:{type:[String,Object,Function]},modelValue:{},textArea:{type:Boolean},placeholder:{},maxHeight:{},submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,r=zt(st(n,"title"),"span"),i=Rt(null);dn(()=>{var s;(s=i.value)==null||s.focus()});const a=$({get(){var s;return(s=c(n.modelValue))!=null?s:""},set(s){t("update:modelValue",s)}});function u(){t("submit")}function o(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(s,g)=>(N(),M("form",{onSubmit:kt(u,["prevent"])},[h("div",Ds,[c(r)?(N(),M("span",Vs,[(N(),X(We(c(r))))])):B("",!0),s.textArea?(N(),X(c($r),{key:1,modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=_=>a.value=_),placeholder:s.placeholder,maxHeight:s.maxHeight,onBlur:o,ref_key:"field",ref:i},null,8,["modelValue","placeholder","maxHeight"])):mn((N(),M("input",{key:2,type:"text","onUpdate:modelValue":g[1]||(g[1]=_=>a.value=_),placeholder:s.placeholder,class:ye({fullWidth:!s.title}),onBlur:o,ref_key:"field",ref:i},null,42,As)),[[Cr,a.value]])])],40,Os))}});var sr=le(Ls,[["__scopeId","data-v-90bd4994"]]);const Bs={key:0},qs=["onClick","disabled"],Rs={key:0},zs=["onClick"],Us=K({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const r=Le(e),i=V(!1);Je(i,o=>{t("confirmingChanged",o)});function a(){if(c(r.skipConfirm)){t("click");return}i.value&&t("click"),i.value=!i.value}function u(){i.value=!1}return(o,s)=>(N(),M("span",{class:ye(["container",{confirming:i.value}])},[i.value?(N(),M("span",Bs,"Are you sure?")):B("",!0),h("button",{onClick:kt(a,["stop"]),class:"button danger",disabled:o.disabled},[i.value?(N(),M("span",Rs,"Yes")):tt(o.$slots,"default",{key:1},void 0,!0)],8,qs),i.value?(N(),M("button",{key:1,class:"button",onClick:kt(u,["stop"])},"No",8,zs)):B("",!0)],2))}});var js=le(Us,[["__scopeId","data-v-2f8ef34c"]]);const rt=e=>(lt("data-v-32313015"),e=e(),ut(),e),Ws=rt(()=>h("div",{class:"handle material-icons"},"drag_handle",-1)),Gs={key:0,class:"actions"},Hs=rt(()=>h("span",{class:"material-icons"},"content_paste",-1)),Zs=rt(()=>h("span",{class:"material-icons"},"content_copy",-1)),Ys=rt(()=>h("span",{class:"material-icons"},"edit",-1)),Js=rt(()=>h("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Ks={key:1,class:"actions"},Xs=rt(()=>h("span",{class:"material-icons"},"check",-1)),Qs=rt(()=>h("span",{class:"material-icons"},"close",-1)),el={key:2,class:"details"},tl={class:"save-version"},nl=rt(()=>h("br",null,null,-1)),rl={key:0},il={key:3,class:"details"},al={key:4,class:"details error"},ol=rt(()=>h("br",null,null,-1)),sl=K({__name:"Save",props:{save:{}},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:r}=Le(n),i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),a=V(!1),u=V(!1),o=V("");Je(a,()=>{var b;return o.value=(b=r.value.name)!=null?b:""});const s=$(()=>r.value!=null&&r.value.id===Z.id),g=$(()=>{var b;return s.value?Z.time:(b=r.value!=null&&r.value.time)!=null?b:0});function _(){t("editName",o.value),a.value=!1}return(b,p)=>(N(),M("div",{class:ye(["save",{active:s.value}])},[Ws,a.value?(N(),M("div",Ks,[h("button",{onClick:_,class:"button"},[m(Se,{display:"Save",direction:c(O).Left,class:"info"},{default:U(()=>[Xs]),_:1},8,["direction"])]),h("button",{onClick:p[5]||(p[5]=y=>a.value=!a.value),class:"button"},[m(Se,{display:"Cancel",direction:c(O).Left,class:"info"},{default:U(()=>[Qs]),_:1},8,["direction"])])])):(N(),M("div",Gs,[c(r).error==null&&!u.value?(N(),X(vn,{key:0,onClick:p[0]||(p[0]=y=>t("export")),class:"button",left:""},{default:U(()=>[m(Se,{display:"Export",direction:c(O).Left,class:"info"},{default:U(()=>[Hs]),_:1},8,["direction"])]),_:1})):B("",!0),c(r).error==null&&!u.value?(N(),M("button",{key:1,onClick:p[1]||(p[1]=y=>t("duplicate")),class:"button"},[m(Se,{display:"Duplicate",direction:c(O).Left,class:"info"},{default:U(()=>[Zs]),_:1},8,["direction"])])):B("",!0),c(r).error==null&&!u.value?(N(),M("button",{key:2,onClick:p[2]||(p[2]=y=>a.value=!a.value),class:"button"},[m(Se,{display:"Edit Name",direction:c(O).Left,class:"info"},{default:U(()=>[Ys]),_:1},8,["direction"])])):B("",!0),m(js,{disabled:s.value,onClick:p[3]||(p[3]=y=>t("delete")),onConfirmingChanged:p[4]||(p[4]=y=>u.value=y)},{default:U(()=>[m(Se,{display:"Delete",direction:c(O).Left,class:"info"},{default:U(()=>[Js]),_:1},8,["direction"])]),_:1},8,["disabled"])])),c(r).error==null&&!a.value?(N(),M("div",el,[h("button",{class:"button open",onClick:p[6]||(p[6]=y=>t("open"))},[h("h3",null,H(c(r).name),1)]),h("span",tl,"v"+H(c(r).modVersion),1),nl,g.value?(N(),M("div",rl,"Last played "+H(c(i).format(g.value)),1)):B("",!0)])):c(r).error==null&&a.value?(N(),M("div",il,[m(sr,{modelValue:o.value,"onUpdate:modelValue":p[7]||(p[7]=y=>o.value=y),class:"editname",onSubmit:_},null,8,["modelValue"])])):(N(),M("div",al,[F(" Error: Failed to load save with id "+H(c(r).id),1),ol,F(H(c(r).error),1)]))],2))}});var ll=le(sl,[["__scopeId","data-v-32313015"]]);const Cn=e=>(lt("data-v-2a4275be"),e=e(),ut(),e),ul=Cn(()=>h("h2",null,"Saves Manager",-1)),cl={class:"modal-footer"},dl={class:"field"},gl=Cn(()=>h("span",{class:"field-title"},"Create Save",-1)),fl={class:"field-buttons"},ml={class:"footer"},hl=Cn(()=>h("div",{style:{"flex-grow":"1"}},null,-1)),vl=K({__name:"SavesManager",setup(e,{expose:t}){const n=V(!1),r=V(null);t({open(){n.value=!0}});const i=V(!1),a=V(""),u=V(null);Je(a,C=>{C?Et(()=>{try{if(C[0]!=="{")if(C[0]==="e")C=decodeURIComponent(escape(atob(C)));else if(C[0]==="\u1BE1")C=et.decompressFromUTF16(C);else{console.warn("Unable to determine preset encoding",C),i.value=!0;return}const x=JSON.parse(C);if(typeof x!="object"){i.value=!0;return}const D=Ht();x.id=D,qe(x),a.value="",i.value=!1,ie.saves.push(D)}catch{i.value=!0}}):i.value=!1});let o={},s=V(Object.keys(o).reduce((C,x)=>(C.push({label:x.split("/").slice(-1)[0].slice(0,-4),value:o[x]}),C),[]));const g=gn({});function _(C){if(g[C]==null){let x=localStorage.getItem(C);if(x==null)g[C]={error:"Save doesn't exist in localStorage",id:C};else if(x==="dW5kZWZpbmVk")g[C]={error:"Save is undefined",id:C};else try{if(x[0]!=="{")if(x[0]==="e")x=decodeURIComponent(escape(atob(x)));else if(x[0]==="\u1BE1")x=et.decompressFromUTF16(x);else return console.warn("Unable to determine preset encoding",x),i.value=!0,g[C]={error:"Unable to determine preset encoding",id:C},g[C];g[C]={...JSON.parse(x),id:C}}catch(D){g[C]={error:D,id:C},console.warn(`SavesManager: Failed to load info about save with id ${C}:
${D}
${x}`)}}return g[C]}Je(n,C=>{C&&Object.keys(g).forEach(x=>delete g[x])});const b=$(()=>ie.saves.reduce((C,x)=>(C[x]=_(x),C),{}));function p(C){let x;switch(Z.id===C?x=hn(Z):x=JSON.stringify(b.value[C]),J.exportEncoding){default:console.warn(`Unknown save encoding: ${J.exportEncoding}. Defaulting to lz`);case"lz":x=et.compressToUTF16(x);break;case"base64":x=btoa(unescape(encodeURIComponent(x)));break;case"plain":break}const D=document.createElement("textarea");D.value=x,document.body.appendChild(D),D.select(),D.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(D)}function y(C){Z.id===C&&qe();const x={...b.value[C],id:Ht()};qe(x),ie.saves.push(x.id)}function v(C){ie.saves=ie.saves.filter(x=>x!==C),localStorage.removeItem(C),g[C]=void 0}function S(C){b.value[Z.id].time=Z.time,qe(),g[Z.id]=void 0,vt(b.value[C]),g[C]=void 0}function A(C){if(u.value=C,Et(()=>{u.value=null}),C[0]!=="{")if(C[0]==="e")C=decodeURIComponent(escape(atob(C)));else if(C[0]==="\u1BE1")C=et.decompressFromUTF16(C);else{console.warn("Unable to determine preset encoding",C);return}const x=JSON.parse(C);x.id=Ht(),qe(x),ie.saves.push(x.id),S(x.id)}function P(C,x){const D=b.value[C];D!=null&&(D.name=x,Z.id===C?(Z.name=x,qe()):(qe(D),g[C]=void 0))}return(C,x)=>(N(),X(dt,{modelValue:n.value,"onUpdate:modelValue":x[4]||(x[4]=D=>n.value=D),ref_key:"modal",ref:r},{header:U(()=>[ul]),body:U(({shown:D})=>[D?(N(),X(c(xr),{key:0,list:c(ie).saves,handle:".handle",itemKey:ae=>ae},{item:U(({element:ae})=>[m(ll,{save:b.value[ae],onOpen:ge=>S(ae),onExport:ge=>p(ae),onEditName:ge=>P(ae,ge),onDuplicate:ge=>y(ae),onDelete:ge=>v(ae)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):B("",!0)]),footer:U(()=>[h("div",cl,[m(sr,{modelValue:a.value,"onUpdate:modelValue":x[0]||(x[0]=D=>a.value=D),title:"Import Save",placeholder:"Paste your save here!",class:ye({importingFailed:i.value})},null,8,["modelValue","class"]),h("div",dl,[gl,h("div",fl,[h("button",{class:"button",onClick:x[1]||(x[1]=D=>S(c(St)().id))},"New Game"),Object.keys(c(s)).length>0?(N(),X(ar,{key:0,options:c(s),modelValue:u.value,"onUpdate:modelValue":x[2]||(x[2]=D=>A(D)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):B("",!0)])]),h("div",ml,[hl,h("button",{class:"button modal-default-button",onClick:x[3]||(x[3]=D=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var kn=le(vl,[["__scopeId","data-v-2a4275be"]]);const ze=e=>(lt("data-v-318a1c31"),e=e(),ut(),e),pl=["src","alt"],bl={key:1,class:"title"},yl=ze(()=>h("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),_l={class:"discord"},wl={class:"discord-links"},Nl={key:0},Sl=["href"],Cl=ze(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),kl=ze(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Ml={href:"https://forums.moddingtree.com/",target:"_blank"},Il=ze(()=>h("span",{class:"material-icons"},"forum",-1)),xl=ze(()=>h("span",{class:"material-icons"},"info",-1)),$l=ze(()=>h("span",{class:"material-icons"},"library_books",-1)),Tl=ze(()=>h("span",{class:"material-icons"},"settings",-1)),Fl=ze(()=>h("span",{class:"material-icons"},"library_books",-1)),Pl=ze(()=>h("span",{class:"material-icons"},"settings",-1)),El=ze(()=>h("span",{class:"material-icons"},"info",-1)),Ol={href:"https://forums.moddingtree.com/",target:"_blank"},Dl=ze(()=>h("span",{class:"material-icons"},"forum",-1)),Vl={class:"discord"},Al={class:"discord-links"},Ll={key:0},Bl=["href"],ql=ze(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),Rl=ze(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),zl=K({__name:"Nav",setup(e){const t=V(null),n=V(null),r=V(null),i=V(null),{useHeader:a,banner:u,title:o,discordName:s,discordLink:g,versionNumber:_}=J;function b(){window.open(g,"mywindow")}return(p,y)=>(N(),M(be,null,[c(a)?(N(),M("div",_t({key:0,class:"nav"},p.$attrs),[c(u)?(N(),M("img",{key:0,src:c(u),class:"banner",alt:c(o)},null,8,pl)):(N(),M("div",bl,H(c(o)),1)),h("div",{onClick:y[0]||(y[0]=v=>{var S;return(S=i.value)==null?void 0:S.open()}),class:"version-container"},[m(Se,{display:"Changelog",direction:c(O).Down,class:"version"},{default:U(()=>[h("span",null,"v"+H(c(_)),1)]),_:1},8,["direction"])]),yl,h("div",_l,[h("span",{onClick:b,class:"material-icons"},"discord"),h("ul",wl,[c(g)?(N(),M("li",Nl,[h("a",{href:c(g),target:"_blank"},H(c(s)),9,Sl)])):B("",!0),Cl,kl])]),h("div",null,[h("a",Ml,[m(Se,{display:"Forums",direction:c(O).Down,yoffset:"5px"},{default:U(()=>[Il]),_:1},8,["direction"])])]),h("div",{onClick:y[1]||(y[1]=v=>{var S;return(S=t.value)==null?void 0:S.open()})},[m(Se,{display:"Info",direction:c(O).Down,class:"info"},{default:U(()=>[xl]),_:1},8,["direction"])]),h("div",{onClick:y[2]||(y[2]=v=>{var S;return(S=n.value)==null?void 0:S.open()})},[m(Se,{display:"Saves",direction:c(O).Down,xoffset:"-20px"},{default:U(()=>[$l]),_:1},8,["direction"])]),h("div",{onClick:y[3]||(y[3]=v=>{var S;return(S=r.value)==null?void 0:S.open()})},[m(Se,{display:"Settings",direction:c(O).Down,xoffset:"-66px"},{default:U(()=>[Tl]),_:1},8,["direction"])])],16)):(N(),M("div",_t({key:1,class:"overlay-nav"},p.$attrs),[h("div",{onClick:y[4]||(y[4]=v=>{var S;return(S=i.value)==null?void 0:S.open()}),class:"version-container"},[m(Se,{display:"Changelog",direction:c(O).Right,xoffset:"25%",class:"version"},{default:U(()=>[h("span",null,"v"+H(c(_)),1)]),_:1},8,["direction"])]),h("div",{onClick:y[5]||(y[5]=v=>{var S;return(S=n.value)==null?void 0:S.open()})},[m(Se,{display:"Saves",direction:c(O).Right},{default:U(()=>[Fl]),_:1},8,["direction"])]),h("div",{onClick:y[6]||(y[6]=v=>{var S;return(S=r.value)==null?void 0:S.open()})},[m(Se,{display:"Settings",direction:c(O).Right},{default:U(()=>[Pl]),_:1},8,["direction"])]),h("div",{onClick:y[7]||(y[7]=v=>{var S;return(S=t.value)==null?void 0:S.open()})},[m(Se,{display:"Info",direction:c(O).Right},{default:U(()=>[El]),_:1},8,["direction"])]),h("div",null,[h("a",Ol,[m(Se,{display:"Forums",direction:c(O).Right,xoffset:"7px"},{default:U(()=>[Dl]),_:1},8,["direction"])])]),h("div",Vl,[h("span",{onClick:b,class:"material-icons"},"discord"),h("ul",Al,[c(g)?(N(),M("li",Ll,[h("a",{href:c(g),target:"_blank"},H(c(s)),9,Bl)])):B("",!0),ql,Rl])])],16)),m(ir,{ref_key:"info",ref:t,changelog:i.value},null,8,["changelog"]),m(kn,{ref_key:"savesManager",ref:n},null,512),m(or,{ref_key:"options",ref:r},null,512),m(rr,{ref_key:"changelog",ref:i},null,512)],64))}});var Ul=le(zl,[["__scopeId","data-v-318a1c31"]]);const jl={class:"inner-tab"},Wl=K({__name:"Game",setup(e){const t=st(Z,"tabs"),n=$(()=>Object.keys(Ee)),r=J.useHeader;function i(a){const{display:u,minimized:o,name:s,color:g,minimizable:_,nodes:b,minimizedDisplay:p}=a;return{display:u,minimized:o,name:s,color:g,minimizable:_,nodes:b,minimizedDisplay:p}}return(a,u)=>(N(),M("div",{class:ye(["tabs-container",{useHeader:c(r)}])},[(N(!0),M(be,null,Qe(t.value,(o,s)=>{var g,_;return N(),M("div",{key:s,class:ye(["tab",c((g=c(Ee)[o])==null?void 0:g.classes)]),style:Re(c((_=c(Ee)[o])==null?void 0:_.style))},[s===0&&!c(r)?(N(),X(Ul,{key:0})):B("",!0),h("div",jl,[n.value.includes(o)?(N(),X(rs,_t({key:0},i(c(Ee)[o]),{index:s,onSetMinimized:b=>c(Ee)[o].minimized.value=b}),null,16,["index","onSetMinimized"])):(N(),X(We(o),{key:1,index:s},null,8,["index"]))])],6)}),128))],2))}});var Gl=le(Wl,[["__scopeId","data-v-dcd207b4"]]);function lr(e,t="points",n=0,r=void 0){const i=Ae(e)?e:Be(e);if(i.displayName=t,i.precision=n,i.small=r,!Ae(e)){const a=i[ot];a.displayName=t,a.precision=n,a.small=r}return i}function ur(e){const t=Be(e.value);return Je(e,(n,r)=>{Zn.value||d.gt(n,r)&&(t.value=d.add(t.value,d.sub(n,r)))}),t}new d("10^^8");new d("1e100");const Hl=["x1","y1","x2","y2"],Zl=K({__name:"BoardLink",props:{link:{},dragging:{},dragged:{}},setup(e){const n=Le(e),r=$(()=>{var u,o,s,g,_,b,p;const a={...n.link.value.startNode.position};return n.link.value.offsetStart&&(a.x+=c(n.link.value.offsetStart).x,a.y+=c(n.link.value.offsetStart).y),((u=n.dragging)==null?void 0:u.value)===n.link.value.startNode&&(a.x+=(g=(s=(o=n.dragged)==null?void 0:o.value)==null?void 0:s.x)!=null?g:0,a.y+=(p=(b=(_=n.dragged)==null?void 0:_.value)==null?void 0:b.y)!=null?p:0),a}),i=$(()=>{var u,o,s,g,_,b,p;const a={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(a.x+=c(n.link.value.offsetEnd).x,a.y+=c(n.link.value.offsetEnd).y),((u=n.dragging)==null?void 0:u.value)===n.link.value.endNode&&(a.x+=(g=(s=(o=n.dragged)==null?void 0:o.value)==null?void 0:s.x)!=null?g:0,a.y+=(p=(b=(_=n.dragged)==null?void 0:_.value)==null?void 0:b.y)!=null?p:0),a});return(a,u)=>(N(),M("line",_t({class:"link"},{...a.link,"stroke-width":a.link.strokeWidth},{class:{pulsing:a.link.pulsing},x1:r.value.x,y1:r.value.y,x2:i.value.x,y2:i.value.y}),null,16,Hl))}});var Yl=le(Zl,[["__scopeId","data-v-28281ab6"]]);const Jl={key:0},Kl=["transform","onMousedown","onTouchstart","onMouseup","onTouchend"],Xl=["fill","stroke-width","stroke"],Ql=["fill"],eu=K({__name:"BoardNodeAction",props:{node:{},nodeType:{},actions:{},isSelected:{type:Boolean},selectedAction:{}},emits:["clickAction"],setup(e,{emit:t}){const r=Le(e),i=$(()=>te(r.nodeType.value.size,c(r.node))),a=$(()=>{var _;return(_=te(r.nodeType.value.outlineColor,c(r.node)))!=null?_:He[ie.theme].variables["--outline"]}),u=$(()=>{var _;return(_=te(r.nodeType.value.titleColor,c(r.node)))!=null?_:He[ie.theme].variables["--foreground"]}),o=$(()=>te(r.nodeType.value.actionDistance,c(r.node)));function s(_,b){t("clickAction",b.id),_.preventDefault(),_.stopPropagation()}function g(_,b){var p;((p=c(r.selectedAction))==null?void 0:p.id)===b.id&&(_.preventDefault(),_.stopPropagation())}return(_,b)=>(N(),X(Ot,{name:"actions",appear:""},{default:U(()=>[_.isSelected&&_.actions?(N(),M("g",Jl,[(N(!0),M(be,null,Qe(_.actions,(p,y)=>{var v,S;return N(),M("g",{key:p.id,class:ye(["action",{selected:((v=_.selectedAction)==null?void 0:v.id)===p.id}]),transform:`translate(
                        ${(-i.value-30)*Math.sin(((_.actions.length-1)/2-y)*o.value)},
                        ${(i.value+30)*Math.cos(((_.actions.length-1)/2-y)*o.value)}
                    )`,onMousedown:A=>s(A,p),onTouchstart:A=>s(A,p),onMouseup:A=>g(A,p),onTouchend:kt(A=>g(A,p),["stop"])},[h("circle",{fill:c(te)(p.fillColor,_.node),r:"20","stroke-width":((S=_.selectedAction)==null?void 0:S.id)===p.id?4:0,stroke:a.value},null,8,Xl),h("text",{fill:u.value,class:"material-icons"},H(c(te)(p.icon,_.node)),9,Ql)],42,Kl)}),128))])):B("",!0)]),_:1}))}});var tu=le(eu,[["__scopeId","data-v-9efb2a56"]]);const nu=["transform"],ru={key:0},iu=["r","fill","stroke"],au=["r","fill","stroke"],ou=["r","fill"],su=["r","stroke-dasharray","stroke-dashoffset","stroke"],lu={key:1,transform:"rotate(45, 0, 0)"},uu=["width","height","transform","fill","stroke"],cu=["width","height","transform","fill","stroke"],du=["width","height","transform","fill"],gu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],fu={key:2},mu=["width","height","transform","fill","stroke"],hu=["width","height","transform","fill","stroke"],vu=["width","height","transform","fill"],pu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],bu=["fill"],yu={key:0},_u=["fill","y"],wu=["fill","y"],Nu=K({__name:"BoardNode",props:{node:{},nodeType:{},dragging:{},dragged:{},hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:{}},emits:["mouseDown","endDragging","clickAction"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=1+r/2,a=Le(n),u=$(()=>te(a.nodeType.value.draggable,c(a.node)));Je(u,q=>{const ue=c(a.node);c(a.dragging)===ue&&!q&&t("endDragging",ue)});const o=$(()=>{var ue;const q=c(a.node);return(ue=te(a.nodeType.value.actions,q))==null?void 0:ue.filter(Te=>bn(te(Te.visibility,q)))}),s=$(()=>{var ue;const q=c(a.node);if(te(a.nodeType.value.draggable,q)&&((ue=c(a.dragging))==null?void 0:ue.id)===q.id&&c(a.dragged)!=null){const{x:Te,y:Ke}=c(a.dragged);return{x:q.position.x+Math.round(Te/25)*25,y:q.position.y+Math.round(Ke/25)*25}}return q.position}),g=$(()=>te(a.nodeType.value.shape,c(a.node))),_=$(()=>te(a.nodeType.value.title,c(a.node))),b=$(()=>{var q;return(q=a.isSelected.value?c(a.selectedAction)&&te(c(a.selectedAction).tooltip,c(a.node)):null)!=null?q:te(a.nodeType.value.label,c(a.node))}),p=$(()=>{var q,ue;return te((ue=(q=c(a.selectedAction))==null?void 0:q.confirmationLabel)!=null?ue:{text:"Tap again to confirm"},c(a.node))}),y=$(()=>te(a.nodeType.value.size,c(a.node))),v=$(()=>{var q;return(q=te(a.nodeType.value.progress,c(a.node)))!=null?q:0}),S=$(()=>He[ie.theme].variables["--background"]),A=$(()=>{var q;return(q=te(a.nodeType.value.outlineColor,c(a.node)))!=null?q:He[ie.theme].variables["--outline"]}),P=$(()=>{var q;return(q=te(a.nodeType.value.fillColor,c(a.node)))!=null?q:He[ie.theme].variables["--raised-background"]}),C=$(()=>te(a.nodeType.value.progressColor,c(a.node))),x=$(()=>{var q;return(q=te(a.nodeType.value.titleColor,c(a.node)))!=null?q:He[ie.theme].variables["--foreground"]}),D=$(()=>te(a.nodeType.value.progressDisplay,c(a.node))),ae=$(()=>a.dragging.value!=null&&c(a.hasDragged)&&te(a.nodeType.value.canAccept,c(a.node),a.dragging.value)),ge=$(()=>te(a.nodeType.value.style,c(a.node))),ne=$(()=>te(a.nodeType.value.classes,c(a.node)));function re(q){t("mouseDown",q,a.node.value,u.value)}function Nt(q){var ue,Te,Ke;(ue=a.hasDragged)!=null&&ue.value||(t("endDragging",a.node.value),(Ke=(Te=a.nodeType.value).onClick)==null||Ke.call(Te,a.node.value),q.stopPropagation())}return(q,ue)=>{var Te,Ke,xt;return N(),M("g",{class:ye(["boardnode",{[q.node.type]:!0,isSelected:q.isSelected,isDraggable:u.value,...ne.value}]),style:Re([{opacity:((Te=q.dragging)==null?void 0:Te.id)===q.node.id&&q.hasDragged?.5:1},(Ke=ge.value)!=null?Ke:[]]),transform:`translate(${s.value.x},${s.value.y})`},[m(tu,{actions:(xt=o.value)!=null?xt:[],"is-selected":q.isSelected,node:q.node,"node-type":q.nodeType,"selected-action":q.selectedAction,onClickAction:ue[0]||(ue[0]=ve=>t("clickAction",ve))},null,8,["actions","is-selected","node","node-type","selected-action"]),h("g",{class:"node-container",onMousedown:re,onTouchstartPassive:re,onMouseup:Nt,onTouchendPassive:Nt},[g.value===c(nt).Circle?(N(),M("g",ru,[ae.value?(N(),M("circle",{key:0,class:"receiver",r:y.value+8,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,iu)):B("",!0),h("circle",{class:"body",r:y.value,fill:P.value,stroke:A.value,"stroke-width":4},null,8,au),D.value===c(Zt).Fill?(N(),M("circle",{key:1,class:"progress progressFill",r:Math.max(y.value*v.value-2,0),fill:C.value},null,8,ou)):(N(),M("circle",{key:2,r:y.value+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(y.value+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(y.value+4.5)*2*Math.PI-v.value*(y.value+4.5)*2*Math.PI,stroke:C.value},null,8,su))])):g.value===c(nt).Diamond?(N(),M("g",lu,[ae.value?(N(),M("rect",{key:0,class:"receiver",width:y.value*c(r)+16,height:y.value*c(r)+16,transform:`translate(${-(y.value*c(r)+16)/2}, ${-(y.value*c(r)+16)/2})`,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,uu)):B("",!0),h("rect",{class:"body",width:y.value*c(r),height:y.value*c(r),transform:`translate(${-y.value*c(r)/2}, ${-y.value*c(r)/2})`,fill:P.value,stroke:A.value,"stroke-width":4},null,8,cu),D.value===c(Zt).Fill?(N(),M("rect",{key:1,class:"progress progressFill",width:Math.max(y.value*c(r)*v.value-2,0),height:Math.max(y.value*c(r)*v.value-2,0),transform:`translate(${-Math.max(y.value*c(r)*v.value-2,0)/2}, ${-Math.max(y.value*c(r)*v.value-2,0)/2})`,fill:C.value},null,8,du)):(N(),M("rect",{key:2,class:"progress progressDiamond",width:y.value*c(r)+9,height:y.value*c(r)+9,transform:`translate(${-(y.value*c(r)+9)/2}, ${-(y.value*c(r)+9)/2})`,fill:"transparent","stroke-dasharray":(y.value*c(r)+9)*4,"stroke-width":5,"stroke-dashoffset":(y.value*c(r)+9)*4-v.value*(y.value*c(r)+9)*4,stroke:C.value},null,8,gu))])):g.value===c(nt).Square?(N(),M("g",fu,[ae.value?(N(),M("rect",{key:0,class:"receiver",width:y.value*i+16,height:y.value*i+16,transform:`translate(${-(y.value*i+16)/2}, ${-(y.value*i+16)/2})`,fill:S.value,stroke:q.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,mu)):B("",!0),h("rect",{class:"body",width:y.value*i,height:y.value*i,transform:`translate(${-y.value*i/2}, ${-y.value*i/2})`,fill:P.value,stroke:A.value,"stroke-width":4},null,8,hu),D.value===c(Zt).Fill?(N(),M("rect",{key:1,class:"progress progressFill",width:Math.max(y.value*i*v.value-2,0),height:Math.max(y.value*i*v.value-2,0),transform:`translate(${-Math.max(y.value*i*v.value-2,0)/2}, ${-Math.max(y.value*i*v.value-2,0)/2})`,fill:C.value},null,8,vu)):(N(),M("rect",{key:2,class:"progress progressDiamond",width:y.value*i+9,height:y.value*i+9,transform:`translate(${-(y.value*i+9)/2}, ${-(y.value*i+9)/2})`,fill:"transparent","stroke-dasharray":(y.value*i+9)*4,"stroke-width":5,"stroke-dashoffset":(y.value*i+9)*4-v.value*(y.value*i+9)*4,stroke:C.value},null,8,pu))])):B("",!0),h("text",{fill:x.value,class:"node-title"},H(_.value),9,bu)],32),m(Ot,{name:"fade",appear:""},{default:U(()=>{var ve;return[b.value?(N(),M("g",yu,[h("text",{fill:(ve=b.value.color)!=null?ve:x.value,class:ye(["node-title",{pulsing:b.value.pulsing}]),y:-y.value-20},H(b.value.text),11,_u)])):B("",!0)]}),_:1}),m(Ot,{name:"fade",appear:""},{default:U(()=>{var ve;return[q.isSelected&&q.selectedAction?(N(),M("text",{key:0,fill:(ve=p.value.color)!=null?ve:x.value,class:ye(["node-title",{pulsing:p.value.pulsing}]),y:y.value+75},H(p.value.text),11,wu)):B("",!0)]}),_:1})],14,nu)}}});var Su=le(Nu,[["__scopeId","data-v-3697ee2a"]]);const Cu={class:"stage",width:"100%",height:"100%"},ku={class:"g1"},Mu=K({__name:"Board",props:{nodes:{},types:{},stage:{},state:{},visibility:{},width:{},height:{},style:{},classes:{},links:{},selectedAction:{},selectedNode:{},draggingNode:{},receivingNode:{},mousePosition:{},setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=Le(e),r=V({x:0,y:0}),i=V({x:0,y:0}),a=V(!1),u=V(!1),o=V(null),s=$(()=>{const v=n.nodes.value.slice();if(n.draggingNode.value){const S=v.splice(v.indexOf(n.draggingNode.value),1)[0];v.push(S)}return v});fn(()=>{const v=n.draggingNode.value;if(v==null)return null;const S={x:v.position.x+i.value.x,y:v.position.y+i.value.y};let A=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((P,C)=>{if(C.id===v.id)return P;const x=n.types.value[C.type];if(!te(x.canAccept,C,v))return P;const ae=Math.pow(S.x-C.position.x,2)+Math.pow(S.y-C.position.y,2);let ge=te(x.size,C);return ae>A||ae>ge*ge?P:(A=ae,C)},null))});function g(v){v.setTransformOrigin(null),v.moveTo(o.value.$el.clientWidth/2,o.value.$el.clientHeight/2),n.stage.value=v}function _(v,S=null,A=!1){if(n.draggingNode.value==null){v.preventDefault(),v.stopPropagation();let P,C;if("touches"in v)if(v.touches.length===1)P=v.touches[0].clientX,C=v.touches[0].clientY;else return;else P=v.clientX,C=v.clientY;r.value={x:P,y:C},i.value={x:0,y:0},u.value=!1,a.value=!0,A&&n.setDraggingNode.value(S)}}function b(v){const{x:S,y:A,scale:P}=o.value.panZoomInstance.getTransform();let C,x;if("touches"in v)if(v.touches.length===1)C=v.touches[0].clientX,x=v.touches[0].clientY;else{p(n.draggingNode.value),n.mousePosition.value=null;return}else C=v.clientX,x=v.clientY;n.mousePosition.value={x:(C-S)/P,y:(x-A)/P},i.value={x:i.value.x+(C-r.value.x)/P,y:i.value.y+(x-r.value.y)/P},r.value={x:C,y:x},(Math.abs(i.value.x)>10||Math.abs(i.value.y)>10)&&(u.value=!0),n.draggingNode.value!=null||a.value&&u.value&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function p(v,S=!1){var A,P;if(n.draggingNode.value!=null&&n.draggingNode.value===v){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(i.value.x/25)*25,n.draggingNode.value.position.y+=Math.round(i.value.y/25)*25);const C=n.nodes.value;C.push(C.splice(C.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((P=(A=n.types.value[n.receivingNode.value.type]).onDrop)==null||P.call(A,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else!u.value&&!S&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null);a.value=!1}function y(v,S){n.state.value.selectedAction===S?c(n.selectedAction).onClick(c(n.selectedNode)):n.state.value={...n.state.value,selectedAction:S}}return(v,S)=>{const A=Dt("panZoom");return c(bn)(v.visibility)?(N(),X(A,{key:0,style:Re([{width:v.width,height:v.height},v.style]),class:ye(v.classes),selector:".g1",options:{initialZoom:1,minZoom:.1,maxZoom:10,zoomDoubleClickSpeed:1},ref_key:"stage",ref:o,onInit:g,onMousemove:b,onTouchmove:b,onMousedown:S[0]||(S[0]=P=>_(P)),onTouchstart:S[1]||(S[1]=P=>_(P)),onMouseup:S[2]||(S[2]=()=>p(c(v.draggingNode))),onTouchendPassive:S[3]||(S[3]=()=>p(c(v.draggingNode))),onMouseleave:S[4]||(S[4]=()=>p(c(v.draggingNode),!0))},{default:U(()=>[(N(),M("svg",Cu,[h("g",ku,[m($n,{name:"link",appear:""},{default:U(()=>[(N(!0),M(be,null,Qe(c(v.links)||[],P=>(N(),M("g",{key:`${P.startNode.id}-${P.endNode.id}`},[m(Yl,{link:P,dragging:c(v.draggingNode),dragged:P.startNode===c(v.draggingNode)||P.endNode===c(v.draggingNode)?i.value:void 0},null,8,["link","dragging","dragged"])]))),128))]),_:1}),m($n,{name:"grow",duration:500,appear:""},{default:U(()=>[(N(!0),M(be,null,Qe(s.value,P=>(N(),M("g",{key:P.id,style:{"transition-duration":"0s"}},[m(Su,{node:P,nodeType:v.types[P.type],dragging:c(v.draggingNode),dragged:c(v.draggingNode)===P?i.value:void 0,hasDragged:c(v.draggingNode)==null?!1:u.value,receivingNode:c(v.receivingNode)===P,isSelected:c(v.selectedNode)===P,selectedAction:c(v.selectedNode)===P?c(v.selectedAction):null,onMouseDown:_,onEndDragging:p,onClickAction:C=>y(P,C)},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class"])):B("",!0)}}});Ie.on("setupVue",e=>Tr.install(e));const cr=Symbol("Board");var Zt=(e=>(e.Outline="Outline",e.Fill="Fill",e))(Zt||{}),nt=(e=>(e.Circle="Circle",e.Diamond="Triangle",e.Square="Square",e))(nt||{});function Iu(e){const t=Be({nodes:[],selectedNode:null,selectedAction:null},!1);return _n(n=>{const r=e.call(n,n);r.id=Gn("board-"),r.type=cr,r[nn]=Mu,r.state?(Yo(t),R(r,"state")):(t[qt]={nodes:r.startNodes().map((o,s)=>(o.id=s,o)),selectedNode:null,selectedAction:null},r.state=t),r.nodes=$(()=>c(u.state).nodes),r.selectedNode=$({get(){return u.nodes.value.find(o=>o.id===c(u.state).selectedNode)||null},set(o){var s,g;Ae(u.state)?u.state.value={...u.state.value,selectedNode:(s=o==null?void 0:o.id)!=null?s:null}:u.state.selectedNode=(g=o==null?void 0:o.id)!=null?g:null}}),r.selectedAction=$({get(){const o=u.selectedNode.value;if(o==null)return null;const s=u.types[o.type];return s.actions==null?null:s.actions.find(g=>g.id===c(u.state).selectedAction)||null},set(o){var s,g;Ae(u.state)?u.state.value={...u.state.value,selectedAction:(s=o==null?void 0:o.id)!=null?s:null}:u.state.selectedAction=(g=o==null?void 0:o.id)!=null?g:null}}),r.mousePosition=V(null),r.links?R(r,"links"):r.links=$(()=>u.selectedAction.value==null?null:u.selectedAction.value.links&&u.selectedNode.value?te(u.selectedAction.value.links,u.selectedNode.value):null),r.draggingNode=V(null),r.receivingNode=V(null),r.stage=V(null),R(r,"visibility"),ke(r,"visibility",Lt.Visible),R(r,"width"),ke(r,"width","100%"),R(r,"height"),ke(r,"height","100%"),R(r,"classes"),R(r,"style");for(const o in r.types){const s=r.types[o];if(R(s,"title"),R(s,"label"),R(s,"size"),ke(s,"size",50),R(s,"style"),R(s,"classes"),R(s,"draggable"),ke(s,"draggable",!1),R(s,"shape"),ke(s,"shape","Circle"),R(s,"canAccept"),ke(s,"canAccept",!1),R(s,"progress"),R(s,"progressDisplay"),ke(s,"progressDisplay","Fill"),R(s,"progressColor"),ke(s,"progressColor","none"),R(s,"fillColor"),R(s,"outlineColor"),R(s,"titleColor"),R(s,"actionDistance"),ke(s,"actionDistance",Math.PI/6),s.nodes=$(()=>c(u.state).nodes.filter(g=>g.type===o)),ke(s,"onClick",function(g){c(u.state).selectedNode=g.id}),s.actions)for(const g of s.actions)R(g,"visibility"),ke(g,"visibility",Lt.Visible),R(g,"icon"),R(g,"fillColor"),R(g,"tooltip"),R(g,"confirmationLabel"),ke(g,"confirmationLabel",{text:"Tap again to confirm"}),R(g,"links")}function i(o){r.draggingNode.value=o}function a(o){r.receivingNode.value=o}r.placeInAvailableSpace=function(o,s=100,g=O.Right){const _=u.nodes.value.slice().filter(b=>b===o||(g===O.Down||g===O.Up)&&Math.abs(b.position.x-o.position.x)>s||(g===O.Left||g===O.Right)&&Math.abs(b.position.y-o.position.y)>s?!1:!(g===O.Right&&b.position.x<o.position.x-s||g===O.Left&&b.position.x>o.position.x+s||g===O.Up&&b.position.y>o.position.y+s||g===O.Down&&b.position.y<o.position.y-s)).sort(g===O.Right?(b,p)=>b.position.x-p.position.x:g===O.Left?(b,p)=>p.position.x-b.position.x:g===O.Up?(b,p)=>p.position.y-b.position.y:(b,p)=>b.position.y-p.position.y);for(let b=0;b<_.length;b++){const p=_[b],y=g===O.Right||g===O.Left?Math.abs(o.position.x-p.position.x):Math.abs(o.position.y-p.position.y);if(y<s)g===O.Right?o.position.x=p.position.x+s:g===O.Left?o.position.x=p.position.x-s:g===O.Up?o.position.y=p.position.y-s:g===O.Down&&(o.position.y=p.position.y+s);else if(b>0&&y>s)break}},r[rn]=function(){const{nodes:o,types:s,stage:g,state:_,visibility:b,width:p,height:y,style:v,classes:S,links:A,selectedAction:P,selectedNode:C,mousePosition:x,draggingNode:D,receivingNode:ae}=this;return{nodes:o,types:s,stage:g,state:_,visibility:b,width:p,height:y,style:c(v),classes:S,links:A,selectedAction:P,selectedNode:C,mousePosition:x,draggingNode:D,receivingNode:ae,setDraggingNode:i,setReceivingNode:a}};const u=r;return u})}function te(e,t,...n){return Jt(e)?e(t,...n):c(e)}const Ft={};Ie.on("addLayer",e=>{const t=Xi(e,cr);Ft[e.id]=e.on("postUpdate",n=>{t.forEach(r=>{Object.values(r.types).forEach(i=>i.nodes.value.forEach(a=>{var u;return(u=i.update)==null?void 0:u.call(i,a,n)}))})})});Ie.on("removeLayer",e=>{var t;(t=Ft[e.id])==null||t.call(Ft),Ft[e.id]=void 0});const Ge=Symbol("BoardID"),$e=Symbol("BoardConnections"),xu={name:"Beamer",icon:"\u{1F4A0}",color:"#afcfef",class:"damager",description:"Beams one random enemy on the loop it's on once every a certain amount of time.",baseCost:{energy:100},upgrades:{damage:{name:"Damage",effect:e=>10+2*e,cost:e=>({energy:50*1.2**e}),unit:"/hit"},interval:{name:"Interval",max:15,effect:e=>2*.9**e,cost:e=>({energy:50*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var r,i,a,u;if(t.enemies.length){if(e.data.prg=((r=e.data.prg)!=null?r:0)+n/this.upgrades.interval.effect((i=e.upgrades.interval)!=null?i:0),e.data.prg>=1){let o=t.enemies[Math.floor(Math.random()*t.enemies.length)];o.health-=this.upgrades.damage.effect((a=e.upgrades.damage)!=null?a:0),o[$e]||(o[$e]={}),o[$e][(u=t[Ge])!=null?u:0]=0,e.data.prg--}}else e.data.prg=0}},$u={name:"Plasma",icon:"\u{1F53A}",color:"#efbfbf",class:"damager",description:"Deal damage per second to all enemies on the loop it's on.",baseCost:{energy:400},upgrades:{damage:{name:"Damage",effect:e=>3+e,cost:e=>({energy:200*1.2**e}),unit:"/s"}},onUpdate(e,t,n){var i,a;let r=this.upgrades.damage.effect((i=e.upgrades.damage)!=null?i:0);for(let u of t.enemies)u.health-=r*n,u[$e]||(u[$e]={}),u[$e][(a=t[Ge])!=null?a:0]=0}},Tu={name:"Freezer",icon:"\u2744\uFE0F",color:"#afcfef",class:"effector",description:"Slows down enemies when they move to the next loop. Does not deal any damage to enemies.",baseCost:{energy:500},upgrades:{duration:{name:"Duration",effect:e=>2+.4*e,cost:e=>({energy:300*1.4**e}),precision:1,unit:"rad"}},onEnemyExit(e,t,n){var r;n.effects.freeze=this.upgrades.duration.effect((r=e.upgrades.duration)!=null?r:0)}},Fu={name:"Energizer",icon:"\u26A1",color:"#efefaf",class:"generator",description:"Infuse enemies with Energy while they are on the loop it's on, resulting in them dropping more Energy when defeated.",baseCost:{energy:200},upgrades:{amount:{name:"Amount",effect:e=>4+e*(e+1),cost:e=>({energy:400*3**e}),unit:"/s"}},onUpdate(e,t,n){var i,a,u;let r=this.upgrades.amount.effect((i=e.upgrades.amount)!=null?i:0);for(let o of t.enemies)o.loot.energy=((a=o.loot.energy)!=null?a:0)+r*n,o[$e]||(o[$e]={}),o[$e][(u=t[Ge])!=null?u:0]=0}};var dr=Object.freeze(Object.defineProperty({__proto__:null,beamer:xu,plasma:$u,freezer:Tu,energizer:Fu},Symbol.toStringTag,{value:"Module"}));const un=dr,Pu={shape:nt.Circle,size:50,title:"",classes:{loop:!0}},Eu={shape:nt.Circle,size:8,title:"",classes:{enemy:!0}},Ou={shape:e=>{var t;return{damager:nt.Circle,effector:nt.Diamond,generator:nt.Square}[(t=un[e.state.target.type])==null?void 0:t.class]},size:30,title:e=>{var t;return(t=un[e.state.target.type])==null?void 0:t.icon},fillColor:e=>{var t;return(t=un[e.state.target.type])==null?void 0:t.color},classes:{building:!0}};var Du=Object.freeze(Object.defineProperty({__proto__:null,loop:Pu,enemy:Eu,building:Ou},Symbol.toStringTag,{value:"Module"}));const Vu={key:0},Au={key:0,class:"mark star"},Lu=["src"],Bu=K({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>t.mark?(N(),M("div",Vu,[t.mark===!0?(N(),M("div",Au)):(N(),M("img",{key:1,class:"mark",src:t.mark},null,8,Lu))])):B("",!0)}});var qu=le(Bu,[["__scopeId","data-v-2207999f"]]);const Ru=K({__name:"Node",props:{id:{}},setup(e){const n=Le(e),r=Tn(wn,()=>{}),i=Tn(Nn,()=>{}),a=Rt(null),u=$(()=>a.value&&a.value.parentElement);return Je([u,n.id],([o,s],[g,_])=>{g&&i(c(_)),o&&r(s,o)}),kr(()=>i(c(n.id))),(o,s)=>(N(),M("div",{class:"node",ref_key:"node",ref:a},null,512))}});var zu=le(Ru,[["__scopeId","data-v-a48cb382"]]);const Uu=K({props:{progress:{type:se(String,Object,Number),required:!0},width:{type:se(Number),required:!0},height:{type:se(Number),required:!0},direction:{type:se(String),required:!0},display:se(Object,String,Function),visibility:{type:se(Number,Boolean),required:!0},style:se(Object,String,Array),classes:se(Object),borderStyle:se(Object,String,Array),textStyle:se(Object,String,Array),baseStyle:se(Object,String,Array),fillStyle:se(Object,String,Array),mark:se(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:qu,Node:zu},setup(e){const{progress:t,width:n,height:r,direction:i,display:a}=Le(e),u=$(()=>{let g=t.value instanceof d?t.value.toNumber():Number(t.value);return(1-Math.min(Math.max(g,0),1))*100}),o=$(()=>{const g={width:Ze(n)+1+"px",height:Ze(r)+.5+"px"};switch(c(i)){case O.Up:g.clipPath=`inset(${u.value}% 0% 0% 0%)`,g.width=Ze(n)+1+"px";break;case O.Down:g.clipPath=`inset(0% 0% ${u.value}% 0%)`,g.width=Ze(n)+1+"px";break;case O.Right:g.clipPath=`inset(0% ${u.value}% 0% 0%)`;break;case O.Left:g.clipPath=`inset(0% 0% 0% ${u.value}%)`;break;case O.Default:g.clipPath="inset(0% 50% 0% 0%)";break}return g}),s=zt(a);return{normalizedProgress:u,barStyle:o,component:s,unref:c,Visibility:Lt,isVisible:bn,isHidden:Ki}}});function ju(e,t,n,r,i,a){var s,g,_,b,p,y,v;const u=Dt("MarkNode"),o=Dt("Node");return e.isVisible(e.visibility)?(N(),M("div",{key:0,style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px",visibility:e.isHidden(e.visibility)?"hidden":void 0},(s=e.unref(e.style))!=null?s:{}]),class:ye({bar:!0,...e.unref(e.classes)})},[h("div",{class:"overlayTextContainer border",style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(g=e.unref(e.borderStyle))!=null?g:{}])},[e.component?(N(),M("span",{key:0,class:"overlayText",style:Re(e.unref(e.textStyle))},[(N(),X(We(e.component)))],4)):B("",!0)],4),h("div",{class:"border",style:Re([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(_=e.unref(e.style))!=null?_:{},(b=e.unref(e.baseStyle))!=null?b:{},(p=e.unref(e.borderStyle))!=null?p:{}])},[h("div",{class:"fill",style:Re([e.barStyle,(y=e.unref(e.style))!=null?y:{},(v=e.unref(e.fillStyle))!=null?v:{}])},null,4)],4),m(u,{mark:e.unref(e.mark)},null,8,["mark"]),m(o,{id:e.id},null,8,["id"])],6)):B("",!0)}var Wu=le(Uu,[["render",ju],["__scopeId","data-v-368a68be"]]);const Gu=Symbol("Bar");function cn(e,...t){const n=t.reduce((r,i)=>{var a;return Object.assign(r,(a=i.getPersistentData)==null?void 0:a.call(i))},{});return _n(r=>{var u,o;const i=e.call(r,r);i.id=Gn("bar-"),i.type=Gu,i[nn]=Wu;for(const s of t)(u=s.preConstruct)==null||u.call(s,i);Object.assign(i,n),R(i,"visibility"),ke(i,"visibility",Lt.Visible),R(i,"width"),R(i,"height"),R(i,"direction"),R(i,"style"),R(i,"classes"),R(i,"borderStyle"),R(i,"baseStyle"),R(i,"textStyle"),R(i,"fillStyle"),R(i,"progress"),R(i,"display"),R(i,"mark");for(const s of t)(o=s.postConstruct)==null||o.call(s,i);const a=t.reduce((s,g)=>{var _;return Object.assign(s,(_=g.getGatheredProps)==null?void 0:_.call(g,i))},{});return i[rn]=function(){const{progress:s,width:g,height:_,direction:b,display:p,visibility:y,style:v,classes:S,borderStyle:A,textStyle:P,baseStyle:C,fillStyle:x,mark:D,id:ae}=this;return{progress:s,width:g,height:_,direction:b,display:p,visibility:y,style:c(v),classes:S,borderStyle:A,textStyle:P,baseStyle:C,fillStyle:x,mark:D,id:ae,...a}},i})}const xe=dr,Hu="game";function Gt(e){let[t,n]=e.split("x");return{x:+t,y:+n}}function Ne(e,t){return e+"x"+t}var Ue=function(e){return e.New="",e.Started="start",e.Stopped="stop",e.Idle="idle",e}(Ue||{});const gr=Sn(Hu,function(){const e="Game",t=Be(0),n=Be(0),r=Be(0),i=V(0),a=Be({}),u=Be(0),o={energy:lr(0,"Energy")},s=Object.fromEntries(Object.entries(o).map(([k,T])=>[k,ur(T)])),g=Be(0),_=Be({});function b(k){var T;return 1.1**(g.value+((T=_.value[k])!=null?T:0))}const p=Be("",!1),y=Be(0),v=V(0);function S(){t.value=0,n.value=0,r.value=100,o.energy.value=100,s.energy.value=0,g.value=0,_.value={},p.value=Ue.Started,y.value=1;let k=()=>setTimeout(()=>{D.stage.value?(D.stage.value.getTransform(),D.stage.value.zoomAbs(window.innerWidth/2,window.innerHeight/2,1),D.stage.value.moveTo(window.innerWidth/2,window.innerHeight/2)):k()},0);k(),a.value={"0x0":{enemies:[{angle:0,lifetime:0,speed:Number.EPSILON,health:20,maxHealth:20,effects:{},loot:{energy:100}}]}}}function A(){p.value=Ue.Stopped,y.value=.1;let k={x:0,y:0},T={x:0,y:0};for(let Q in a.value){let{x:ce,y:Oe}=Gt(Q);k.x=Math.min(k.x,ce),k.y=Math.min(k.y,Oe),T.x=Math.max(T.x,ce),T.y=Math.max(T.y,Oe)}let z=(k.x+T.x)*-50,L=(k.y+T.y)*-50,j=Math.min(window.innerWidth/(T.x-k.x+1)/120,window.innerHeight/(T.y-k.y+1)/120,1),G=()=>setTimeout(()=>{D.stage.value?(D.stage.value.smoothMoveTo(z+window.innerWidth/2,L+window.innerHeight/2),D.stage.value.smoothZoomAbs(window.innerWidth/2,window.innerHeight/2,j)):G()},0);G(),setTimeout(()=>{for(let Q of c(D.state).nodes)Q.state.velocity={x:Math.random()*450-225,y:Math.random()*-450}},3e3),setTimeout(()=>{v.value=Math.sqrt(t.value)*Math.sqrt(u.value/60)*Object.values(s).reduce((Q,ce)=>Q+Math.log10(new d(ce.value).toNumber()+1),1),jt.value=!0},6e3)}function P(){let k=1+.1*t.value+.01*t.value*t.value;k=Math.floor(k)+(Math.random()<k%1?1:0);let T=Object.values(a.value);if(!(T.length<=0))for(let z=0;z<k;z++){let L=18*1.05**t.value*(Math.random()*.2+.9);T[Math.floor(Math.random()*T.length)].enemies.push({angle:Math.random(),lifetime:0,speed:(Math.random()*.4+.8+.05*t.value)*(Math.random()<.5?1:-1),health:L,maxHealth:L,effects:{},loot:{energy:25}})}}function C(){let k=Object.entries(a.value),T="";for(;k.length;){let z=Math.floor(Math.random()*k.length),L=k[z],{x:j,y:G}=Gt(L[0]),Q=[];if(a.value[Ne(j+1,G)]||Q.push(Ne(j+1,G)),a.value[Ne(j-1,G)]||Q.push(Ne(j-1,G)),a.value[Ne(j,G+1)]||Q.push(Ne(j,G+1)),a.value[Ne(j,G-1)]||Q.push(Ne(j,G-1)),Q.length){T=Q[Math.floor(Math.random()*Q.length)];break}else k.splice(z,1)}a.value[T]={enemies:[]}}Ie.on("onLoad",()=>{p.value==Ue.New?S():p.value==Ue.Stopped&&A()}),Ie.on("update",k=>{var T,z,L,j,G,Q,ce,Oe;if(p.value==Ue.Started){if(y.value<=0)return;k*=y.value,u.value+=k,t.value>=1&&(n.value+=k/(15+Math.sqrt(t.value)),n.value>=1&&(n.value--,t.value++,P(),(t.value+1)%2==0&&C()));let _e=!1;for(let ee in a.value)_e||(_e=a.value[ee].enemies.length>0);_e||(n.value=0,t.value++,P(),(t.value+1)%2==0&&C());let Ce=[];i.value=0;for(let ee in a.value){let Fe=a.value[ee],{x:we,y:fe}=Gt(ee);for(let E of Fe.enemies){let Pe=E.angle,De=E.speed*.1*k;E.effects.freeze&&(De*=.5),E.angle+=De,E.lifetime+=Math.abs(De),i.value+=E.lifetime,E.angle=(E.angle%1+1)%1;let[Ye,it]=[Math.min(Pe,E.angle),Math.max(Pe,E.angle)];if(E.health<=0){Fe.enemies.splice(Fe.enemies.indexOf(E),1);for(let[gt,br]of Object.entries(E.loot))o[gt].value+=br}Ye<.25&&it>.75?a.value[Ne(we,fe+1)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we,fe+1)]}),E.angle=.5-E.angle,E.speed=-E.speed):Ye<.25&&it>.25?a.value[Ne(we+1,fe)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we+1,fe)]}),E.angle=1-E.angle,E.speed=-E.speed):Ye<.5&&it>.5?a.value[Ne(we,fe-1)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we,fe-1)]}),E.angle=.5-E.angle,E.speed=-E.speed):Ye<.75&&it>.75&&a.value[Ne(we-1,fe)]&&Math.random()<.5&&(Ce.push({enemy:E,from:a.value[Ne(we,fe)],to:a.value[Ne(we-1,fe)]}),E.angle=1-E.angle,E.speed=-E.speed),E.angle=(E.angle%1+1)%1;for(let gt in E.effects)E.effects[gt]-=Math.abs(De),E.effects[gt]<=0&&delete E.effects[gt];if(E[$e])for(let gt in E[$e])E[$e][gt]-=k}Fe.building&&((z=(T=xe[Fe.building.type]).onUpdate)==null||z.call(T,Fe.building,Fe,k))}i.value/=Object.values(a.value).length*10,i.value>1&&(r.value-=2**i.value*k),r.value<=0&&A();for(let ee of Ce)ee.from.enemies.splice(ee.from.enemies.indexOf(ee.enemy),1),ee.to.enemies.push(ee.enemy),ee.from.building&&((j=(L=xe[ee.from.building.type]).onEnemyExit)==null||j.call(L,ee.from.building,ee.from,ee.enemy)),ee.to.building&&((Q=(G=xe[ee.to.building.type]).onEnemyEnter)==null||Q.call(G,ee.to.building,ee.to,ee.enemy));if(ve.value)if(on(ve.value)){if(((ce=D.selectedNode.value)==null?void 0:ce.type)=="loop"){let ee=D.selectedNode.value.state.target;if(ee.building)c(D.state).selectedNode=null;else{ee.building={type:ve.value,upgrades:{},data:{}};for(let[Fe,we]of Object.entries(xe[ve.value].baseCost))o[Fe].value-=we*b(ve.value);g.value++,_.value[ve.value]=((Oe=_.value[ve.value])!=null?Oe:0)+1,ve.value=""}}}else ve.value=""}else if(p.value==Ue.Stopped){for(let _e in a.value)for(let Ce of a.value[_e].enemies)Ce.angle+=.001*k;for(let _e of c(D.state).nodes){let Ce=_e.state;Ce.velocity?(_e.position.x+=Ce.velocity.x*k,_e.position.y+=Ce.velocity.y*k,Ce.velocity.y+=250*k):(_e.position.x+=Math.random()*2-1,_e.position.y+=Math.random()*2-1)}}});let x=0;const D=Iu(()=>({startNodes:()=>[],state(){var T,z,L,j,G,Q,ce,Oe,_e,Ce,ee,Fe,we;let k=[];{let fe=[];for(let[E,Pe]of Object.entries(a.value)){let{x:De,y:Ye}=Gt(E);for(let it of Pe.enemies)it[Ge]||(it[Ge]=x,x+=1),fe.push({...it,position:{x:De,y:Ye}});De=De*100,Ye=Ye*100,Pe[Ge]||(Pe[Ge]=x,x+=2),k.push({id:(T=Pe[Ge])!=null?T:0,position:{x:De,y:Ye},type:"loop",state:{target:Pe}}),Pe.building&&k.push({id:((z=Pe[Ge])!=null?z:0)+1,position:{x:De,y:Ye},type:"building",state:{target:Pe.building}})}for(let E of fe){let{x:Pe,y:De}=E.position;k.push({id:(L=E[Ge])!=null?L:0,position:{x:(Pe+Math.sin(E.angle*2*Math.PI)*.5)*100,y:(De+Math.cos(E.angle*2*Math.PI)*.5)*100},type:"enemy",state:{target:E}})}}if(p.value==Ue.Stopped&&((j=c(D.state))==null?void 0:j.nodes.length)>0){let fe=(G=c(D.state))==null?void 0:G.nodes;for(let E in k)k[E].position.x=(ce=(Q=fe[E])==null?void 0:Q.position.x)!=null?ce:k[E].position.x,k[E].position.y=(_e=(Oe=fe[E])==null?void 0:Oe.position.y)!=null?_e:k[E].position.y,k[E].state=(ee=(Ce=fe[E])==null?void 0:Ce.state)!=null?ee:k[E].state}return{nodes:k,selectedNode:(we=(Fe=c(D.state))==null?void 0:Fe.selectedNode)!=null?we:null,selectedAction:null}},links(){let k=[];for(let[T,z]of Object.entries(a.value))for(let L of z.enemies)if(L[$e])for(let j in L[$e]){let G=D.nodes.value.find(ce=>ce.id==+j),Q=D.nodes.value.find(ce=>ce.id==L[Ge]);G&&Q&&k.push({startNode:G,endNode:Q,stroke:"white",strokeWidth:2}),L[$e][j]<=0&&delete L[$e][j]}return k},classes:{"game-board":!0},types:Du})),ae=cn(()=>({width:500,height:31,direction:O.Right,progress:$(()=>n.value),display:Me(()=>m("span",{class:"bar-label"},[F("Cycle "),oe(t.value)])),fillStyle:{backgroundColor:"#50637c"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),ge=cn(()=>({width:249,height:31,direction:O.Right,progress:$(()=>i.value),display:Me(()=>m("span",{class:"bar-label left"},[F("Stress: "),oe(i.value*100),F("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),ne=cn(()=>({width:249,height:31,direction:O.Left,progress:$(()=>r.value/100),display:Me(()=>m("span",{class:"bar-label right"},[F("HP: "),oe(r.value),F("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderLeft:"2px solid var(--outline)",borderRadius:"0 0 4px 0"}}));let re=0,Nt=V(!1),q=V(""),ue=V(O.Default),Te=V({});function Ke(k,T,z=O.Default){q.value=k,Nt.value=!0,ue.value=z,setTimeout(()=>{var Oe;let L=(Oe=document.querySelector(".game-tooltip"))==null?void 0:Oe.getBoundingClientRect(),j=T.getBoundingClientRect();if(!L)return;(L.right+L.left)/2,(L.bottom+L.top)/2;let G={x:(j.right+j.left)/2,y:(j.bottom+j.top)/2},Q=_e=>Math.min(Math.max(_e,8),window.innerHeight-L.height-8),ce=_e=>Math.min(Math.max(_e,8),window.innerWidth-L.width-8);z==O.Left?Te.value={right:window.innerWidth-(j.left-12)+"px",top:Q(G.y-L.height/2)+"px"}:z==O.Right?Te.value={left:j.right+12+"px",top:Q(G.y-L.height/2)+"px"}:z==O.Up?Te.value={left:ce(G.x-L.width/2)+"px",bottom:window.innerHeight-(j.top-12)+"px"}:z==O.Down&&(Te.value={left:ce(G.x-L.width/2)+"px",top:j.bottom+12+"px"})},0)}function xt(){Nt.value=!1}let ve=V("");function on(k){if(!xe[k])return!1;let T=b(k);for(let[z,L]of Object.entries(xe[k].baseCost))if(o[z].value<L*T)return!1;return!0}function In(k,T){var z,L;if(xe[k.type].upgrades[T].max!==void 0&&k.upgrades[T]>=((z=xe[k.type].upgrades[T].max)!=null?z:0)-1)return!1;for(let[j,G]of Object.entries(xe[k.type].upgrades[T].cost((L=k.upgrades[T])!=null?L:0)))if(o[j].value<G)return!1;return!0}function mr(k,T){var z,L;if(In(k,T)){for(let[j,G]of Object.entries(xe[k.type].upgrades[T].cost((z=k.upgrades[T])!=null?z:0)))o[j].value-=G;k.upgrades[T]=((L=k.upgrades[T])!=null?L:0)+1}}function hr(k,T,z){re=setTimeout(()=>{let L=b(z);Ke(m(be,null,[m("h3",null,[T.name])," ",m("h5",{style:"display: inline-block; margin: 0"},[m("i",null,[F("- "),T.class.toUpperCase()])]),m("br",null,null),m("i",null,[T.description]),m("hr",null,null),m("h5",null,[F("BUILDING COST:")]),m("div",{class:"stat-entries"},[Object.entries(T.baseCost).map(([j,G])=>m("div",{class:{red:o[j].value<G*L}},[m("div",{class:"name"},[o[j].displayName]),m("div",{class:"value"},[oe(G*L)])]))]),m("hr",null,null),m("h5",null,[F("STARTING SPECS:")]),m("div",{class:"stat-entries"},[Object.entries(T.upgrades).map(([j,G])=>{var Q,ce;return m("div",null,[m("div",{class:"name"},[G.name]),m("div",{class:"value"},[Pt(G.effect(0),(Q=G.precision)!=null?Q:0)+((ce=G.unit)!=null?ce:"")])])})])]),k.target,O.Left)},500)}function vr(k,T,z){clearTimeout(re),xt()}function pr(k,T,z){clearTimeout(re),xt(),on(z)&&(ve.value=ve.value==z?"":z)}const jt=V(!1);return{name:e,color:"#afcfef",cycle:t,cycleProgress:n,cycleBar:ae,health:r,healthBar:ne,gameState:p,gameSpeed:y,loops:a,buildingFactor:g,buildingFactors:_,resources:o,resourcesTotal:s,lifetime:u,board:D,startGame:S,endGame:A,display:Me(()=>m(be,null,[pt(D),m("div",{class:{"game-top":!0,hidden:p.value!=Ue.Started||t.value<=0}},[m("div",{style:"display: flex; height: 31px"},[m("span",{class:"bar-label"},[oe(o.energy.value),F(" energy")])]),pt(ae),m("div",{style:"display: flex"},[pt(ge),pt(ne)])]),m("div",{class:{"game-bottom":!0,hidden:p.value!=Ue.Started}},[(()=>{var T;let k=(T=D.selectedNode.value)==null?void 0:T.state;return m(be,null,[k?m("div",{style:"display: flex; height: 31px"},[k.target.building?m("div",{class:"building-upgrades",style:{"--layer-color":xe[k.target.building.type].color}},[Object.entries(xe[k.target.building.type].upgrades).map(([z,L])=>{var G,Q,ce,Oe,_e,Ce,ee,Fe,we,fe,E;let j=(Q=(G=k==null?void 0:k.target.building)==null?void 0:G.upgrades[z])!=null?Q:0;return xe[(Oe=(ce=k==null?void 0:k.target.building)==null?void 0:ce.type)!=null?Oe:""].upgrades[z].max!==void 0&&j>=((ee=xe[(Ce=(_e=k==null?void 0:k.target.building)==null?void 0:_e.type)!=null?Ce:""].upgrades[z].max)!=null?ee:0)-1,m("button",{class:{feature:!0,can:In(k==null?void 0:k.target.building,z)},onClick:()=>mr(k==null?void 0:k.target.building,z)},[F("Level "),oe(j+1)+(L.max?" / "+oe(L.max):""),m("br",null,null),m("h3",null,[L.name]),m("hr",null,null),F("\u2191 "),Pt(L.effect(j+1),(Fe=L.precision)!=null?Fe:0)+((we=L.unit)!=null?we:""),F(" \u2191"),m("br",null,null),Pt(L.effect(j),(fe=L.precision)!=null?fe:0)+((E=L.unit)!=null?E:""),m("br",null,null),m("hr",null,null),Object.entries(L.cost(j)).map(([Pe,De])=>oe(De)+" "+o[Pe].displayName).join(", ")])})]):m("span",{class:"bar-label"},[F("Select a building to build \u2192")])]):"",m("div",{style:"display: flex; height: 31px"},[m("span",null,[k?k.target.building?xe[k.target.building.type].name:m("i",null,[F("No building")]):ve.value?"\u25B2 Select a loop to build \u25B2":"\u25B2 Select a loop from above \u25B2"])])])})()]),m("div",{class:{"game-right":!0,hidden:p.value!=Ue.Started}},[m("div",{class:"building-list"},[Object.entries(xe).map(([k,T])=>m("button",{class:Object.fromEntries([[T.class,!0],["selected",ve.value==k],["disabled",!on(k)]]),onMouseenter:z=>hr(z,T,k),onMouseleave:z=>vr(),onClick:z=>pr(z,T,k)},[m("div",{class:"background",style:{background:T.color}},[m("div",{class:"icon"},[T.icon])])]))])]),m("div",{class:{"game-tooltip":!0,hidden:!Nt.value,left:ue.value==O.Left,right:ue.value==O.Right,top:ue.value==O.Up,bottom:ue.value==O.Down},style:Te.value},[q.value]),m(dt,{modelValue:jt.value},{header:()=>m("div",{style:"text-align: center"},[m("h1",{class:"result-title"},[F("GAME OVER")]),m("h2",{style:"font-style: italic;"},[F("- The cycle has been broken. -")])]),body:()=>m("div",{style:"text-align: center"},[m("div",{class:"result-entry"},[m("div",{class:"name"},[F("Cycles reached")]),m("h1",{class:"value"},[oe(t.value)])]),m("div",{class:"result-entry"},[m("div",{class:"name"},[F("Relative lifetime")]),m("div",{class:"value"},[tn(u.value)])]),m("div",{style:"width: 75%; margin-top: 10px;"},[m("div",{class:"name"},[F("Total resources gained:")]),m("div",{class:"stat-entries"},[Object.entries(s).filter(([k,T])=>d.gt(T.value,0)).map(([k,T])=>m("div",null,[m("div",{class:"name"},[o[k].displayName]),m("div",{class:"value"},[oe(T.value)])]))||"Nothing :("])]),m("div",{style:"width: 75%; margin-top: 10px;"},[m("div",{class:"name"},[F("Hub rewards:")]),m("div",{class:"stat-entries"},[m("div",null,[m("div",{class:"name"},[F("XP")]),m("div",{class:"value"},[oe(v.value)])])])])]),footer:()=>m("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[m("button",{class:"feature can",onClick:()=>{setTimeout(()=>{Qt.points.value+=v.value,S()},1e3),jt.value=!1}},[F("Replay")]),m("button",{class:"feature can",onClick:k=>{try{navigator.share({title:"Delooped",text:"I reached Cycle "+oe(t.value)+" on Delooped!",url:"https://ducdat0507.itch.io/delooped"})}catch(T){T instanceof TypeError&&(navigator.clipboard.writeText("I reached Cycle "+oe(t.value)+` on Delooped!
https://ducdat0507.itch.io/delooped`),clearTimeout(re),k.target.innerText="Copied to clipboard",re=setTimeout(()=>k.target.innerText="Share",2e3))}}},[F("Share")]),m("div",{style:"flex-grow: 1"},null),m("button",{class:"feature can",onClick:()=>{setTimeout(()=>{Qt.points.value+=v.value,p.value=Ue.Idle,Z.tabs=["main"]},1e3),jt.value=!1}},[F("Return to Hub")])])})])),minimizable:!1,classes:{game:!0}}}),Qt=Sn("main",function(){const e=lr(0),t=ur(e);let n=V(null),r=m(rr,null,null),i=m(kn,null,null),a=m(or,null,null),u=!1;return Ie.on("update",o=>{var s,g,_,b,p;if(r.component&&!n.value&&(n.value=m(ir,{changelog:(s=r.component)==null?void 0:s.exposed},null)),((g=n.value)==null?void 0:g.el)&&!u){let y=document.querySelector("#modal-root");y.append(y.firstElementChild),((p=(b=(_=y.lastElementChild)==null?void 0:_.querySelector)==null?void 0:b.call(_,".modal-header"))==null?void 0:p.innerText)=="Changelog"&&(u=!0)}}),{name:"Tree",color:"#afcfef",display:Me(()=>m(be,null,[F("XP: "),pn(e.value),m("br",null,null),F("Hub is coming soon"),m("br",null,null),m("br",null,null),m("button",{class:"feature can",onClick:()=>{Z.tabs=["game"],gr.startGame()}},[F("Start game")]),m("br",null,null),m("button",{class:"feature can",onClick:()=>{var o,s,g;return(g=(s=(o=n.value)==null?void 0:o.component)==null?void 0:s.exposed)==null?void 0:g.open()}},[F(" Info ")]),m("button",{class:"feature can",onClick:()=>{var o,s;return(s=(o=i.component)==null?void 0:o.exposed)==null?void 0:s.open()}},[F(" Saves manager ")]),m("button",{class:"feature can",onClick:()=>{var o,s;return(s=(o=a.component)==null?void 0:o.exposed)==null?void 0:s.open()}},[F(" Options ")]),n.value,r,i,a])),minimizable:!1,points:e,total:t}}),Zu=e=>[Qt,gr],fr=$(()=>!1);function Yu(e,t){}var Ju=Object.freeze(Object.defineProperty({__proto__:null,main:Qt,getInitialLayers:Zu,hasWon:fr,fixOldSave:Yu},Symbol.toStringTag,{value:"Module"}));const Ut=e=>(lt("data-v-4a50ce42"),e=e(),ut(),e),Ku={class:"game-over-modal-header"},Xu=["src","alt"],Qu={class:"game-over-modal-title"},ec=Ut(()=>h("h2",null,"Congratulations!",-1)),tc={key:0},nc=Ut(()=>h("br",null,null,-1)),rc=Ut(()=>h("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),ic=Ut(()=>h("br",null,null,-1)),ac=["href"],oc=Ut(()=>h("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),sc=K({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:r,discordLink:i,versionNumber:a,versionTitle:u}=J,o=$(()=>tn(Z.timePlayed)),s=$(()=>fr.value&&!Z.keepGoing),g=st(Z,"autosave");function _(){Z.keepGoing=!0}function b(){vt(St())}return(p,y)=>(N(),X(dt,{"model-value":s.value},{header:U(()=>[h("div",Ku,[c(n)?(N(),M("img",{key:0,class:"game-over-modal-logo",src:c(n),alt:c(t)},null,8,Xu)):B("",!0),h("div",Qu,[ec,h("h4",null,"You've beaten "+H(c(t))+" v"+H(c(a))+": "+H(c(u)),1)])])]),body:U(({shown:v})=>[v?(N(),M("div",tc,[h("div",null,"It took you "+H(o.value)+" to beat the game.",1),nc,rc,ic,h("div",null,[h("a",{href:c(i),class:"game-over-modal-discord-link"},[oc,F(" "+H(c(r)),1)],8,ac)]),m(Xe,{title:"Autosave",modelValue:g.value,"onUpdate:modelValue":y[0]||(y[0]=S=>g.value=S)},null,8,["modelValue"])])):B("",!0)]),footer:U(()=>[h("div",{class:"game-over-footer"},[h("button",{onClick:_,class:"button"},"Keep Going"),h("button",{onClick:b,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var lc=le(sc,[["__scopeId","data-v-4a50ce42"]]);const an=e=>(lt("data-v-2776d67d"),e=e(),ut(),e),uc=an(()=>h("div",{class:"nan-modal-header"},[h("h2",null,"NaN value detected!")],-1)),cc={key:0},dc=an(()=>h("br",null,null,-1)),gc=["href"],fc=an(()=>h("span",{class:"material-icons nan-modal-discord"},"discord",-1)),mc=an(()=>h("br",null,null,-1)),hc={class:"nan-footer"},vc=K({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=J,r=V(!0),i=V(!0),a=st(me,"hasNaN"),u=V(null);Je(a,p=>{p?(r.value=Z.autosave,i.value=Z.devSpeed===0):(Z.autosave=r.value,Z.devSpeed=i.value?0:null)});const o=$(()=>{var p;return(p=me.NaNPath)==null?void 0:p.join(".")}),s=$(()=>me.NaNPersistent!=null?me.NaNPersistent.value:null);function g(){me.NaNPersistent!=null&&(me.NaNPersistent.value=new d(0),me.hasNaN=!1)}function _(){me.NaNPersistent&&(me.NaNPersistent.value=new d(1),me.hasNaN=!1)}function b(){me.NaNPersistent&&(me.NaNPersistent.value=new d(NaN),me.hasNaN=!1)}return(p,y)=>(N(),M(be,null,[m(dt,_t({modelValue:a.value,"onUpdate:modelValue":y[4]||(y[4]=v=>a.value=v)},p.$attrs),{header:U(()=>[uc]),body:U(()=>[h("div",null,[F(' Attempted to assign "'+H(o.value)+'" to NaN',1),s.value?(N(),M("span",cc,H(" ")+"(previously "+H(c(Pt)(s.value))+")",1)):B("",!0),F(". Auto-saving has been "+H(r.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),dc,h("div",null,[h("a",{href:c(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[fc,F(" "+H(c(t)||"The Paper Pilot Community"),1)],8,gc)]),mc,m(Xe,{title:"Autosave",modelValue:r.value,"onUpdate:modelValue":y[0]||(y[0]=v=>r.value=v)},null,8,["modelValue"]),c(J).enablePausing?(N(),X(Xe,{key:0,title:"Pause game",modelValue:i.value,"onUpdate:modelValue":y[1]||(y[1]=v=>i.value=v)},null,8,["modelValue"])):B("",!0)]),footer:U(()=>[h("div",hc,[h("button",{onClick:y[2]||(y[2]=v=>{var S;return(S=u.value)==null?void 0:S.open()}),class:"button"},"Open Saves Manager"),h("button",{onClick:g,class:"button"},"Set to 0"),h("button",{onClick:_,class:"button"},"Set to 1"),s.value&&c(d).neq(s.value,0)&&c(d).neq(s.value,1)?(N(),M("button",{key:0,onClick:y[3]||(y[3]=v=>a.value=!1),class:"button"}," Set to previous ")):B("",!0),h("button",{onClick:b,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),m(kn,{ref_key:"savesManager",ref:u},null,512)],64))}});var pc=le(vc,[["__scopeId","data-v-2776d67d"]]);const bc={key:0,class:"tpsDisplay"},yc=K({__name:"TPS",setup(e){const t=$(()=>d.div(me.lastTenTicks.length,me.lastTenTicks.reduce((n,r)=>n+r,0)));return(n,r)=>t.value.isNan()?B("",!0):(N(),M("div",bc,"TPS: "+H(c(pn)(t.value)),1))}});var _c=le(yc,[["__scopeId","data-v-89b89152"]]);var wc=K({__name:"App",setup(e){const t=J.useHeader,n=$(()=>He[ie.theme].variables),r=st(ie,"showTPS"),i=st(me,"errors"),a=$(()=>ct(Me(()=>m(be,null,[aa.map(pt)]))));return(u,o)=>i.value.length>0?(N(),M("div",{key:0,class:"error-container",style:Re(n.value)},[m(Bn,{errors:i.value},null,8,["errors"])],4)):(N(),M(be,{key:1},[h("div",{id:"modal-root",style:Re(n.value)},null,4),h("div",{class:ye(["app",{useHeader:c(t)}]),style:Re(n.value)},[m(Gl),c(r.value)?(N(),X(_c,{key:0})):B("",!0),m(lc),m(pc),(N(),X(We(a.value)))],6)],64))}});var Nc=le(wc,[["__scopeId","data-v-4504ed0c"]]);Ie.on("setupVue",e=>e.use(Fr));function Sc(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e;let o,s,g,_;const b=async(y=!0)=>{await g,y&&(o==null||o.addEventListener("controlling",v=>{v.isUpdate&&window.location.reload()})),await(_==null?void 0:_())};async function p(){if("serviceWorker"in navigator){const{Workbox:y,messageSW:v}=await Vt(()=>import("./workbox-window.4a8794bb.js"),[]);_=async()=>{s&&s.waiting&&await v(s.waiting,{type:"SKIP_WAITING"})},o=new y("./sw.js",{scope:"./",type:"classic"}),o.addEventListener("activated",S=>{S.isUpdate||r==null||r()});{const S=()=>{n==null||n()};o.addEventListener("waiting",S),o.addEventListener("externalwaiting",S)}o.register({immediate:t}).then(S=>{s=S,a?a("./sw.js",S):i==null||i(S)}).catch(S=>{u==null||u(S)})}}return g=p(),b}function Cc(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e,o=V(!1),s=V(!1);return{updateServiceWorker:Sc({immediate:t,onNeedRefresh(){o.value=!0,n==null||n()},onOfflineReady(){s.value=!0,r==null||r()},onRegistered:i,onRegisteredSW:a,onRegisterError:u}),offlineReady:s,needRefresh:o}}const Mn=console.error;console.error=function(...e){Mn(...e)};window.onerror=function(e,t,n,r,i){return me.errors.push(i instanceof Error?i:new Error(JSON.stringify(i))),Mn(i),!0};window.onunhandledrejection=function(e){me.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),Mn(e.reason)};document.title=J.title;window.projInfo=J;J.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await ea();const{globalBus:e}=await Vt(()=>Promise.resolve().then(function(){return Qi}),void 0),{startGameLoop:t}=await Vt(()=>import("./gameLoop.e44a4bff.js"),["assets/gameLoop.e44a4bff.js","assets/@fontsource.7386452e.css","assets/vue.d3924a70.js","assets/amator.0d8662e6.js","assets/bezier-easing.a990b400.js","assets/@vue.f39bd477.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.90a10463.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.09420910.js","assets/sortablejs.c81ffc7d.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.84096fdf.js","assets/panzoom.a3919164.js","assets/wheel.e9936e98.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.1036abd4.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=Mr(Nc);n.config.errorHandler=function(r,i,a){console.error(r,a,i)},e.emit("setupVue",n),n.mount("#app"),Et(()=>{const r=Pr(),{updateServiceWorker:i}=Cc({onNeedRefresh(){r.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){i()}})},onOfflineReady(){r.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(a){a&&setInterval(()=>a.update(),60*60*1e3)}})}),t()});export{d as D,Vt as _,me as a,J as b,Ju as c,Ie as g,Zn as l,Z as p,ie as s};
