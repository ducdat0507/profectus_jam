/* empty css                    */import"./vue.d3924a70.js";import{q as en,D as f,ad as se,t as V,aM as x,a3 as M,aS as Ct,bD as Jt,H as Pe,az as Kt,a0 as F,aG as Gn,a4 as m,K as ne,Q as W,aR as _t,a2 as G,J as et,aa as y,ab as s,bf as X,aP as Et,aN as Dt,l as Qe,u as Wn,ba as gt,aK as mi,w as tn,bb as Dn,aO as kn,A as Ze,a1 as re,bh as Hn,bB as Wi,ay as Ht,bk as dn,V as Hi,j as Yi,bE as Pt,aF as Zi,aT as Yt,aV as at,z as Ft,bw as Xi,bA as Ji,bl as ai,as as ri,bn as Ki}from"./@vue.f39bd477.js";import{L as wt}from"./lz-string.dccec454.js";import{c as pi}from"./nanoevents.1080beb7.js";import{Y as Qi}from"./vue-next-select.90a10463.js";import{D as ea}from"./vuedraggable.09420910.js";import{p as ta}from"./vue-textarea-autosize.35804eaf.js";import{P as na}from"./vue-panzoom.84096fdf.js";import{s as ia,u as aa}from"./vue-toastification.1036abd4.js";import"./amator.0d8662e6.js";import"./bezier-easing.a990b400.js";import"./sortablejs.c81ffc7d.js";import"./panzoom.a3919164.js";import"./wheel.e9936e98.js";import"./ngraph.events.083734c6.js";const ra=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};ra();const sa="modulepreload",si={},oa="./",fn=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${oa}${i}`,i in si)return;si[i]=!0;const a=i.endsWith(".css"),r=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${r}`))return;const l=document.createElement("link");if(l.rel=a?"stylesheet":sa,a||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),a)return new Promise((o,u)=>{l.addEventListener("load",o),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())},la="./projInfo-schema.json",ua="Delooped",ca="A project made in Profectus",da="delooped",fa="ducdat0507",ga="",ma="",pa="0.2.1",va="Slightly Less Prototypey Thing",ha=!0,ba=!1,ya=2,_a=!1,wa=null,Ca="",Na=["game"],ka=1,xa=0,Sa=!1,Ma="base64";var le={$schema:la,title:ua,description:ca,id:da,author:fa,discordName:ga,discordLink:ma,versionNumber:pa,versionTitle:va,allowGoBack:ha,defaultShowSmall:ba,defaultDecimalsShown:ya,useHeader:_a,banner:wa,logo:Ca,initialTabs:Na,maxTickLength:ka,offlineLimit:xa,enablePausing:Sa,exportEncoding:Ma};const Ia=en({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var U=window.player=Ia;function Yn(e){return JSON.stringify(e,(t,n)=>f(n))}var ke=(e,t)=>{const n=e.__vccOpts||e;for(const[i,a]of t)n[i]=a;return n};const $a=["onClick"],Ta=se({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=V(!1),i=V(null);function a(){t("click"),i.value&&clearTimeout(i.value),n.value=!1,Kt(()=>{n.value=!0,i.value=setTimeout(()=>n.value=!1,500)})}return(r,l)=>(x(),M("button",{onClick:Jt(a,["stop"]),class:Pe(["feedback",{activated:n.value,left:r.left}])},[Ct(r.$slots,"default",{},void 0,!0)],10,$a))}});var Zn=ke(Ta,[["__scopeId","data-v-01a1b95c"]]);const On=e=>(Et("data-v-ac351c02"),e=e(),Dt(),e),Pa={class:"error"},Fa={class:"error-title"},Ea={class:"error-details",style:{"margin-top":"-10px"}},Da={key:0},Oa={class:"instructions"},Aa=["href"],Va=On(()=>m("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),Ba=On(()=>m("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),La=On(()=>m("br",null,null,-1)),qa={key:0,style:{"margin-top":"20px"}},Ra=On(()=>m("h3",null,"Other errors",-1)),za=[Ra],ja={class:"error-details"},Ua={key:0,style:{"margin-top":"10px"}},Ga={key:1,style:{"margin-top":"10px"}},Wa=se({__name:"Error",props:{errors:{}},setup(e){const t=e,n=F(()=>t.errors[0]),i=F(()=>t.errors.map(l=>l.stack==null?[]:l.stack.split(`
`))),a=F(()=>t.errors.map(l=>l.cause==null?[]:(typeof l.cause=="string"?l.cause:JSON.stringify(l.cause)).split(`
`)));function r(){let l=Yn(U);switch(le.exportEncoding){default:console.warn(`Unknown save encoding: ${le.exportEncoding}. Defaulting to lz`);case"lz":l=wt.compressToUTF16(l);break;case"base64":l=btoa(unescape(encodeURIComponent(l)));break;case"plain":break}console.log(l);const o=document.createElement("textarea");o.value=l,document.body.appendChild(o),o.select(),o.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(o)}return Gn(()=>{U.autosave=!1,U.devSpeed=0}),(l,o)=>(x(),M("div",Pa,[m("h1",Fa,ne(n.value.name)+": "+ne(n.value.message),1),m("div",Ea,[n.value.cause?(x(),M("div",Da,[(x(!0),M(W,null,_t(a.value[0],u=>(x(),M("div",{key:u},ne(u),1))),128))])):G("",!0),n.value.stack?(x(),M("div",{key:1,style:et(n.value.cause?"margin-top: 10px":"")},[(x(!0),M(W,null,_t(i.value[0],u=>(x(),M("div",{key:u},ne(u),1))),128))],4)):G("",!0)]),m("div",Oa,[y(" Check the console for more details, and consider sharing it with the developers on "),m("a",{href:f(le).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,Aa),y("! "),s(Zn,{onClick:r,class:"button",style:{display:"inline-flex"}},{default:X(()=>[Va,Ba]),_:1}),La,l.errors.length>1?(x(),M("div",qa,za)):G("",!0),(x(!0),M(W,null,_t(l.errors.slice(1),(u,g)=>(x(),M("div",{key:g,style:{"margin-top":"20px"}},[m("details",ja,[m("summary",null,ne(u.name)+": "+ne(u.message),1),u.cause?(x(),M("div",Ua,[(x(!0),M(W,null,_t(a.value[g+1],h=>(x(),M("div",{key:h},ne(h),1))),128))])):G("",!0),u.stack?(x(),M("div",Ga,[(x(!0),M(W,null,_t(i.value[g+1],h=>(x(),M("div",{key:h},ne(h),1))),128))])):G("",!0)])]))),128))])]))}});var vi=ke(Wa,[["__scopeId","data-v-ac351c02"]]);class Ha{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const i=new Ya(t,n);for(this.first===void 0?(this.first=i,this.last=i):(i.next=this.first,this.first.prev=i,this.first=i),this.map.set(t,i);this.map.size>this.maxSize;){const a=this.last;this.map.delete(a.key),this.last=a.prev,this.last.next=void 0}}}class Ya{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const qn=17,Za=9e15,Xa=Math.log10(9e15),Ja=1/9e15,Ka=308,Qa=-324,oi=5,er=(1<<10)-1,tr=function(){const e=[];for(let n=Qa+1;n<=Ka;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),Bt=[2,Math.E,3,4,5,6,7,8,9,10],nr=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],ir=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let k=function(t){return c.fromValue_noAlloc(t)},ee=function(e,t,n){return c.fromComponents(e,t,n)},ie=function(t,n,i){return c.fromComponents_noNormalize(t,n,i)};const It=function(t,n){const i=n+1,a=Math.ceil(Math.log10(Math.abs(t))),r=Math.round(t*Math.pow(10,i-a))*Math.pow(10,a-i);return parseFloat(r.toFixed(Math.max(i-a,0)))},Rn=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},ar=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const i=e*e;let a=e;return n=n+1/(12*a),a=a*i,n=n+1/(360*a),a=a*i,n=n+1/(1260*a),a=a*i,n=n+1/(1680*a),a=a*i,n=n+1/(1188*a),a=a*i,n=n+691/(360360*a),a=a*i,n=n+7/(1092*a),a=a*i,n=n+3617/(122400*a),Math.exp(n)/t},hi=.5671432904097838,li=function(e,t=1e-10){let n,i;if(!Number.isFinite(e)||e===0)return e;if(e===1)return hi;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let a=0;a<100;++a){if(i=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(i-n)<t*Math.abs(i))return i;n=i}throw Error(`Iteration failed to converge: ${e.toString()}`)};function ui(e,t=1e-10){let n,i,a,r;if(!Number.isFinite(e.mag)||e.eq(c.dZero))return e;if(e.eq(c.dOne))return c.fromNumber(hi);n=c.ln(e);for(let l=0;l<100;++l){if(i=n.neg().exp(),a=n.sub(e.mul(i)),r=n.sub(a.div(n.add(1).sub(n.add(2).mul(a).div(c.mul(2,n).add(2))))),c.abs(r.sub(n)).lt(c.abs(r).mul(t)))return r;n=r}throw Error(`Iteration failed to converge: ${e.toString()}`)}const v=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof v?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/tr(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new v().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new v().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new v().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new v().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new v().fromDecimal(e)}static fromNumber(e){return new v().fromNumber(e)}static fromString(e){return new v().fromString(e)}static fromValue(e){return new v().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof v)return e;if(typeof e=="string"){const t=v.fromStringCache.get(e);return t!==void 0?t:v.fromString(e)}else return typeof e=="number"?v.fromNumber(e):v.dZero}static abs(e){return k(e).abs()}static neg(e){return k(e).neg()}static negate(e){return k(e).neg()}static negated(e){return k(e).neg()}static sign(e){return k(e).sign}static sgn(e){return k(e).sign}static round(e){return k(e).round()}static floor(e){return k(e).floor()}static ceil(e){return k(e).ceil()}static trunc(e){return k(e).trunc()}static add(e,t){return k(e).add(t)}static plus(e,t){return k(e).add(t)}static sub(e,t){return k(e).sub(t)}static subtract(e,t){return k(e).sub(t)}static minus(e,t){return k(e).sub(t)}static mul(e,t){return k(e).mul(t)}static multiply(e,t){return k(e).mul(t)}static times(e,t){return k(e).mul(t)}static div(e,t){return k(e).div(t)}static divide(e,t){return k(e).div(t)}static recip(e){return k(e).recip()}static reciprocal(e){return k(e).recip()}static reciprocate(e){return k(e).reciprocate()}static cmp(e,t){return k(e).cmp(t)}static cmpabs(e,t){return k(e).cmpabs(t)}static compare(e,t){return k(e).cmp(t)}static isNaN(e){return e=k(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=k(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return k(e).eq(t)}static equals(e,t){return k(e).eq(t)}static neq(e,t){return k(e).neq(t)}static notEquals(e,t){return k(e).notEquals(t)}static lt(e,t){return k(e).lt(t)}static lte(e,t){return k(e).lte(t)}static gt(e,t){return k(e).gt(t)}static gte(e,t){return k(e).gte(t)}static max(e,t){return k(e).max(t)}static min(e,t){return k(e).min(t)}static minabs(e,t){return k(e).minabs(t)}static maxabs(e,t){return k(e).maxabs(t)}static clamp(e,t,n){return k(e).clamp(t,n)}static clampMin(e,t){return k(e).clampMin(t)}static clampMax(e,t){return k(e).clampMax(t)}static cmp_tolerance(e,t,n){return k(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return k(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return k(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return k(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return k(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return k(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return k(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return k(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return k(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return k(e).gte_tolerance(t,n)}static pLog10(e){return k(e).pLog10()}static absLog10(e){return k(e).absLog10()}static log10(e){return k(e).log10()}static log(e,t){return k(e).log(t)}static log2(e){return k(e).log2()}static ln(e){return k(e).ln()}static logarithm(e,t){return k(e).logarithm(t)}static pow(e,t){return k(e).pow(t)}static pow10(e){return k(e).pow10()}static pow_base(e,t){return k(e).pow_base(t)}static root(e,t){return k(e).root(t)}static factorial(e,t){return k(e).factorial()}static gamma(e,t){return k(e).gamma()}static lngamma(e,t){return k(e).lngamma()}static exp(e){return k(e).exp()}static sqr(e){return k(e).sqr()}static sqrt(e){return k(e).sqrt()}static cube(e){return k(e).cube()}static cbrt(e){return k(e).cbrt()}static tetrate(e,t=2,n=ie(1,0,1)){return k(e).tetrate(t,n)}static iteratedexp(e,t=2,n=ie(1,0,1)){return k(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return k(e).iteratedlog(t,n)}static layeradd10(e,t){return k(e).layeradd10(t)}static layeradd(e,t,n=10){return k(e).layeradd(t,n)}static slog(e,t=10){return k(e).slog(t)}static lambertw(e){return k(e).lambertw()}static ssqrt(e){return k(e).ssqrt()}static pentate(e,t=2,n=ie(1,0,1)){return k(e).pentate(t,n)}static sin(e){return k(e).sin()}static cos(e){return k(e).cos()}static tan(e){return k(e).tan()}static asin(e){return k(e).asin()}static acos(e){return k(e).acos()}static atan(e){return k(e).atan()}static sinh(e){return k(e).sinh()}static cosh(e){return k(e).cosh()}static tanh(e){return k(e).tanh()}static asinh(e){return k(e).asinh()}static acosh(e){return k(e).acosh()}static atanh(e){return k(e).atanh()}static affordGeometricSeries(e,t,n,i){return this.affordGeometricSeries_core(k(e),k(t),k(n),i)}static sumGeometricSeries(e,t,n,i){return this.sumGeometricSeries_core(e,k(t),k(n),i)}static affordArithmeticSeries(e,t,n,i){return this.affordArithmeticSeries_core(k(e),k(t),k(n),k(i))}static sumArithmeticSeries(e,t,n,i){return this.sumArithmeticSeries_core(k(e),k(t),k(n),k(i))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(k(e),k(t),k(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return ie(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return ie(t,0,1);const n=Math.floor(Math.random()*(e+1));let i=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(i=Math.trunc(i));let a=Math.pow(10,i);return Math.random()>.9&&(a=Math.trunc(a)),ee(t,n,a)}static affordGeometricSeries_core(e,t,n,i){const a=t.mul(n.pow(i));return v.floor(e.div(a).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,i){return t.mul(n.pow(i)).mul(v.sub(1,n.pow(e))).div(v.sub(1,n))}static affordArithmeticSeries_core(e,t,n,i){const r=t.add(i.mul(n)).sub(n.div(2)),l=r.pow(2);return r.neg().add(l.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,i){const a=t.add(i.mul(n));return e.div(2).mul(a.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<Ja)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=Za)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<Xa&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=v.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const i=e.split("^^^");if(i.length===2){const b=parseFloat(i[0]),C=parseFloat(i[1]),E=i[1].split(";");let T=1;if(E.length===2&&(T=parseFloat(E[1]),isFinite(T)||(T=1)),isFinite(b)&&isFinite(C)){const S=v.pentate(b,C,T);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const a=e.split("^^");if(a.length===2){const b=parseFloat(a[0]),C=parseFloat(a[1]),E=a[1].split(";");let T=1;if(E.length===2&&(T=parseFloat(E[1]),isFinite(T)||(T=1)),isFinite(b)&&isFinite(C)){const S=v.tetrate(b,C,T);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const r=e.split("^");if(r.length===2){const b=parseFloat(r[0]),C=parseFloat(r[1]);if(isFinite(b)&&isFinite(C)){const E=v.pow(b,C);return this.sign=E.sign,this.layer=E.layer,this.mag=E.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}e=e.trim().toLowerCase();let l,o,u=e.split("pt");if(u.length===2){l=10,o=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let b=parseFloat(u[1]);if(isFinite(b)||(b=1),isFinite(l)&&isFinite(o)){const C=v.tetrate(l,o,b);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}if(u=e.split("p"),u.length===2){l=10,o=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let b=parseFloat(u[1]);if(isFinite(b)||(b=1),isFinite(l)&&isFinite(o)){const C=v.tetrate(l,o,b);return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}const g=e.split("e"),h=g.length-1;if(h===0){const b=parseFloat(e);if(isFinite(b))return this.fromNumber(b),v.fromStringCache.size>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}else if(h===1){const b=parseFloat(e);if(isFinite(b)&&b!==0)return this.fromNumber(b),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}const p=e.split("e^");if(p.length===2){this.sign=1,p[0].charAt(0)=="-"&&(this.sign=-1);let b="";for(let C=0;C<p[1].length;++C){const E=p[1].charCodeAt(C);if(E>=43&&E<=57||E===101)b+=p[1].charAt(C);else return this.layer=parseFloat(b),this.mag=parseFloat(p[1].substr(C+1)),this.normalize(),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}}if(h<1)return this.sign=0,this.layer=0,this.mag=0,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this;const _=parseFloat(g[0]);if(_===0)return this.sign=0,this.layer=0,this.mag=0,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this;let w=parseFloat(g[g.length-1]);if(h>=2){const b=parseFloat(g[g.length-2]);isFinite(b)&&(w*=Math.sign(b),w+=Rn(b))}if(!isFinite(_))this.sign=g[0]==="-"?-1:1,this.layer=h,this.mag=w;else if(h===1)this.sign=Math.sign(_),this.layer=1,this.mag=w+Math.log10(Math.abs(_));else if(this.sign=Math.sign(_),this.layer=h,h===2){const b=v.mul(ee(1,2,w),k(_));return this.sign=b.sign,this.layer=b.layer,this.mag=b.mag,v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}else this.mag=w;return this.normalize(),v.fromStringCache.maxSize>=1&&v.fromStringCache.set(t,v.fromDecimal(this)),this}fromValue(e){return e instanceof v?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:It(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:It(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=oi?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):It(this.m,e)+"e"+It(this.e,e):this.layer===1?It(this.m,e)+"e"+It(this.e,e):this.layer<=oi?(this.sign===-1?"-":"")+"e".repeat(this.layer)+It(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+It(this.mag,e)}abs(){return ie(this.sign===0?0:1,this.layer,this.mag)}neg(){return ie(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?v.dZero:this.layer===0?ee(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?v.dZero:this.layer===0?ee(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?v.dZero:this.layer===0?ee(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?v.dZero:this.layer===0?ee(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=k(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return ie(0,0,0);let n,i;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(v.cmpabs(this,t)>0?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return v.fromNumber(n.sign*n.mag+i.sign*i.mag);const a=n.layer*Math.sign(n.mag),r=i.layer*Math.sign(i.mag);if(a-r>=2)return n;if(a===0&&r===-1){if(Math.abs(i.mag-Math.log10(n.mag))>qn)return n;{const l=Math.pow(10,Math.log10(n.mag)-i.mag),o=i.sign+n.sign*l;return ee(Math.sign(o),1,i.mag+Math.log10(Math.abs(o)))}}if(a===1&&r===0){if(Math.abs(n.mag-Math.log10(i.mag))>qn)return n;{const l=Math.pow(10,n.mag-Math.log10(i.mag)),o=i.sign+n.sign*l;return ee(Math.sign(o),1,Math.log10(i.mag)+Math.log10(Math.abs(o)))}}if(Math.abs(n.mag-i.mag)>qn)return n;{const l=Math.pow(10,n.mag-i.mag),o=i.sign+n.sign*l;return ee(Math.sign(o),1,i.mag+Math.log10(Math.abs(o)))}}plus(e){return this.add(e)}sub(e){return this.add(k(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=k(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return ie(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return ie(this.sign*t.sign,0,1);let n,i;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return v.fromNumber(n.sign*i.sign*n.mag*i.mag);if(n.layer>=3||n.layer-i.layer>=2)return ee(n.sign*i.sign,n.layer,n.mag);if(n.layer===1&&i.layer===0)return ee(n.sign*i.sign,1,n.mag+Math.log10(i.mag));if(n.layer===1&&i.layer===1)return ee(n.sign*i.sign,1,n.mag+i.mag);if(n.layer===2&&i.layer===1){const a=ee(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(ee(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return ee(n.sign*i.sign,a.layer+1,a.sign*a.mag)}if(n.layer===2&&i.layer===2){const a=ee(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(ee(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return ee(n.sign*i.sign,a.layer+1,a.sign*a.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=k(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?v.dNaN:this.layer===0?ee(this.sign,0,1/this.mag):ee(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=k(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=k(e),n=this.mag>0?this.layer:-this.layer,i=t.mag>0?t.layer:-t.layer;return n>i?1:n<i?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=k(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=k(e);return this.lt(t)?t:this}min(e){const t=k(e);return this.gt(t)?t:this}maxabs(e){const t=k(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=k(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=k(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=k(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let i=this.mag,a=n.mag;return this.layer>n.layer&&(a=Rn(a)),this.layer<n.layer&&(i=Rn(i)),Math.abs(i-a)<=t*Math.max(Math.abs(i),Math.abs(a))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=k(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=k(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=k(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=k(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(v.dZero)?v.dZero:this.log10()}absLog10(){return this.sign===0?v.dNaN:this.layer>0?ee(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):ee(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?v.dNaN:this.layer>0?ee(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):ee(this.sign,0,Math.log10(this.mag))}log(e){return e=k(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?v.dNaN:this.layer===0&&e.layer===0?ee(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):v.div(this.log10(),e.log10())}log2(){return this.sign<=0?v.dNaN:this.layer===0?ee(this.sign,0,Math.log2(this.mag)):this.layer===1?ee(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?ee(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):ee(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?v.dNaN:this.layer===0?ee(this.sign,0,Math.log(this.mag)):this.layer===1?ee(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?ee(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):ee(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=k(e),n=this,i=t;if(n.sign===0)return i.eq(0)?ie(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(i.sign===0)return ie(1,0,1);if(i.sign===1&&i.layer===0&&i.mag===1)return n;const a=n.absLog10().mul(i).pow10();return this.sign===-1?Math.abs(i.toNumber()%2)%2===1?a.neg():Math.abs(i.toNumber()%2)%2===0?a:v.dNaN:a}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return v.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return ee(1,0,t);if(e.sign===0)return v.dOne;e=ie(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?ee(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?ee(-e.sign,e.layer+1,-e.mag):v.dOne}pow_base(e){return k(e).pow(this)}root(e){const t=k(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?v.exp(v.mul(this,v.ln(this).sub(1))):v.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(ie(1,0,24)))return v.fromNumber(ar(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let i=e,a=12*i,r=1/a,l=t+r;if(l===t||(t=l,i=i*n,a=360*i,r=1/a,l=t-r,l===t))return v.exp(t);t=l,i=i*n,a=1260*i;let o=1/a;return t=t+o,i=i*n,a=1680*i,o=1/a,t=t-o,v.exp(t)}else return this.layer===1?v.exp(v.mul(this,v.ln(this).sub(1))):v.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?v.dOne:this.layer===0&&this.mag<=709.7?v.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?ee(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?ee(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):ee(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return v.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return ee(1,2,Math.log10(this.mag)-.3010299956639812);{const e=v.div(ie(this.sign,this.layer-1,this.mag),ie(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=ie(1,0,1)){if(e===1)return v.pow(this,t);if(e===0)return new v(t);if(this.eq(v.dOne))return v.dOne;if(this.eq(-1))return v.pow(this,t);if(e===Number.POSITIVE_INFINITY){const a=this.toNumber();if(a<=1.444667861009766&&a>=.06598803584531254){if(a>1.444667861009099)return v.fromNumber(Math.E);const r=v.ln(this).neg();return r.lambertw().div(r)}else return a>1.444667861009766?v.fromNumber(Number.POSITIVE_INFINITY):v.dNaN}if(this.eq(v.dZero)){let a=Math.abs((e+1)%2);return a>1&&(a=2-a),v.fromNumber(a)}if(e<0)return v.iteratedlog(t,this,-e);t=k(t);const n=e;e=Math.trunc(e);const i=n-e;if(this.gt(v.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let a=0;a<e;++a){const r=t;if(t=this.pow(t),r.eq(t))return t}if(i!=0){const a=this.pow(t);return t.mul(1-i).add(a.mul(i))}return t}i!==0&&(t.eq(v.dOne)?this.gt(10)?t=this.pow(i):(t=v.fromNumber(v.tetrate_critical(this.toNumber(),i)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let a=0;a<e;++a){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return ie(t.sign,t.layer+(e-a-1),t.mag);if(a>1e4)return t}return t}iteratedexp(e=2,t=ie(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return v.tetrate(e,-t,this);e=k(e);let n=v.fromDecimal(this);const i=t;t=Math.trunc(t);const a=i-t;if(n.layer-e.layer>3){const r=Math.min(t,n.layer-e.layer-3);t-=r,n.layer-=r}for(let r=0;r<t;++r){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(r>1e4)return n}return a>0&&a<1&&(e.eq(10)?n=n.layeradd10(-a):n=n.layeradd(-a,e)),n}slog(e=10,t=100){let n=.001,i=!1,a=!1,r=this.slog_internal(e).toNumber();for(let l=1;l<t;++l){const u=new v(e).tetrate(r).gt(this);if(l>1&&a!=u&&(i=!0),a=u,i?n/=2:n*=2,n=Math.abs(n)*(u?-1:1),r+=n,n===0)break}return v.fromNumber(r)}slog_internal(e=10){if(e=k(e),e.lte(v.dZero)||e.eq(v.dOne))return v.dNaN;if(e.lt(v.dOne))return this.eq(v.dOne)?v.dZero:this.eq(v.dZero)?v.dNegOne:v.dNaN;if(this.mag<0||this.eq(v.dZero))return v.dNegOne;let t=0,n=v.fromDecimal(this);if(n.layer-e.layer>3){const i=n.layer-e.layer-3;t+=i,n.layer-=i}for(let i=0;i<100;++i)if(n.lt(v.dZero))n=v.pow(e,n),t-=1;else{if(n.lte(v.dOne))return v.fromNumber(t+v.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=v.log(n,e)}return v.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:v.critical_section(e,t,ir)}static tetrate_critical(e,t){return v.critical_section(e,t,nr)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let i=0,a=0;for(let l=0;l<Bt.length;++l)if(Bt[l]==e){i=n[l][Math.floor(t)],a=n[l][Math.ceil(t)];break}else if(Bt[l]<e&&Bt[l+1]>e){const o=(e-Bt[l])/(Bt[l+1]-Bt[l]);i=n[l][Math.floor(t)]*(1-o)+n[l+1][Math.floor(t)]*o,a=n[l][Math.ceil(t)]*(1-o)+n[l+1][Math.ceil(t)]*o;break}const r=t-Math.floor(t);return i<=0||a<=0?i*(1-r)+a*r:Math.pow(e,Math.log(i)/Math.log(e)*(1-r)+Math.log(a)/Math.log(e)*r)}layeradd10(e){e=v.fromValue_noAlloc(e).toNumber();const t=v.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let i=0;i<100;++i){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const i=this.slog(t).toNumber()+e;return i>=0?v.tetrate(t,i):Number.isFinite(i)?i>=-1?v.log(v.tetrate(t,i+1),t):v.log(v.log(v.tetrate(t,i+2),t),t):v.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return v.fromNumber(li(this.toNumber()));if(this.layer===0)return v.fromNumber(li(this.sign*this.mag));if(this.layer===1)return ui(this);if(this.layer===2)return ui(this);if(this.layer>=3)return ie(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return ie(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=ie(1,0,1)){t=k(t);const n=e;e=Math.trunc(e);const i=n-e;i!==0&&(t.eq(v.dOne)?(++e,t=v.fromNumber(i)):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let a=0;a<e;++a){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(a>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.sin(this.sign*this.mag)):ie(0,0,0)}cos(){return this.mag<0?v.dOne:this.layer===0?v.fromNumber(Math.cos(this.sign*this.mag)):ie(0,0,0)}tan(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.tan(this.sign*this.mag)):ie(0,0,0)}asin(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.asin(this.sign*this.mag)):ie(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?v.fromNumber(Math.acos(this.toNumber())):this.layer===0?v.fromNumber(Math.acos(this.sign*this.mag)):ie(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?v.fromNumber(Math.atan(this.sign*this.mag)):v.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return v.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return v.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?ie(Number.NaN,Number.NaN,Number.NaN):v.ln(this.add(1).div(v.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(v.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let c=v;c.fromStringCache=new Ha(er);c.dZero=ie(0,0,0);c.dOne=ie(1,0,1);c.dNegOne=ie(-1,0,1);c.dTwo=ie(1,0,2);c.dTen=ie(1,0,10);c.dNaN=ie(Number.NaN,Number.NaN,Number.NaN);c.dInf=ie(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);c.dNegInf=ie(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);c.dNumberMax=ee(1,0,Number.MAX_VALUE);c.dNumberMin=ee(1,0,Number.MIN_VALUE);k=c.fromValue_noAlloc;ee=c.fromComponents;ie=c.fromComponents_noNormalize;c.fromMantissaExponent;c.fromMantissaExponent_noNormalize;const rr=new c(1);function on(e,t,n=!0){let i=c.log10(e).floor(),a=c.div(e,c.pow(10,i));a.toStringWithDecimalPlaces(t)==="10"&&(a=rr,i=i.add(1));const r=i.gte(1e9)?lt(i,Math.max(Math.max(t,3),le.defaultDecimalsShown)):i.gte(1e4)?$n(i,0):i.toStringWithDecimalPlaces(0);return n?a.toStringWithDecimalPlaces(t)+"e"+r:"e"+r}function $n(e,t){if(e==null)return"NaN";if(e=new c(e),e.mag<.001)return 0 .toFixed(t);const i=e.toStringWithDecimalPlaces(t).split(".");return i[0]=i[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),i.length==1?i[0]:i[0]+"."+i[1]}function bi(e,t){return e==null?"NaN":(e=new c(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),le.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const sr=new c("eeee1000"),or=new c("e100000"),ci=new c("e1000"),yi=new c(1e9),lr=new c(1e6),ur=new c(1e3),cr=new c(.98),dr=new c(.001),_i=new c(0);function lt(e,t,n){if(t==null&&(t=le.defaultDecimalsShown),n=n!=null?n:le.defaultShowSmall,e=new c(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+lt(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(sr)){const i=e.slog();return i.gte(lr)?"F"+lt(i.floor()):c.pow(10,i.sub(i.floor())).toStringWithDecimalPlaces(3)+"F"+$n(i.floor(),0)}else{if(e.gte(or))return on(e,0,!1);if(e.gte(ci))return on(e,0);if(e.gte(yi))return on(e,t);if(e.gte(ur))return $n(e,0);if(e.gte(dr)||!n)return bi(e,t);if(e.eq(_i))return 0 .toFixed(t)}return e=Ci(e),e.lt(ci)?on(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):lt(e,t)+"\u207B\xB9"}function ue(e){return e=new c(e),e.sign<0?"-"+ue(e.neg()):e.gte(yi)||e.lte(cr)&&!e.eq(_i)?lt(e):lt(e,0)}function wi(e){return c.lt(e,0)?"-"+wi(c.neg(e)):c.gt(e,2**51)?lt(c.div(e,31536e3))+"y":(e=new c(e).toNumber(),e<60?lt(e)+"s":e<3600?ue(Math.floor(e/60))+"m "+lt(e%60)+"s":e<86400?ue(Math.floor(e/3600))+"h "+ue(Math.floor(e/60)%60)+"m "+ue(e%60)+"s":e<31536e3?ue(Math.floor(e/84600)%365)+"d "+ue(Math.floor(e/3600)%24)+"h "+ue(Math.floor(e/60)%60)+"m":ue(Math.floor(e/31536e3))+"y "+ue(Math.floor(e/84600)%365)+"d "+ue(Math.floor(e/3600)%24)+"h")}function fr(e,t,n){e=new c(e);let i=e.toStringWithDecimalPlaces(t);return new c(i).gte(n)&&(i=c.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),i}function gr(e,t){return lt(e,t,!0)}function Ci(e){let t=c.log10(e).ceil();const n=c.div(e,c.pow(10,t));return t=t.neg(),e=new c(10).pow(t).times(n),e}var mr=Object.freeze(Object.defineProperty({__proto__:null,default:c,exponentialFormat:on,commaFormat:$n,regularFormat:bi,format:lt,formatWhole:ue,formatTime:wi,toPlaces:fr,formatSmall:gr,invertOOM:Ci},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:pr,commaFormat:vr,regularFormat:hr,format:Re,formatWhole:_e,formatTime:Gt,toPlaces:br,formatSmall:yr,invertOOM:_r}=mr;window.Decimal=c;window.exponentialFormat=pr;window.commaFormat=vr;window.regularFormat=hr;window.format=Re;window.formatWhole=_e;window.formatTime=Gt;window.toPlaces=br;window.formatSmall=yr;window.invertOOM=_r;function wr(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function Tn(e){return typeof e=="function"}var q=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(q||{});const gn=Symbol("DoNotCache");function B(e,t){const n=e[t];Tn(n)&&n.length===0&&!n[gn]?e[t]=F(n.bind(e)):Tn(n)&&(e[t]=n.bind(e),e[t][gn]=!0)}function cn(e){return Tn(e)&&!e[gn]&&(e=F(e)),e}const pn=Symbol("Component"),vn=Symbol("GatherProps");let Cr=0;function Xn(e="feature-"){return e+Cr++}var mt=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(mt||{});function nn(e){const t=f(e);return t!==2&&t!==!1}function Ni(e){return f(e)===1}function we(e){return e[gn]=!0,e}function Ce(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function Nr(e,...t){const n=[],i=a=>{Object.keys(a).forEach(r=>{const l=a[r];l!=null&&typeof l=="object"&&(t.includes(l.type)?n.push(l):!(l instanceof c)&&!Qe(l)&&i(l))})};return i(e),n}var Te=window.state=Wn({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:en([])});const Lt={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var Jn=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(Jn||{}),ct={classic:Lt,paper:{...Lt,variables:{...Lt.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...Lt,variables:{...Lt.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...Lt,variables:{...Lt.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const We=pi();"fonts"in document&&(document.fonts.onloadingdone=()=>We.emit("fontsLoaded"));var kr=Object.freeze(Object.defineProperty({__proto__:null,globalBus:We},Symbol.toStringTag,{value:"Module"}));function ki(e={}){return Object.assign({id:`${le.id}-0`,name:"Default Save",tabs:le.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:le.id,modVersion:le.versionNumber,layers:{}},e)}function it(e){const t=wt.compressToUTF16(Yn(e!=null?e:U));return localStorage.setItem((e!=null?e:U).id,t),t}async function xr(){Mr();try{let e=localStorage.getItem(be.active);if(e==null){await jt(Zt());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=wt.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==le.id){await jt(Zt());return}t.id=be.active,await jt(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await jt(Zt())}}function Zt(){const e=Sn(),t=ki({id:e});return it(t),be.saves.push(e),t}function Sn(){let e,t=0;do e=`${le.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const xi=V(!1);async function jt(e){console.info("Loading save",e),xi.value=!0;const{layers:t,removeLayer:n,addLayer:i}=await fn(()=>Promise.resolve().then(function(){return xo}),void 0),{fixOldSave:a,getInitialLayers:r}=await fn(()=>Promise.resolve().then(function(){return Uc}),void 0);for(const l in t){const o=t[l];o&&n(o)}r(e).forEach(l=>i(l,e)),e=ki(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,le.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==le.versionNumber&&(a(e.modVersion,e),e.modVersion=le.versionNumber),Object.assign(U,e),be.active=U.id,We.emit("onLoad")}setInterval(()=>{U.autosave&&it()},1e3);window.onbeforeunload=()=>{U.autosave&&it()};window.save=it;const Sr=window.hardReset=async()=>{await jt(Zt())};window.deleteLowerSaves=()=>{const e=Object.values(be.saves).indexOf(U.id)+1;Object.values(be.saves).slice(e).forEach(t=>localStorage.removeItem(t)),be.saves=be.saves.slice(0,e)};const mn=en({active:"",saves:[],showTPS:!0,theme:Jn.Nordic,unthrottled:!1,alignUnits:!1});gt(mn,e=>{const t=wt.compressToUTF16(JSON.stringify(e));localStorage.setItem(le.id,t)},{deep:!0});var be=window.settings=mn;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:Jn.Nordic,alignUnits:!1};We.emit("loadSettings",e),Object.assign(mn,e),Sr()};function Mr(){try{let e=localStorage.getItem(le.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=wt.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(mn,t)}We.emit("loadSettings",mn)}catch{}}const Ir=en([]),$r=en([]),Tr=en([]),Pr={class:"table"};se({__name:"Column",setup(e){const t=F(()=>ct[be.theme].mergeAdjacent);return(n,i)=>(x(),M("div",Pr,[m("div",{class:Pe(["col",{mergeAdjacent:t.value}])},[Ct(n.$slots,"default")],2)]))}});const Fr={class:"table"};se({__name:"Row",setup(e){const t=F(()=>ct[be.theme].mergeAdjacent);return(n,i)=>(x(),M("div",Fr,[m("div",{class:Pe(["row",{mergeAdjacent:t.value}])},[Ct(n.$slots,"default")],2)]))}});function Ge(e,t="span"){return typeof e=="function"?se({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),se({template:e})):se({render:()=>({})}):e}function dt(e){if(An(e))return typeof e=="function"?e():Ge(e);const t=e[pn];return s(t,e[vn](),null)}function Er(e){if(An(e))return typeof e=="function"?e():typeof e=="string"?s(W,null,[e]):s(e,null,null);const t=e[pn];return s(t,e[vn](),null)}function di(e,t){return e.reduce((n,i)=>s(W,null,[n,t,i]))}function An(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[gn]===!0}function Dr(e,t){const n=V(null),i=V(void 0);function a(o){n.value||(n.value=setInterval(l,250)),i.value=o}function r(){n.value&&(clearInterval(n.value),n.value=null)}function l(){t&&t.value?t.value():e&&e.value&&e.value(i.value)}return mi(r),{start:a,stop:r,handleHolding:l}}function Or(e,t="div"){const n=tn();return Dn(()=>{n.value=Ge(ot(e),t)}),n}function hn(e,t="div"){const n=tn(null);return Dn(()=>{const i=ot(e);n.value=i==""||i==null?null:Ge(i,t)}),n}function ot(e){return f(f(e))}function fe(...e){return e.includes(Object)||e.push(Object),e}const Ar=se({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var h;const n=V({}),i=new ResizeObserver(o),a=V(null);Gn(()=>{const p=a.value;p!=null&&i.observe(p)});let r=!0,l=V((h=a.value)==null?void 0:h.getBoundingClientRect());function o(){r&&(r=!1,Kt(()=>{var p;l.value=(p=a.value)==null?void 0:p.getBoundingClientRect(),Object.values(n.value).filter(_=>_).forEach(_=>_.rect=_.element.getBoundingClientRect()),t("updateNodes",n.value),r=!0}))}We.on("fontsLoaded",o);const u={attributes:!1,childList:!0,subtree:!1};kn(Kn,(p,_)=>{const w=new MutationObserver(()=>g(p));w.observe(_,u),n.value[p]={element:_,observer:w,rect:_.getBoundingClientRect()},o()}),kn(Qn,p=>{var _;(_=n.value[p])==null||_.observer.disconnect(),n.value[p]=void 0,o()}),kn(Ii,n),kn($i,l);function g(p){const _=n.value[p];_!=null&&(_.rect=_.element.getBoundingClientRect(),t("updateNodes",n.value))}return(p,_)=>(x(),M(W,null,[Ct(p.$slots,"default",{},void 0,!0),m("div",{ref_key:"resizeListener",ref:a,class:"resize-listener"},null,512)],64))}});var Si=ke(Ar,[["__scopeId","data-v-2b1dc1bc"]]);const Vr=["onPointerdown"],Br={class:"modal-wrapper"},Lr={class:"modal-container"},qr={class:"modal-header"},Rr={class:"modal-body"},zr={class:"modal-footer"},jr=m("div",{style:{"flex-grow":"1"}},null,-1),pt=se({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const a=Ze(e),r=F(()=>f(a.modelValue)||o.value);function l(){n("update:modelValue",!1)}const o=V(!1),u=V(null),g=F(()=>{var h,p;return(p=(h=u.value)==null?void 0:h.nodes)!=null?p:null});return t({isOpen:r,nodes:g}),(h,p)=>(x(),re(Hi,{to:"#modal-root"},[s(dn,{name:"modal",onBeforeEnter:p[0]||(p[0]=_=>o.value=!0),onAfterLeave:p[1]||(p[1]=_=>o.value=!1)},{default:X(()=>[Hn(m("div",Ht({class:"modal-mask",onPointerdown:Jt(l,["self"])},h.$attrs),[m("div",Br,[m("div",Lr,[m("div",qr,[Ct(h.$slots,"header",{shown:r.value},()=>[y(" default header ")])]),m("div",Rr,[s(Si,{ref_key:"contextRef",ref:u},{default:X(()=>[Ct(h.$slots,"body",{shown:r.value},()=>[y(" default body ")])]),_:3},512)]),m("div",zr,[Ct(h.$slots,"footer",{shown:r.value},()=>[m("div",{style:{display:"flex","text-align":"center","--layer-color":"#dadafa"}},[jr,m("button",{class:"feature can",onClick:l}," Back ")])])])])])],16,Vr),[[Wi,h.modelValue]])]),_:3})]))}}),$t=Symbol("ProxyState");function an(e,t={}){const n=t;let i=!1,a=!1;function r(){return i||(a&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),a=!0,Object.assign(n,e.call(n,n)),i=!0),n}return new Proxy(n,{get(l,o){if(o===$t)return r();const u=r()[o];return u!=null&&typeof u=="object"&&ft in u?u[ft]:u},set(l,o,u){return r()[o]=u,!0},has(l,o){return o===$t?!0:Reflect.has(r(),o)},ownKeys(){return Reflect.ownKeys(r())},getOwnPropertyDescriptor(l,o){return i||(Object.assign(n,e.call(n,n)),i=!0),Object.getOwnPropertyDescriptor(l,o)}})}const Mi=c.ln(10);function ln(e){return e}function Ur(e,t){return P(t)?t.invert(c.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function Gr(e,t){return P(t)?t.isIntegrable()?d.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Wr(e){return d.neg(e)}function Hr(e,t,n){return P(t)?t.invert(c.sub(e,Fe(n))):P(n)?n.invert(c.sub(e,Fe(t))):(console.error("Could not invert due to no input being a variable"),0)}function Yr(e,t,n){var i,a;if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const r=t.getIntegralFormula(e);return d.times(n,(i=t.innermostVariable)!=null?i:0).add(r)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const r=n.getIntegralFormula(e);return d.times(t,(a=n.innermostVariable)!=null?a:0).add(r)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Zr(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.add(i,n)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.add(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Xr(e,t,n){return P(t)?t.invert(c.add(e,Fe(n))):P(n)?n.invert(c.sub(Fe(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Jr(e,t,n){var i,a;if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const r=t.getIntegralFormula(e);return d.sub(r,d.times(n,(i=t.innermostVariable)!=null?i:0))}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const r=n.getIntegralFormula(e);return d.times(t,(a=n.innermostVariable)!=null?a:0).sub(r)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Kr(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.sub(i,n)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.sub(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Qr(e,t,n){return P(t)?t.invert(c.div(e,Fe(n))):P(n)?n.invert(c.div(e,Fe(t))):(console.error("Could not invert due to no input being a variable"),0)}function es(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.times(i,n)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.times(i,t)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ts(e,t,n){return P(t)?d.div(e,n):P(n)?d.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function ns(e,t,n){return P(t)?t.invert(c.mul(e,Fe(n))):P(n)?n.invert(c.div(Fe(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function is(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.div(i,n)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.div(t,i)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function as(e,t,n){return P(t)?d.mul(e,n):P(n)?d.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),d.constant(0))}function rs(e,t){return P(t)?t.invert(c.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function ss(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.ln(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function os(e,t){return P(t)?t.invert(c.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function ls(e){return c.ln(e).sub(1).times(e).div(Mi)}function us(e,t){if(P(t)){const n=Mi.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function cs(e,t){return P(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:ls,invert:us}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function ds(e,t,n){return P(t)?t.invert(c.pow(Fe(n),e)):P(n)?n.invert(c.root(Fe(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function fs(e,t){return c.ln(e).sub(1).times(e).div(c.ln(t))}function gs(e,t,n){if(P(t)){const i=c.ln(Fe(n)).times(e);return t.invert(i.div(i.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function ms(e,t,n){return P(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e),n],evaluate:fs,invert:gs}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function ps(e,t){return P(t)?t.invert(c.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function vs(e){return c.ln(e).sub(1).times(e).div(c.ln(2))}function hs(e,t){if(P(t)){const n=c.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function bs(e,t){return P(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:vs,invert:hs}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function ys(e,t){return P(t)?t.invert(c.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function _s(e){return c.ln(e).sub(1).times(e)}function ws(e,t){return P(t)?t.invert(c.div(e,c.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Cs(e,t){return P(t)?t.isIntegrable()?new d({inputs:[t.getIntegralFormula(e)],evaluate:_s,invert:ws}):(console.error("Could not integrate due to variable not being integrable"),d.constant(0)):(console.error("Could not integrate due to no input being a variable"),d.constant(0))}function Ns(e,t,n){return P(t)?t.invert(c.root(e,Fe(n))):P(n)?n.invert(c.ln(e).div(c.ln(Fe(t)))):(console.error("Could not invert due to no input being a variable"),0)}function ks(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e),a=d.add(n,1);return d.pow(i,a).div(a)}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e);return d.pow(t,i).div(d.ln(t))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function xs(e,t){return P(t)?t.invert(c.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function Ss(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.pow10(n).div(d.ln(10))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ms(e,t,n){return P(t)?t.invert(c.ln(e).div(c.ln(Fe(n)))):P(n)?n.invert(c.root(Fe(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Is(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(n,i).div(d.ln(n))}else if(P(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=n.getIntegralFormula(e),a=d.add(t,1);return d.pow(i,a).div(a)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function $s(e,t,n){return P(t)?t.invert(c.root(e,c.recip(Fe(n)))):P(n)?n.invert(c.ln(Fe(t)).div(c.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function Ts(e,t,n){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const i=t.getIntegralFormula(e);return d.pow(i,d.recip(n).add(1)).times(n).div(d.add(n,1))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Ps(e,t){return P(t)?t.invert(c.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function Fs(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.exp(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Es(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.tetrate(e,i,n)}function Ds(e,t,n,i){return P(t)?t.invert(c.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function Os(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){const i=c.minabs(t,1e308).toNumber();return c.iteratedexp(e,i,new c(n))}function As(e,t,n,i){return P(t)?t.invert(c.iteratedlog(e,Math.E,c.minabs(1e308,Fe(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function Vs(e,t=10,n=2){const i=c.minabs(n,1e308).toNumber();return c.iteratedlog(e,t,i)}function Bs(e,t=10){const n=c.minabs(t,1e308).toNumber();return c.slog(e,n)}function Ls(e,t,n){return P(t)?t.invert(c.tetrate(e,c.minabs(1e308,Fe(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function qs(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.layeradd(e,i,n)}function Rs(e,t,n,i){return P(t)?t.invert(c.layeradd(e,c.minabs(1e308,Fe(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function zs(e,t){return P(t)?t.invert(c.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function js(e,t){return P(t)?t.invert(c.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function Us(e,t,n){const i=c.minabs(t,1e308).toNumber();return c.pentate(e,i,n)}function Gs(e,t){return P(t)?t.invert(c.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ws(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Hs(e,t){return P(t)?t.invert(c.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ys(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sin(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Zs(e,t){return P(t)?t.invert(c.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Xs(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Js(e,t){return P(t)?t.invert(c.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ks(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asin(n).times(n).add(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function Qs(e,t){return P(t)?t.invert(c.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function eo(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acos(n).times(n).sub(d.sqrt(d.sub(1,d.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function to(e,t){return P(t)?t.invert(c.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function no(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atan(n).times(n).sub(d.ln(d.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function io(e,t){return P(t)?t.invert(c.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function ro(e,t){return P(t)?t.invert(c.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function so(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.sinh(n)}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function oo(e,t){return P(t)?t.invert(c.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function lo(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function uo(e,t){return P(t)?t.invert(c.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function co(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.asinh(n).times(n).sub(d.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function fo(e,t){return P(t)?t.invert(c.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function go(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.acosh(n).times(n).sub(d.add(n,1).sqrt().times(d.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function mo(e,t){return P(t)?t.invert(c.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function po(e,t){if(P(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),d.constant(0);const n=t.getIntegralFormula(e);return d.atanh(n).times(n).add(d.sub(1,d.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),d.constant(0)}function rn(e){return(t,n)=>new d({inputs:[t,n],evaluate:e,invert:ln})}function P(e){return e instanceof Ie&&e.hasVariable()}function Fe(e,t){return e instanceof Ie?e.evaluate(t):f(e)}function vo(){return d.pow(this,2).div(2)}function ho(){return this}const De=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&ft in n?n[ft]:n)),"variable"in e?(typeof e.variable=="object"&&ft in e.variable&&(e.variable=e.variable[ft]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:vo,internalIntegrateInner:ho,applySubstitution:ln}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var _,w;const{inputs:t,evaluate:n,invert:i,integrate:a,integrateInner:r,applySubstitution:l}=e,o=t.reduce((b,C)=>b+(C instanceof De?C.internalVariables:0),0),u=t.find(b=>b instanceof De&&b.hasVariable()),g=o===1?u==null?void 0:u.innermostVariable:void 0,h=(_=u==null?void 0:u.isInvertible())!=null?_:!1,p=(w=u==null?void 0:u.isIntegrable())!=null?w:!1;return{inputs:t,internalEvaluate:n,internalInvert:h?i:void 0,internalIntegrate:p?a:void 0,internalIntegrateInner:r,applySubstitution:l,innermostVariable:g,internalVariables:o}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,i;return(i=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(a=>Fe(a,e))))!=null?n:this.hasVariable()?e:null)!=null?i:Fe(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof De&&e.inputs[n]instanceof De?t.equals(e.inputs[n]):!(t instanceof De)&&!(e.inputs[n]instanceof De)&&c.eq(f(t),f(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new d({inputs:[e]})}static variable(e){return new d({variable:e})}static step(e,t,n){const i=n(d.variable(0)),a=cn(t);function r(o){return c.lt(o,f(a))?o:c.add(i.evaluate(c.sub(o,f(a))),f(a))}function l(o,u){return P(u)&&i.isInvertible()?(c.gt(o,f(a))&&(o=c.add(i.invert(c.sub(o,f(a))),f(a))),u.invert(o)):(console.error("Could not invert due to no input being a variable"),0)}return new d({inputs:[e],evaluate:r,invert:i.isInvertible()&&i.hasVariable()?l:void 0})}static if(e,t,n,i){const a=V(0),r=d.variable(a),l=n(r),o=i==null?void 0:i(r),u=cn(t);function g(p){return f(u)?(a.value=p,l.evaluate()):o?(a.value=p,o.evaluate()):p}function h(p,_){return!P(_)||!l.isInvertible()||o!=null&&!o.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):f(u)?_.invert(l.invert(p)):o?_.invert(o.invert(p)):_.invert(p)}return new d({inputs:[e],evaluate:g,invert:l.isInvertible()&&l.hasVariable()?h:void 0})}static conditional(e,t,n,i){return d.if(e,t,n,i)}static abs(e){return new d({inputs:[e],evaluate:c.abs})}static neg(e){return new d({inputs:[e],evaluate:c.neg,invert:Ur,applySubstitution:Wr,integrate:Gr})}static sign(e){return new d({inputs:[e],evaluate:c.sign})}static round(e){return new d({inputs:[e],evaluate:c.round})}static floor(e){return new d({inputs:[e],evaluate:c.floor})}static ceil(e){return new d({inputs:[e],evaluate:c.ceil})}static trunc(e){return new d({inputs:[e],evaluate:c.trunc})}static add(e,t){return new d({inputs:[e,t],evaluate:c.add,invert:Hr,integrate:Yr,integrateInner:Zr,applySubstitution:ln})}static sub(e,t){return new d({inputs:[e,t],evaluate:c.sub,invert:Xr,integrate:Jr,integrateInner:Kr,applySubstitution:ln})}static mul(e,t){return new d({inputs:[e,t],evaluate:c.mul,invert:Qr,integrate:es,applySubstitution:ts})}static div(e,t){return new d({inputs:[e,t],evaluate:c.div,invert:ns,integrate:is,applySubstitution:as})}static recip(e){return new d({inputs:[e],evaluate:c.recip,invert:rs,integrate:ss})}static clamp(e,t,n){return new d({inputs:[e,t,n],evaluate:c.clamp,invert:ln})}static pLog10(e){return new d({inputs:[e],evaluate:c.pLog10})}static absLog10(e){return new d({inputs:[e],evaluate:c.absLog10})}static log10(e){return new d({inputs:[e],evaluate:c.log10,invert:os,integrate:cs})}static log(e,t){return new d({inputs:[e,t],evaluate:c.log,invert:ds,integrate:ms})}static log2(e){return new d({inputs:[e],evaluate:c.log2,invert:ps,integrate:bs})}static ln(e){return new d({inputs:[e],evaluate:c.ln,invert:ys,integrate:Cs})}static pow(e,t){return new d({inputs:[e,t],evaluate:c.pow,invert:Ns,integrate:ks})}static pow10(e){return new d({inputs:[e],evaluate:c.pow10,invert:xs,integrate:Ss})}static pow_base(e,t){return new d({inputs:[e,t],evaluate:c.pow_base,invert:Ms,integrate:Is})}static root(e,t){return new d({inputs:[e,t],evaluate:c.root,invert:$s,integrate:Ts})}static factorial(e){return new d({inputs:[e],evaluate:c.factorial})}static gamma(e){return new d({inputs:[e],evaluate:c.gamma})}static lngamma(e){return new d({inputs:[e],evaluate:c.lngamma})}static exp(e){return new d({inputs:[e],evaluate:c.exp,invert:Ps,integrate:Fs})}static sqr(e){return d.pow(e,2)}static sqrt(e){return d.root(e,2)}static cube(e){return d.pow(e,3)}static cbrt(e){return d.root(e,3)}static tetrate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:Es,invert:Ds})}static iteratedexp(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:Os,invert:As})}static iteratedlog(e,t=10,n=1){return new d({inputs:[e,t,n],evaluate:Vs})}static slog(e,t=10){return new d({inputs:[e,t],evaluate:Bs,invert:Ls})}static layeradd10(e,t){return new d({inputs:[e,t],evaluate:c.layeradd10})}static layeradd(e,t,n=10){return new d({inputs:[e,t,n],evaluate:qs,invert:Rs})}static lambertw(e){return new d({inputs:[e],evaluate:c.lambertw,invert:zs})}static ssqrt(e){return new d({inputs:[e],evaluate:c.ssqrt,invert:js})}static pentate(e,t=2,n=c.fromComponents_noNormalize(1,0,1)){return new d({inputs:[e,t,n],evaluate:Us})}static sin(e){return new d({inputs:[e],evaluate:c.sin,invert:Js,integrate:Ws})}static cos(e){return new d({inputs:[e],evaluate:c.cos,invert:Qs,integrate:Ys})}static tan(e){return new d({inputs:[e],evaluate:c.tan,invert:to,integrate:Xs})}static asin(e){return new d({inputs:[e],evaluate:c.asin,invert:Gs,integrate:Ks})}static acos(e){return new d({inputs:[e],evaluate:c.acos,invert:Hs,integrate:eo})}static atan(e){return new d({inputs:[e],evaluate:c.atan,invert:Zs,integrate:no})}static sinh(e){return new d({inputs:[e],evaluate:c.sinh,invert:uo,integrate:ao})}static cosh(e){return new d({inputs:[e],evaluate:c.cosh,invert:fo,integrate:so})}static tanh(e){return new d({inputs:[e],evaluate:c.tanh,invert:mo,integrate:lo})}static asinh(e){return new d({inputs:[e],evaluate:c.asinh,invert:io,integrate:co})}static acosh(e){return new d({inputs:[e],evaluate:c.acosh,invert:ro,integrate:go})}static atanh(e){return new d({inputs:[e],evaluate:c.atanh,invert:oo,integrate:po})}step(e,t){return d.step(this,e,t)}if(e,t){return d.if(this,e,t)}conditional(e,t){return d.if(this,e,t)}abs(){return d.abs(this)}neg(){return d.neg(this)}sign(){return d.sign(this)}round(){return d.round(this)}floor(){return d.floor(this)}ceil(){return d.ceil(this)}trunc(){return d.trunc(this)}add(e){return d.add(this,e)}sub(e){return d.sub(this,e)}mul(e){return d.mul(this,e)}div(e){return d.div(this,e)}recip(){return d.recip(this)}max(e){return d.max(this,e)}min(e){return d.min(this,e)}maxabs(e){return d.maxabs(this,e)}minabs(e){return d.minabs(this,e)}clamp(e,t){return d.clamp(this,e,t)}clampMin(e){return d.clampMin(this,e)}clampMax(e){return d.clampMax(this,e)}pLog10(){return d.pLog10(this)}absLog10(){return d.absLog10(this)}log10(){return d.log10(this)}log(e){return d.log(this,e)}log2(){return d.log2(this)}ln(){return d.ln(this)}pow(e){return d.pow(this,e)}pow10(){return d.pow10(this)}pow_base(e){return d.pow_base(this,e)}root(e){return d.root(this,e)}factorial(){return d.factorial(this)}gamma(){return d.gamma(this)}lngamma(){return d.lngamma(this)}exp(){return d.exp(this)}sqr(){return d.pow(this,2)}sqrt(){return d.root(this,2)}cube(){return d.pow(this,3)}cbrt(){return d.root(this,3)}tetrate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.tetrate(this,e,t)}iteratedexp(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return d.iteratedlog(this,e,t)}slog(e=10){return d.slog(this,e)}layeradd10(e){return d.layeradd10(this,e)}layeradd(e,t){return d.layeradd(this,e,t)}lambertw(){return d.lambertw(this)}ssqrt(){return d.ssqrt(this)}pentate(e=2,t=c.fromComponents_noNormalize(1,0,1)){return d.pentate(this,e,t)}sin(){return d.sin(this)}cos(){return d.cos(this)}tan(){return d.tan(this)}asin(){return d.asin(this)}acos(){return d.acos(this)}atan(){return d.atan(this)}sinh(){return d.sinh(this)}cosh(){return d.cosh(this)}tanh(){return d.tanh(this)}asinh(){return d.asinh(this)}acosh(){return d.acosh(this)}atanh(){return d.atanh(this)}};let Ie=De;Ie.negate=De.neg;Ie.negated=De.neg;Ie.sgn=De.sign;Ie.plus=De.add;Ie.subtract=De.sub;Ie.minus=De.sub;Ie.multiply=De.mul;Ie.times=De.mul;Ie.divide=De.div;Ie.divideBy=De.div;Ie.dividedBy=De.div;Ie.reciprocal=De.recip;Ie.reciprocate=De.recip;Ie.max=rn(c.max);Ie.min=rn(c.min);Ie.minabs=rn(c.minabs);Ie.maxabs=rn(c.maxabs);Ie.clampMin=rn(c.clampMin);Ie.clampMax=rn(c.clampMax);Ie.logarithm=De.log;class d extends Ie{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=c.add(this.evaluate(0),this.evaluate(1)).div(2);return c.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),d.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(i=>n=i(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),d.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),d.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),d.constant(0)))}}function bo(e,t,n=!0,i,a=c.dInf){const r=cn(n),l=cn(i),o=cn(a);return F(()=>{var _,w,b,C;const u=f(o);if(c.eq(u,1))return c.gte(t.value,e.evaluate())?c.dOne:c.dZero;const g=f(r),h=(_=f(l))!=null?_:g?10:0;let p=0;if(c.gt(u,h)){if(!e.isInvertible())return console.error("Cannot calculate max affordable of non-invertible formula with more maxBulkAmount than directSum"),0;if(g){if(!e.isIntegralInvertible())return console.error("Cannot calculate max affordable of formula with non-invertible integral"),0;p=c.floor(e.invertIntegral(c.add(t.value,e.evaluateIntegral()))).sub((w=f(e.innermostVariable))!=null?w:0)}else p=c.floor(e.invert(t.value))}if(p=c.clampMax(p,u),h>0){const E=p;p=c.sub(p,h).clampMin(0);let T;for(g?T=Mn(e,p,!0,0):T=e.evaluate(c.add((b=f(e.innermostVariable))!=null?b:0,p));c.lt(p,u)&&c.lt(p,Number.MAX_SAFE_INTEGER)&&c.add(E,1).gte(p);){const S=e.evaluate(p.add((C=f(e.innermostVariable))!=null?C:0));if(c.add(T,S).lte(t.value))p=p.add(1),T=c.add(T,S);else break}}return p})}function Mn(e,t,n=!0,i){var u;if(c.eq(t,1))return e.evaluate();const a=(u=f(e.innermostVariable))!=null?u:0;let r=c.add(t,a);const l=r;i!=null||(i=n?10:0),r=r.sub(i).clampMin(a);let o=0;if(c.gt(t,i)){if(!e.isInvertible())return console.error("Cannot calculate cost with indirect sum of non-invertible formula"),0;if(n){if(!e.isIntegrable())return console.error("Cannot calculate cost with cumulative cost of non-integrable formula"),0;if(o=c.sub(e.evaluateIntegral(r),e.evaluateIntegral()),l.gt(1e308))return c.add(o,c.sub(l,r).times(e.evaluate(r)))}else if(o=e.evaluate(r),r=r.add(1),l.gt(1e308))return c.sub(l,r).add(1).times(o)}for(let g=r.toNumber();g<l.toNumber();g++)o=c.add(o,e.evaluate(g));return o}const Tt=Symbol("PersistentState"),Qt=Symbol("DefaultValue"),Pn=Symbol("StackTrace"),Fn=Symbol("Deleted"),ft=Symbol("NonPersistent"),Ut=Symbol("SaveDataPath"),Un=Symbol("SkipPersistence");function yo(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function fi(e,t){var n;c.isNaN(t)&&(Te.hasNaN||(U.autosave=!1,Te.hasNaN=!0,Te.NaNPath=e[Ut],Te.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[Ut])==null?void 0:n.join(".")}`)),e[Tt].value=t}function me(e,t=!0){const n=Qe(e)?e:V(e);Qe(e)&&(e=e.value);const i=F({get(){return n.value},set(r){t?fi(a,r):a[Tt].value=r}});i[Qt]=e;const a={get value(){return n.value},set value(r){t?fi(a,r):a[Tt].value=r},__v_isRef:!0,[Tt]:n,[Qt]:e,[Pn]:yo(),[Fn]:!1,[ft]:i,[Ut]:void 0};return Ke.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",a,`
Created at:
`+a[Pn]):Wt[Ke[Ke.length-1]].add(a),a}function _o(e){return e!=null&&typeof e=="object"&&Tt in e}function nt(e){return!($t in e)&&ft in e?e[ft]:new Proxy(e,{get(t,n){if(n!==Tt)return n===Un?!0:t[n]},set(t,n,i){return t[n]=i,!0},has(t,n){return n===Tt?!1:n==Un?!0:Reflect.has(t,n)}})}function wo(e){Ke.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):Wt[Ke[Ke.length-1]].delete(e),e[Fn]=!0}We.on("addLayer",(e,t)=>{const n=[],i=(a,r=[])=>{let l=!1;return Object.keys(a).forEach(o=>{let u=a[o];if(u!=null&&typeof u=="object"){if(u[Un]===!0)return;if($t in u&&(u=u[$t]),_o(u)){if(l=!0,u[Fn]){console.warn("Deleted persistent ref present in returned object. Ignoring...",u,`
Created at:
`+u[Pn]);return}Wt[e.id].delete(u);const g=[e.id,...r,o];u[Ut]!=null&&JSON.stringify(g)!==JSON.stringify(u[Ut])&&console.error(`Persistent ref is being saved to \`${g.join(".")}\` when it's already present at \`${u[Ut].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),u[Ut]=g;const h=r.reduce((_,w)=>(w in _||(_[w]={}),_[w]),t),p=h[o];h[o]=u[Tt],Yi(h)?p!=null?h[o]=p:h[o]=u[Qt]:p!=null?h[o].value=p:h[o].value=u[Qt]}else!(u instanceof c)&&!(u instanceof d)&&!Qe(u)&&!n.includes(u)&&(typeof u.type=="symbol"&&n.push(u),i(u,[...r,o])&&(Pt(u)&&!Pt(a)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",$t in a?a[$t]:a,o):l=!0))}}),l};i(e[$t]),Wt[e.id].forEach(a=>{a[Fn]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+a[Pn])}),Wt[e.id].clear()});const Kn=Symbol("RegisterNode"),Qn=Symbol("UnregisterNode"),Ii=Symbol("Nodes"),$i=Symbol("Bounds"),Ye=Wn({});window.layers=Ye;const Wt={},Ke=[];function ei(e,t){return an(()=>{const n={},i=n.emitter=pi();if(n.on=i.on.bind(i),n.emit=i.emit.bind(i),n.nodes=V({}),n.id=e,Ke.push(e),Wt[e]=new Set,n.minimized=me(!1,!1),Object.assign(n,t.call(n,n)),Ke[Ke.length-1]==null||Ke[Ke.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${Ke}
Trying to pop ${n.id}`);Ke.pop(),B(n,"color"),B(n,"display"),B(n,"classes"),B(n,"style"),B(n,"name"),Ce(n,"name",n.id),B(n,"minWidth"),Ce(n,"minWidth",600),B(n,"minimizable"),Ce(n,"minimizable",!0),B(n,"minimizedDisplay");const a=n.style;return n.style=F(()=>{var l,o;let r=f(n.minWidth);return(typeof r=="number"||!Number.isNaN(parseInt(r)))&&(r=r+"px"),[(l=f(a))!=null?l:"",(o=n.minimized)!=null&&o.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:r,flexBasis:r,margin:""}]}),n})}function Ti(e,t){if(console.info("Adding layer",e.id),Ye[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Ye[e.id]);return}Ce(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Ye[e.id]=e,We.emit("addLayer",e,t.layers[e.id])}function Co(e){return Ye[e]}function Pi(e){console.info("Removing layer",e.id),We.emit("removeLayer",e),Ye[e.id]=void 0}function No(e){Pi(e),Ti(e,U)}function ko(e){const t=V(!1);return{openModal:()=>t.value=!0,modal:we(()=>s(pt,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>s("h2",null,[f(e.name)]),body:f(e.display)}))}}We.on("update",function(t){Object.values(Ye).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Ye).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Ye).forEach(n=>{n==null||n.emit("postUpdate",t)})});var xo=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:Kn,UnregisterNodeInjectionKey:Qn,NodesInjectionKey:Ii,BoundsInjectionKey:$i,layers:Ye,persistentRefs:Wt,addingLayers:Ke,createLayer:ei,addLayer:Ti,getLayer:Co,removeLayer:Pi,reloadLayer:No,setupLayerModal:ko},Symbol.toStringTag,{value:"Module"}));const So=se({components:{Context:Si,ErrorVue:vi},props:{index:{type:Number,required:!0},display:{type:fe(Object,String,Function),required:!0},minimizedDisplay:fe(Object,String,Function),minimized:{type:Object,required:!0},name:{type:fe(String),required:!0},color:fe(String),minimizable:fe(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:i,minimizedDisplay:a}=Ze(e),r=Or(t),l=hn(a),o=F(()=>le.allowGoBack&&n.value>0&&!ot(i));function u(){U.tabs.splice(f(e.index),1/0)}function g(p){e.nodes.value=p}const h=V([]);return Zi((p,_,w)=>(console.warn(`Error caught in "${e.name}" layer`,p,_,w),h.value.push(p instanceof Error?p:new Error(JSON.stringify(p))),!1)),{component:r,minimizedComponent:l,showGoBack:o,updateNodes:g,unref:f,goBack:u,errors:h}}}),Mo={key:1};function Io(e,t,n,i,a,r){const l=Yt("ErrorVue"),o=Yt("Context");return e.errors.length>0?(x(),re(l,{key:0,errors:e.errors},null,8,["errors"])):(x(),M("div",Ht({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(x(),M("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...u)=>e.goBack&&e.goBack(...u))},"\u274C")):G("",!0),e.unref(e.minimized)?(x(),M("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=u=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(x(),re(at(e.minimizedComponent),{key:0})):(x(),M("div",Mo,ne(e.unref(e.name)),1))])):(x(),M("div",{key:2,class:Pe(["layer-tab",{showGoBack:e.showGoBack}])},[s(o,{onUpdateNodes:e.updateNodes},{default:X(()=>[(x(),re(at(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(x(),M("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=u=>e.$emit("setMinimized",!0))}," \u25BC ")):G("",!0)],16))}var $o=ke(So,[["render",Io],["__scopeId","data-v-a9f5b1da"]]);const Vn=e=>(Et("data-v-2c252581"),e=e(),Dt(),e),To=Vn(()=>m("h2",null,"Changelog",-1)),Po=Vn(()=>m("details",{open:""},[m("summary",null,[y("v0.2.1 Slightly Less Prototypey Thing - "),m("time",null,"2023-05-26")]),m("ul",null,[m("li",{class:"fix"},"Fix breaking error")])],-1)),Fo=Vn(()=>m("details",null,[m("summary",null,[y("v0.2 Slightly Less Prototypey Thing - "),m("time",null,"2023-05-26")]),m("ul",null,[m("li",{class:"feature"},"Added the meta game"),m("li",{class:"feature"},"Added more buildings")])],-1)),Eo=Vn(()=>m("details",null,[m("summary",null,[y("v0.1 Prototype Thing - "),m("time",null,"2023-05-25")]),y(" This is the first release :D "),m("ul",null,[m("li",{class:"feature"},"Did everything"),m("li",{class:"fix"},"Had some fun"),m("li",{class:"breaking"},"Removed everything"),m("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),Do=se({__name:"Changelog",setup(e,{expose:t}){const n=V(!1);return t({open(){n.value=!0}}),(i,a)=>(x(),re(pt,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value=r)},{header:X(()=>[To]),body:X(()=>[Po,Fo,Eo]),_:1},8,["modelValue"]))}});var Oo=ke(Do,[["__scopeId","data-v-2c252581"]]),Ao=se({props:{element:Object,display:{type:fe(Object,String,Function),required:!0},style:fe(Object,String,Array),classes:fe(Object),direction:fe(String),xoffset:fe(String),yoffset:fe(String),pinned:Object},setup(e){const{element:t,display:n,pinned:i}=Ze(e),a=V(!1),r=F(()=>(ot(i)||a.value)&&l.value),l=hn(n),o=tn(Ge(we(()=>{const h=ot(t);return h==null?"":Er(h)})));function u(h){const p=i;h.shiftKey&&p&&(p.value=!p.value,h.stopPropagation(),h.preventDefault())}const g=F(()=>ot(i)&&ct[be.theme].showPin);return{Direction:q,isHovered:a,isShown:r,comp:l,elementComp:o,unref:f,togglePinned:u,showPin:g}}});const Vo={key:0,class:"material-icons pinned"};function Bo(e,t,n,i,a,r){return x(),M("div",{class:Pe(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=l=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=l=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...l)=>e.togglePinned&&e.togglePinned(...l))},[Ct(e.$slots,"default",{},void 0,!0),e.elementComp?(x(),re(at(e.elementComp),{key:0})):G("",!0),s(dn,{name:"fade"},{default:X(()=>{var l;return[e.isShown?(x(),M("div",{key:0,class:Pe(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:et([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(l=e.unref(e.style))!=null?l:{}])},[e.showPin?(x(),M("span",Vo,"push_pin")):G("",!0),e.comp?(x(),re(at(e.comp),{key:1})):G("",!0)],6)):G("",!0)]}),_:1})],34)}var qe=ke(Ao,[["render",Bo],["__scopeId","data-v-6102fa3a"]]);const vt=e=>(Et("data-v-78ea6a7e"),e=e(),Dt(),e),Lo=vt(()=>m("h1",{class:"result-title"},"DELOOPED",-1)),qo={style:{"font-style":"italic"}},Ro={key:0,style:{"text-align":"center"}},zo={key:0},jo=vt(()=>m("br",null,null,-1)),Uo=vt(()=>m("div",null,[y(" Made for the "),m("a",{style:{display:"inline-block"},href:"https://itch.io/jam/profectus-creation-jam",target:"_blank"}," Profectus Creation Jam ")],-1)),Go=vt(()=>m("div",{style:{"font-size":"smaller",opacity:".5"}}," (Profectus by thepaperpilot, with inspiration from Acameada and Jacorb) ",-1)),Wo=vt(()=>m("br",null,null,-1)),Ho=vt(()=>m("br",null,null,-1)),Yo=["href"],Zo=vt(()=>m("span",{class:"material-icons info-modal-discord"},"discord",-1)),Xo=vt(()=>m("div",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[m("span",{class:"material-icons info-modal-discord"},"discord"),y(" The Paper Pilot Community ")])],-1)),Jo=vt(()=>m("div",null,[m("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[m("span",{class:"material-icons info-modal-discord"},"discord"),y(" The Modding Tree ")])],-1)),Ko=vt(()=>m("br",null,null,-1));var Qo=se({__name:"Info",props:{changelog:{}},setup(e,{expose:t}){const n=e,{title:i,logo:a,author:r,discordName:l,discordLink:o,versionNumber:u,versionTitle:g}=le,h=Ze(n),p=V(!1),_=F(()=>Gt(U.timePlayed)),w=F(()=>Ge(we(()=>s(W,null,[$r.map(dt)]))));t({open(){p.value=!0}});function b(){var C;console.log(h.changelog),(C=f(h.changelog))==null||C.open()}return(C,E)=>(x(),re(pt,{modelValue:p.value,"onUpdate:modelValue":E[0]||(E[0]=T=>p.value=T)},{header:X(()=>[Lo,m("h2",qo," - "+ne(f(g))+" - ",1),m("h4",null," v"+ne(f(u)),1)]),body:X(({shown:T})=>[T?(x(),M("div",Ro,[f(r)?(x(),M("div",zo,"a game by "+ne(f(r)),1)):G("",!0),jo,Uo,Go,Wo,m("div",{class:"link",onClick:b},"Changelog"),Ho,m("div",null,[f(o)?(x(),M("a",{key:0,href:f(o),class:"info-modal-discord-link",target:"_blank"},[Zo,y(" "+ne(f(l)),1)],8,Yo)):G("",!0)]),Xo,Jo,Ko,m("div",null,"Time Played: "+ne(_.value),1),(x(),re(at(w.value)))])):G("",!0)]),_:1},8,["modelValue"]))}});var el=ke(Qo,[["__scopeId","data-v-78ea6a7e"]]);const tl={class:"field"},nl={key:0,class:"field-title"},Fi=se({__name:"Select",props:{title:{type:[String,Object,Function]},modelValue:{},options:{},placeholder:{},closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var l;const n=e,i=hn(Ft(n,"title"),"span"),a=V((l=n.options.find(o=>o.value===n.modelValue))!=null?l:null);gt(Ft(n,"modelValue"),o=>{var u;ot(a)!==o&&(a.value=(u=n.options.find(g=>g.value===o))!=null?u:null)});function r(o){t("update:modelValue",o.value)}return(o,u)=>(x(),M("div",tl,[f(i)?(x(),M("span",nl,[(x(),re(at(f(i))))])):G("",!0),s(f(Qi),{options:o.options,modelValue:a.value,"onUpdate:modelValue":[u[0]||(u[0]=g=>a.value=g),r],min:1,"label-by":"label",placeholder:o.placeholder,"close-on-select":o.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const il={class:"field"},al=se({__name:"Toggle",props:{title:{type:[String,Object,Function]},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=F(()=>{var r;return Ge((r=f(n.title))!=null?r:"<span></span>","span")}),a=F({get(){return!!n.modelValue},set(r){t("update:modelValue",r)}});return(r,l)=>(x(),M("label",il,[Hn(m("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":l[0]||(l[0]=o=>a.value=o)},null,512),[[Xi,a.value]]),(x(),re(at(i.value)))]))}});var yt=ke(al,[["__scopeId","data-v-11046116"]]);const rl=m("h1",{class:"result-title"},"SETTINGS",-1),sl=m("h2",{style:{"font-style":"italic"}}," - Tweak your preferences. - ",-1),ol={class:"option-tabs"},ll={key:0},ul={key:1};var cl=se({__name:"Options",setup(e,{expose:t}){const n=V(!1),i=V("behaviour");function a(ge){return ge==i.value}function r(ge){i.value=ge}t({isTab:a,setTab:r,save:it,open(){n.value=!0}});const l=Object.keys(ct).map(ge=>({label:wr(ge),value:ge})),o=F(()=>Ge(we(()=>s(W,null,[Ir.map(dt)])))),{showTPS:u,theme:g,unthrottled:h,alignUnits:p}=Ze(be),{autosave:_,offlineProd:w}=Ze(U),b=F({get(){return U.devSpeed===0},set(ge){U.devSpeed=ge?0:null}}),C=we(()=>s("span",{class:"option-title"},[y("Unthrottled"),s("desc",null,[y("Allow the game to run as fast as possible. Not battery friendly.")])])),E=we(()=>s("span",{class:"option-title"},[y("Offline Production"),s(qe,{display:"Save-specific",direction:q.Right},{default:()=>[y("*")]}),s("desc",null,[y("Simulate production that occurs while the game is closed.")])])),T=we(()=>s("span",{class:"option-title"},[y("Autosave"),s(qe,{display:"Save-specific",direction:q.Right},{default:()=>[y("*")]}),s("desc",null,[y("Automatically save the game every second or when the game is closed.")])])),S=we(()=>s("span",{class:"option-title"},[y("Pause game"),s(qe,{display:"Save-specific",direction:q.Right},{default:()=>[y("*")]}),s("desc",null,[y("Stop everything from moving.")])])),$=we(()=>s("span",{class:"option-title"},[y("Theme"),s("desc",null,[y("How the game looks.")])])),H=we(()=>s("span",{class:"option-title"},[y("Show TPS"),s("desc",null,[y("Show TPS meter at the bottom-left corner of the page.")])])),ce=we(()=>s("span",{class:"option-title"},[y("Align modifier units"),s("desc",null,[y("Align numbers to the beginning of the unit in modifier view.")])]));return(ge,oe)=>(x(),re(pt,{modelValue:n.value,"onUpdate:modelValue":oe[10]||(oe[10]=K=>n.value=K)},{header:X(()=>[rl,sl,m("div",ol,[m("button",{class:Pe({selected:a("behaviour")}),onClick:oe[0]||(oe[0]=K=>r("behaviour"))},"Behaviour",2),m("button",{class:Pe({selected:a("appearance")}),onClick:oe[1]||(oe[1]=K=>r("appearance"))},"Appearance",2)])]),body:X(()=>[a("behaviour")?(x(),M("div",ll,[s(yt,{title:f(C),modelValue:f(h),"onUpdate:modelValue":oe[2]||(oe[2]=K=>Qe(h)?h.value=K:null)},null,8,["title","modelValue"]),f(le).enablePausing?(x(),re(yt,{key:0,title:f(S),modelValue:b.value,"onUpdate:modelValue":oe[3]||(oe[3]=K=>b.value=K)},null,8,["title","modelValue"])):G("",!0),f(le).offlineLimit>0?(x(),re(yt,{key:1,title:f(E),modelValue:f(w),"onUpdate:modelValue":oe[4]||(oe[4]=K=>Qe(w)?w.value=K:null)},null,8,["title","modelValue"])):G("",!0),s(yt,{title:f(T),modelValue:f(_),"onUpdate:modelValue":oe[5]||(oe[5]=K=>Qe(_)?_.value=K:null)},null,8,["title","modelValue"]),f(_)?G("",!0):(x(),re(Zn,{key:2,class:"button save-button",onClick:oe[6]||(oe[6]=K=>f(it)())},{default:X(()=>[y("Manually save")]),_:1}))])):G("",!0),a("appearance")?(x(),M("div",ul,[s(Fi,{title:f($),options:f(l),modelValue:f(g),"onUpdate:modelValue":oe[7]||(oe[7]=K=>Qe(g)?g.value=K:null)},null,8,["title","options","modelValue"]),(x(),re(at(o.value))),s(yt,{title:f(H),modelValue:f(u),"onUpdate:modelValue":oe[8]||(oe[8]=K=>Qe(u)?u.value=K:null)},null,8,["title","modelValue"]),s(yt,{title:f(ce),modelValue:f(p),"onUpdate:modelValue":oe[9]||(oe[9]=K=>Qe(p)?p.value=K:null)},null,8,["title","modelValue"])])):G("",!0)]),_:1},8,["modelValue"]))}});const dl=["onSubmit"],fl={class:"field"},gl={key:0,class:"field-title"},ml=["placeholder"],pl=se({__name:"Text",props:{title:{type:[String,Object,Function]},modelValue:{},textArea:{type:Boolean},placeholder:{},maxHeight:{},submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,i=hn(Ft(n,"title"),"span"),a=tn(null);Gn(()=>{var u;(u=a.value)==null||u.focus()});const r=F({get(){var u;return(u=f(n.modelValue))!=null?u:""},set(u){t("update:modelValue",u)}});function l(){t("submit")}function o(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(u,g)=>(x(),M("form",{onSubmit:Jt(l,["prevent"])},[m("div",fl,[f(i)?(x(),M("span",gl,[(x(),re(at(f(i))))])):G("",!0),u.textArea?(x(),re(f(ta),{key:1,modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=h=>r.value=h),placeholder:u.placeholder,maxHeight:u.maxHeight,onBlur:o,ref_key:"field",ref:a},null,8,["modelValue","placeholder","maxHeight"])):Hn((x(),M("input",{key:2,type:"text","onUpdate:modelValue":g[1]||(g[1]=h=>r.value=h),placeholder:u.placeholder,class:Pe({fullWidth:!u.title}),onBlur:o,ref_key:"field",ref:a},null,42,ml)),[[Ji,r.value]])])],40,dl))}});var Ei=ke(pl,[["__scopeId","data-v-90bd4994"]]);const vl={key:0},hl=["onClick","disabled"],bl={key:0},yl=["onClick"],_l=se({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const i=Ze(e),a=V(!1);gt(a,o=>{t("confirmingChanged",o)});function r(){if(f(i.skipConfirm)){t("click");return}a.value&&t("click"),a.value=!a.value}function l(){a.value=!1}return(o,u)=>(x(),M("span",{class:Pe(["container",{confirming:a.value}])},[a.value?(x(),M("span",vl,"Are you sure?")):G("",!0),m("button",{onClick:Jt(r,["stop"]),class:"button danger",disabled:o.disabled},[a.value?(x(),M("span",bl,"Yes")):Ct(o.$slots,"default",{key:1},void 0,!0)],8,hl),a.value?(x(),M("button",{key:1,class:"button",onClick:Jt(l,["stop"])},"No",8,yl)):G("",!0)],2))}});var wl=ke(_l,[["__scopeId","data-v-2f8ef34c"]]);const Nt=e=>(Et("data-v-32313015"),e=e(),Dt(),e),Cl=Nt(()=>m("div",{class:"handle material-icons"},"drag_handle",-1)),Nl={key:0,class:"actions"},kl=Nt(()=>m("span",{class:"material-icons"},"content_paste",-1)),xl=Nt(()=>m("span",{class:"material-icons"},"content_copy",-1)),Sl=Nt(()=>m("span",{class:"material-icons"},"edit",-1)),Ml=Nt(()=>m("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Il={key:1,class:"actions"},$l=Nt(()=>m("span",{class:"material-icons"},"check",-1)),Tl=Nt(()=>m("span",{class:"material-icons"},"close",-1)),Pl={key:2,class:"details"},Fl={class:"save-version"},El=Nt(()=>m("br",null,null,-1)),Dl={key:0},Ol={key:3,class:"details"},Al={key:4,class:"details error"},Vl=Nt(()=>m("br",null,null,-1)),Bl=se({__name:"Save",props:{save:{}},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:i}=Ze(n),a=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),r=V(!1),l=V(!1),o=V("");gt(r,()=>{var p;return o.value=(p=i.value.name)!=null?p:""});const u=F(()=>i.value!=null&&i.value.id===U.id),g=F(()=>{var p;return u.value?U.time:(p=i.value!=null&&i.value.time)!=null?p:0});function h(){t("editName",o.value),r.value=!1}return(p,_)=>(x(),M("div",{class:Pe(["save",{active:u.value}])},[Cl,r.value?(x(),M("div",Il,[m("button",{onClick:h,class:"button"},[s(qe,{display:"Save",direction:f(q).Left,class:"info"},{default:X(()=>[$l]),_:1},8,["direction"])]),m("button",{onClick:_[5]||(_[5]=w=>r.value=!r.value),class:"button"},[s(qe,{display:"Cancel",direction:f(q).Left,class:"info"},{default:X(()=>[Tl]),_:1},8,["direction"])])])):(x(),M("div",Nl,[f(i).error==null&&!l.value?(x(),re(Zn,{key:0,onClick:_[0]||(_[0]=w=>t("export")),class:"button",left:""},{default:X(()=>[s(qe,{display:"Export",direction:f(q).Left,class:"info"},{default:X(()=>[kl]),_:1},8,["direction"])]),_:1})):G("",!0),f(i).error==null&&!l.value?(x(),M("button",{key:1,onClick:_[1]||(_[1]=w=>t("duplicate")),class:"button"},[s(qe,{display:"Duplicate",direction:f(q).Left,class:"info"},{default:X(()=>[xl]),_:1},8,["direction"])])):G("",!0),f(i).error==null&&!l.value?(x(),M("button",{key:2,onClick:_[2]||(_[2]=w=>r.value=!r.value),class:"button"},[s(qe,{display:"Edit Name",direction:f(q).Left,class:"info"},{default:X(()=>[Sl]),_:1},8,["direction"])])):G("",!0),s(wl,{disabled:u.value,onClick:_[3]||(_[3]=w=>t("delete")),onConfirmingChanged:_[4]||(_[4]=w=>l.value=w)},{default:X(()=>[s(qe,{display:"Delete",direction:f(q).Left,class:"info"},{default:X(()=>[Ml]),_:1},8,["direction"])]),_:1},8,["disabled"])])),f(i).error==null&&!r.value?(x(),M("div",Pl,[m("button",{class:"button open",onClick:_[6]||(_[6]=w=>t("open"))},[m("h3",null,ne(f(i).name),1)]),m("span",Fl,"v"+ne(f(i).modVersion),1),El,g.value?(x(),M("div",Dl,"Last played "+ne(f(a).format(g.value)),1)):G("",!0)])):f(i).error==null&&r.value?(x(),M("div",Ol,[s(Ei,{modelValue:o.value,"onUpdate:modelValue":_[7]||(_[7]=w=>o.value=w),class:"editname",onSubmit:h},null,8,["modelValue"])])):(x(),M("div",Al,[y(" Error: Failed to load save with id "+ne(f(i).id),1),Vl,y(ne(f(i).error),1)]))],2))}});var Ll=ke(Bl,[["__scopeId","data-v-32313015"]]);const Bn=e=>(Et("data-v-14e7bbf6"),e=e(),Dt(),e),ql=Bn(()=>m("h1",{class:"result-title"},"ARCHIVE",-1)),Rl=Bn(()=>m("h2",{style:{"font-style":"italic"}}," - Manage your save states. - ",-1)),zl={class:"modal-footer"},jl={class:"field",style:{"--layer-color":"#dadafa"}},Ul=Bn(()=>m("span",{class:"field-title"},"Create Save",-1)),Gl={class:"field-buttons"},Wl={class:"footer",style:{"--layer-color":"#dadafa"}},Hl=Bn(()=>m("div",{style:{"flex-grow":"1"}},null,-1)),Yl=se({__name:"SavesManager",setup(e,{expose:t}){const n=V(!1),i=V(null);t({open(){n.value=!0}});const a=V(!1),r=V(""),l=V(null);gt(r,S=>{S?Kt(()=>{try{if(S[0]!=="{")if(S[0]==="e")S=decodeURIComponent(escape(atob(S)));else if(S[0]==="\u1BE1")S=wt.decompressFromUTF16(S);else{console.warn("Unable to determine preset encoding",S),a.value=!0;return}const $=JSON.parse(S);if(typeof $!="object"){a.value=!0;return}const H=Sn();$.id=H,it($),r.value="",a.value=!1,be.saves.push(H)}catch{a.value=!0}}):a.value=!1});let o={},u=V(Object.keys(o).reduce((S,$)=>(S.push({label:$.split("/").slice(-1)[0].slice(0,-4),value:o[$]}),S),[]));const g=Wn({});function h(S){if(g[S]==null){let $=localStorage.getItem(S);if($==null)g[S]={error:"Save doesn't exist in localStorage",id:S};else if($==="dW5kZWZpbmVk")g[S]={error:"Save is undefined",id:S};else try{if($[0]!=="{")if($[0]==="e")$=decodeURIComponent(escape(atob($)));else if($[0]==="\u1BE1")$=wt.decompressFromUTF16($);else return console.warn("Unable to determine preset encoding",$),a.value=!0,g[S]={error:"Unable to determine preset encoding",id:S},g[S];g[S]={...JSON.parse($),id:S}}catch(H){g[S]={error:H,id:S},console.warn(`SavesManager: Failed to load info about save with id ${S}:
${H}
${$}`)}}return g[S]}gt(n,S=>{S&&Object.keys(g).forEach($=>delete g[$])});const p=F(()=>be.saves.reduce((S,$)=>(S[$]=h($),S),{}));function _(S){let $;switch(U.id===S?$=Yn(U):$=JSON.stringify(p.value[S]),le.exportEncoding){default:console.warn(`Unknown save encoding: ${le.exportEncoding}. Defaulting to lz`);case"lz":$=wt.compressToUTF16($);break;case"base64":$=btoa(unescape(encodeURIComponent($)));break;case"plain":break}const H=document.createElement("textarea");H.value=$,document.body.appendChild(H),H.select(),H.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(H)}function w(S){U.id===S&&it();const $={...p.value[S],id:Sn()};it($),be.saves.push($.id)}function b(S){be.saves=be.saves.filter($=>$!==S),localStorage.removeItem(S),g[S]=void 0}function C(S){p.value[U.id].time=U.time,it(),g[U.id]=void 0,jt(p.value[S]),g[S]=void 0}function E(S){if(l.value=S,Kt(()=>{l.value=null}),S[0]!=="{")if(S[0]==="e")S=decodeURIComponent(escape(atob(S)));else if(S[0]==="\u1BE1")S=wt.decompressFromUTF16(S);else{console.warn("Unable to determine preset encoding",S);return}const $=JSON.parse(S);$.id=Sn(),it($),be.saves.push($.id),C($.id)}function T(S,$){const H=p.value[S];H!=null&&(H.name=$,U.id===S?(U.name=$,it()):(it(H),g[S]=void 0))}return(S,$)=>(x(),re(pt,{modelValue:n.value,"onUpdate:modelValue":$[4]||($[4]=H=>n.value=H),ref_key:"modal",ref:i},{header:X(()=>[ql,Rl]),body:X(({shown:H})=>[H?(x(),re(f(ea),{key:0,list:f(be).saves,handle:".handle",itemKey:ce=>ce},{item:X(({element:ce})=>[s(Ll,{save:p.value[ce],onOpen:ge=>C(ce),onExport:ge=>_(ce),onEditName:ge=>T(ce,ge),onDuplicate:ge=>w(ce),onDelete:ge=>b(ce)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):G("",!0)]),footer:X(()=>[m("div",zl,[s(Ei,{modelValue:r.value,"onUpdate:modelValue":$[0]||($[0]=H=>r.value=H),title:"Import Save",placeholder:"Paste your save here!",class:Pe({importingFailed:a.value})},null,8,["modelValue","class"]),m("div",jl,[Ul,m("div",Gl,[m("button",{class:"feature can",onClick:$[1]||($[1]=H=>C(f(Zt)().id))},"New Game"),Object.keys(f(u)).length>0?(x(),re(Fi,{key:0,options:f(u),modelValue:l.value,"onUpdate:modelValue":$[2]||($[2]=H=>E(H)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):G("",!0)])]),m("div",Wl,[Hl,m("button",{class:"feature can",onClick:$[3]||($[3]=H=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var Di=ke(Yl,[["__scopeId","data-v-14e7bbf6"]]);const rt=e=>(Et("data-v-318a1c31"),e=e(),Dt(),e),Zl=["src","alt"],Xl={key:1,class:"title"},Jl=rt(()=>m("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),Kl={class:"discord"},Ql={class:"discord-links"},eu={key:0},tu=["href"],nu=rt(()=>m("li",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),iu=rt(()=>m("li",null,[m("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),au={href:"https://forums.moddingtree.com/",target:"_blank"},ru=rt(()=>m("span",{class:"material-icons"},"forum",-1)),su=rt(()=>m("span",{class:"material-icons"},"info",-1)),ou=rt(()=>m("span",{class:"material-icons"},"library_books",-1)),lu=rt(()=>m("span",{class:"material-icons"},"settings",-1)),uu=rt(()=>m("span",{class:"material-icons"},"library_books",-1)),cu=rt(()=>m("span",{class:"material-icons"},"settings",-1)),du=rt(()=>m("span",{class:"material-icons"},"info",-1)),fu={href:"https://forums.moddingtree.com/",target:"_blank"},gu=rt(()=>m("span",{class:"material-icons"},"forum",-1)),mu={class:"discord"},pu={class:"discord-links"},vu={key:0},hu=["href"],bu=rt(()=>m("li",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),yu=rt(()=>m("li",null,[m("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),_u=se({__name:"Nav",setup(e){const t=V(null),n=V(null),i=V(null),a=V(null),{useHeader:r,banner:l,title:o,discordName:u,discordLink:g,versionNumber:h}=le;function p(){window.open(g,"mywindow")}return(_,w)=>(x(),M(W,null,[f(r)?(x(),M("div",Ht({key:0,class:"nav"},_.$attrs),[f(l)?(x(),M("img",{key:0,src:f(l),class:"banner",alt:f(o)},null,8,Zl)):(x(),M("div",Xl,ne(f(o)),1)),m("div",{onClick:w[0]||(w[0]=b=>{var C;return(C=a.value)==null?void 0:C.open()}),class:"version-container"},[s(qe,{display:"Changelog",direction:f(q).Down,class:"version"},{default:X(()=>[m("span",null,"v"+ne(f(h)),1)]),_:1},8,["direction"])]),Jl,m("div",Kl,[m("span",{onClick:p,class:"material-icons"},"discord"),m("ul",Ql,[f(g)?(x(),M("li",eu,[m("a",{href:f(g),target:"_blank"},ne(f(u)),9,tu)])):G("",!0),nu,iu])]),m("div",null,[m("a",au,[s(qe,{display:"Forums",direction:f(q).Down,yoffset:"5px"},{default:X(()=>[ru]),_:1},8,["direction"])])]),m("div",{onClick:w[1]||(w[1]=b=>{var C;return(C=t.value)==null?void 0:C.open()})},[s(qe,{display:"Info",direction:f(q).Down,class:"info"},{default:X(()=>[su]),_:1},8,["direction"])]),m("div",{onClick:w[2]||(w[2]=b=>{var C;return(C=n.value)==null?void 0:C.open()})},[s(qe,{display:"Saves",direction:f(q).Down,xoffset:"-20px"},{default:X(()=>[ou]),_:1},8,["direction"])]),m("div",{onClick:w[3]||(w[3]=b=>{var C;return(C=i.value)==null?void 0:C.open()})},[s(qe,{display:"Settings",direction:f(q).Down,xoffset:"-66px"},{default:X(()=>[lu]),_:1},8,["direction"])])],16)):(x(),M("div",Ht({key:1,class:"overlay-nav"},_.$attrs),[m("div",{onClick:w[4]||(w[4]=b=>{var C;return(C=a.value)==null?void 0:C.open()}),class:"version-container"},[s(qe,{display:"Changelog",direction:f(q).Right,xoffset:"25%",class:"version"},{default:X(()=>[m("span",null,"v"+ne(f(h)),1)]),_:1},8,["direction"])]),m("div",{onClick:w[5]||(w[5]=b=>{var C;return(C=n.value)==null?void 0:C.open()})},[s(qe,{display:"Saves",direction:f(q).Right},{default:X(()=>[uu]),_:1},8,["direction"])]),m("div",{onClick:w[6]||(w[6]=b=>{var C;return(C=i.value)==null?void 0:C.open()})},[s(qe,{display:"Settings",direction:f(q).Right},{default:X(()=>[cu]),_:1},8,["direction"])]),m("div",{onClick:w[7]||(w[7]=b=>{var C;return(C=t.value)==null?void 0:C.open()})},[s(qe,{display:"Info",direction:f(q).Right},{default:X(()=>[du]),_:1},8,["direction"])]),m("div",null,[m("a",fu,[s(qe,{display:"Forums",direction:f(q).Right,xoffset:"7px"},{default:X(()=>[gu]),_:1},8,["direction"])])]),m("div",mu,[m("span",{onClick:p,class:"material-icons"},"discord"),m("ul",pu,[f(g)?(x(),M("li",vu,[m("a",{href:f(g),target:"_blank"},ne(f(u)),9,hu)])):G("",!0),bu,yu])])],16)),s(el,{ref_key:"info",ref:t,changelog:a.value},null,8,["changelog"]),s(Di,{ref_key:"savesManager",ref:n},null,512),s(cl,{ref_key:"options",ref:i},null,512),s(Oo,{ref_key:"changelog",ref:a},null,512)],64))}});var Oi=ke(_u,[["__scopeId","data-v-318a1c31"]]);const wu={style:{display:"none"}},Cu={class:"inner-tab"},Nu=se({__name:"Game",setup(e){const t=Ft(U,"tabs"),n=F(()=>Object.keys(Ye)),i=le.useHeader;function a(r){const{display:l,minimized:o,name:u,color:g,minimizable:h,nodes:p,minimizedDisplay:_}=r;return{display:l,minimized:o,name:u,color:g,minimizable:h,nodes:p,minimizedDisplay:_}}return(r,l)=>(x(),M("div",{class:Pe(["tabs-container",{useHeader:f(i)}])},[(x(!0),M(W,null,_t(t.value,(o,u)=>{var g,h;return x(),M("div",{key:u,class:Pe(["tab",f((g=f(Ye)[o])==null?void 0:g.classes)]),style:et(f((h=f(Ye)[o])==null?void 0:h.style))},[m("div",wu,[u===0&&!f(i)?(x(),re(Oi,{key:0})):G("",!0)]),m("div",Cu,[n.value.includes(o)?(x(),re($o,Ht({key:0},a(f(Ye)[o]),{index:u,onSetMinimized:p=>f(Ye)[o].minimized.value=p}),null,16,["index","onSetMinimized"])):(x(),re(at(o),{key:1,index:u},null,8,["index"]))])],6)}),128))],2))}});var ku=ke(Nu,[["__scopeId","data-v-ad1e1194"]]);function En(e,t="points",n=0,i=void 0){const a=Qe(e)?e:me(e);if(a.displayName=t,a.precision=n,a.small=i,!Qe(e)){const r=a[ft];r.displayName=t,r.precision=n,r.small=i}return a}function Ai(e){const t=me(e.value);return gt(e,(n,i)=>{xi.value||c.gt(n,i)&&(t.value=c.add(t.value,c.sub(n,i)))}),t}new c("10^^8");new c("1e100");function gi(e,t){const n=t!=null?t:e.value;return c.eq(e.precision,0)?_e(e.small?n:c.floor(n)):Re(n,e.precision,e.small)}const xu=["x1","y1","x2","y2"],Su=se({__name:"BoardLink",props:{link:{},dragging:{},dragged:{}},setup(e){const n=Ze(e),i=F(()=>{var l,o,u,g,h,p,_;const r={...n.link.value.startNode.position};return n.link.value.offsetStart&&(r.x+=f(n.link.value.offsetStart).x,r.y+=f(n.link.value.offsetStart).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.startNode&&(r.x+=(g=(u=(o=n.dragged)==null?void 0:o.value)==null?void 0:u.x)!=null?g:0,r.y+=(_=(p=(h=n.dragged)==null?void 0:h.value)==null?void 0:p.y)!=null?_:0),r}),a=F(()=>{var l,o,u,g,h,p,_;const r={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(r.x+=f(n.link.value.offsetEnd).x,r.y+=f(n.link.value.offsetEnd).y),((l=n.dragging)==null?void 0:l.value)===n.link.value.endNode&&(r.x+=(g=(u=(o=n.dragged)==null?void 0:o.value)==null?void 0:u.x)!=null?g:0,r.y+=(_=(p=(h=n.dragged)==null?void 0:h.value)==null?void 0:p.y)!=null?_:0),r});return(r,l)=>(x(),M("line",Ht({class:"link"},{...r.link,"stroke-width":r.link.strokeWidth},{class:{pulsing:r.link.pulsing},x1:i.value.x,y1:i.value.y,x2:a.value.x,y2:a.value.y}),null,16,xu))}});var Mu=ke(Su,[["__scopeId","data-v-28281ab6"]]);const Iu={key:0},$u=["transform","onMousedown","onTouchstart","onMouseup","onTouchend"],Tu=["fill","stroke-width","stroke"],Pu=["fill"],Fu=se({__name:"BoardNodeAction",props:{node:{},nodeType:{},actions:{},isSelected:{type:Boolean},selectedAction:{}},emits:["clickAction"],setup(e,{emit:t}){const i=Ze(e),a=F(()=>he(i.nodeType.value.size,f(i.node))),r=F(()=>{var h;return(h=he(i.nodeType.value.outlineColor,f(i.node)))!=null?h:ct[be.theme].variables["--outline"]}),l=F(()=>{var h;return(h=he(i.nodeType.value.titleColor,f(i.node)))!=null?h:ct[be.theme].variables["--foreground"]}),o=F(()=>he(i.nodeType.value.actionDistance,f(i.node)));function u(h,p){t("clickAction",p.id),h.preventDefault(),h.stopPropagation()}function g(h,p){var _;((_=f(i.selectedAction))==null?void 0:_.id)===p.id&&(h.preventDefault(),h.stopPropagation())}return(h,p)=>(x(),re(dn,{name:"actions",appear:""},{default:X(()=>[h.isSelected&&h.actions?(x(),M("g",Iu,[(x(!0),M(W,null,_t(h.actions,(_,w)=>{var b,C;return x(),M("g",{key:_.id,class:Pe(["action",{selected:((b=h.selectedAction)==null?void 0:b.id)===_.id}]),transform:`translate(
                        ${(-a.value-30)*Math.sin(((h.actions.length-1)/2-w)*o.value)},
                        ${(a.value+30)*Math.cos(((h.actions.length-1)/2-w)*o.value)}
                    )`,onMousedown:E=>u(E,_),onTouchstart:E=>u(E,_),onMouseup:E=>g(E,_),onTouchend:Jt(E=>g(E,_),["stop"])},[m("circle",{fill:f(he)(_.fillColor,h.node),r:"20","stroke-width":((C=h.selectedAction)==null?void 0:C.id)===_.id?4:0,stroke:r.value},null,8,Tu),m("text",{fill:l.value,class:"material-icons"},ne(f(he)(_.icon,h.node)),9,Pu)],42,$u)}),128))])):G("",!0)]),_:1}))}});var Eu=ke(Fu,[["__scopeId","data-v-9efb2a56"]]);const Du=["transform"],Ou={key:0},Au=["r","fill","stroke"],Vu=["r","fill","stroke"],Bu=["r","fill"],Lu=["r","stroke-dasharray","stroke-dashoffset","stroke"],qu={key:1,transform:"rotate(45, 0, 0)"},Ru=["width","height","transform","fill","stroke"],zu=["width","height","transform","fill","stroke"],ju=["width","height","transform","fill"],Uu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],Gu={key:2},Wu=["width","height","transform","fill","stroke"],Hu=["width","height","transform","fill","stroke"],Yu=["width","height","transform","fill"],Zu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],Xu=["fill"],Ju={key:0},Ku=["fill","y"],Qu=["fill","y"],ec=se({__name:"BoardNode",props:{node:{},nodeType:{},dragging:{},dragged:{},hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:{}},emits:["mouseDown","endDragging","clickAction"],setup(e,{emit:t}){const n=e,i=Math.sqrt(2),a=1+i/2,r=Ze(n),l=F(()=>he(r.nodeType.value.draggable,f(r.node)));gt(l,A=>{const pe=f(r.node);f(r.dragging)===pe&&!A&&t("endDragging",pe)});const o=F(()=>{var pe;const A=f(r.node);return(pe=he(r.nodeType.value.actions,A))==null?void 0:pe.filter(xe=>nn(he(xe.visibility,A)))}),u=F(()=>{var pe;const A=f(r.node);if(he(r.nodeType.value.draggable,A)&&((pe=f(r.dragging))==null?void 0:pe.id)===A.id&&f(r.dragged)!=null){const{x:xe,y:Ve}=f(r.dragged);return{x:A.position.x+Math.round(xe/25)*25,y:A.position.y+Math.round(Ve/25)*25}}return A.position}),g=F(()=>he(r.nodeType.value.shape,f(r.node))),h=F(()=>he(r.nodeType.value.title,f(r.node))),p=F(()=>{var A;return(A=r.isSelected.value?f(r.selectedAction)&&he(f(r.selectedAction).tooltip,f(r.node)):null)!=null?A:he(r.nodeType.value.label,f(r.node))}),_=F(()=>{var A,pe;return he((pe=(A=f(r.selectedAction))==null?void 0:A.confirmationLabel)!=null?pe:{text:"Tap again to confirm"},f(r.node))}),w=F(()=>he(r.nodeType.value.size,f(r.node))),b=F(()=>{var A;return(A=he(r.nodeType.value.progress,f(r.node)))!=null?A:0}),C=F(()=>ct[be.theme].variables["--background"]),E=F(()=>{var A;return(A=he(r.nodeType.value.outlineColor,f(r.node)))!=null?A:ct[be.theme].variables["--outline"]}),T=F(()=>{var A;return(A=he(r.nodeType.value.fillColor,f(r.node)))!=null?A:ct[be.theme].variables["--raised-background"]}),S=F(()=>he(r.nodeType.value.progressColor,f(r.node))),$=F(()=>{var A;return(A=he(r.nodeType.value.titleColor,f(r.node)))!=null?A:ct[be.theme].variables["--foreground"]}),H=F(()=>he(r.nodeType.value.progressDisplay,f(r.node))),ce=F(()=>r.dragging.value!=null&&f(r.hasDragged)&&he(r.nodeType.value.canAccept,f(r.node),r.dragging.value)),ge=F(()=>he(r.nodeType.value.style,f(r.node))),oe=F(()=>he(r.nodeType.value.classes,f(r.node)));function K(A){t("mouseDown",A,r.node.value,l.value)}function At(A){var pe,xe,Ve;(pe=r.hasDragged)!=null&&pe.value||(t("endDragging",r.node.value),(Ve=(xe=r.nodeType.value).onClick)==null||Ve.call(xe,r.node.value),A.stopPropagation())}return(A,pe)=>{var xe,Ve,I;return x(),M("g",{class:Pe(["boardnode",{[A.node.type]:!0,isSelected:A.isSelected,isDraggable:l.value,...oe.value}]),style:et([{opacity:((xe=A.dragging)==null?void 0:xe.id)===A.node.id&&A.hasDragged?.5:1},(Ve=ge.value)!=null?Ve:[]]),transform:`translate(${u.value.x},${u.value.y})`},[s(Eu,{actions:(I=o.value)!=null?I:[],"is-selected":A.isSelected,node:A.node,"node-type":A.nodeType,"selected-action":A.selectedAction,onClickAction:pe[0]||(pe[0]=j=>t("clickAction",j))},null,8,["actions","is-selected","node","node-type","selected-action"]),m("g",{class:"node-container",onMousedown:K,onTouchstartPassive:K,onMouseup:At,onTouchendPassive:At},[g.value===f(je).Circle?(x(),M("g",Ou,[ce.value?(x(),M("circle",{key:0,class:"receiver",r:w.value+8,fill:C.value,stroke:A.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Au)):G("",!0),m("circle",{class:"body",r:w.value,fill:T.value,stroke:E.value,"stroke-width":4},null,8,Vu),H.value===f(In).Fill?(x(),M("circle",{key:1,class:"progress progressFill",r:Math.max(w.value*b.value-2,0),fill:S.value},null,8,Bu)):(x(),M("circle",{key:2,r:w.value+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(w.value+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(w.value+4.5)*2*Math.PI-b.value*(w.value+4.5)*2*Math.PI,stroke:S.value},null,8,Lu))])):g.value===f(je).Diamond?(x(),M("g",qu,[ce.value?(x(),M("rect",{key:0,class:"receiver",width:w.value*f(i)+16,height:w.value*f(i)+16,transform:`translate(${-(w.value*f(i)+16)/2}, ${-(w.value*f(i)+16)/2})`,fill:C.value,stroke:A.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Ru)):G("",!0),m("rect",{class:"body",width:w.value*f(i),height:w.value*f(i),transform:`translate(${-w.value*f(i)/2}, ${-w.value*f(i)/2})`,fill:T.value,stroke:E.value,"stroke-width":4},null,8,zu),H.value===f(In).Fill?(x(),M("rect",{key:1,class:"progress progressFill",width:Math.max(w.value*f(i)*b.value-2,0),height:Math.max(w.value*f(i)*b.value-2,0),transform:`translate(${-Math.max(w.value*f(i)*b.value-2,0)/2}, ${-Math.max(w.value*f(i)*b.value-2,0)/2})`,fill:S.value},null,8,ju)):(x(),M("rect",{key:2,class:"progress progressDiamond",width:w.value*f(i)+9,height:w.value*f(i)+9,transform:`translate(${-(w.value*f(i)+9)/2}, ${-(w.value*f(i)+9)/2})`,fill:"transparent","stroke-dasharray":(w.value*f(i)+9)*4,"stroke-width":5,"stroke-dashoffset":(w.value*f(i)+9)*4-b.value*(w.value*f(i)+9)*4,stroke:S.value},null,8,Uu))])):g.value===f(je).Square?(x(),M("g",Gu,[ce.value?(x(),M("rect",{key:0,class:"receiver",width:w.value*a+16,height:w.value*a+16,transform:`translate(${-(w.value*a+16)/2}, ${-(w.value*a+16)/2})`,fill:C.value,stroke:A.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Wu)):G("",!0),m("rect",{class:"body",width:w.value*a,height:w.value*a,transform:`translate(${-w.value*a/2}, ${-w.value*a/2})`,fill:T.value,stroke:E.value,"stroke-width":4},null,8,Hu),H.value===f(In).Fill?(x(),M("rect",{key:1,class:"progress progressFill",width:Math.max(w.value*a*b.value-2,0),height:Math.max(w.value*a*b.value-2,0),transform:`translate(${-Math.max(w.value*a*b.value-2,0)/2}, ${-Math.max(w.value*a*b.value-2,0)/2})`,fill:S.value},null,8,Yu)):(x(),M("rect",{key:2,class:"progress progressDiamond",width:w.value*a+9,height:w.value*a+9,transform:`translate(${-(w.value*a+9)/2}, ${-(w.value*a+9)/2})`,fill:"transparent","stroke-dasharray":(w.value*a+9)*4,"stroke-width":5,"stroke-dashoffset":(w.value*a+9)*4-b.value*(w.value*a+9)*4,stroke:S.value},null,8,Zu))])):G("",!0),m("text",{fill:$.value,class:"node-title"},ne(h.value),9,Xu)],32),s(dn,{name:"fade",appear:""},{default:X(()=>{var j;return[p.value?(x(),M("g",Ju,[m("text",{fill:(j=p.value.color)!=null?j:$.value,class:Pe(["node-title",{pulsing:p.value.pulsing}]),y:-w.value-20},ne(p.value.text),11,Ku)])):G("",!0)]}),_:1}),s(dn,{name:"fade",appear:""},{default:X(()=>{var j;return[A.isSelected&&A.selectedAction?(x(),M("text",{key:0,fill:(j=_.value.color)!=null?j:$.value,class:Pe(["node-title",{pulsing:_.value.pulsing}]),y:w.value+75},ne(_.value.text),11,Qu)):G("",!0)]}),_:1})],14,Du)}}});var tc=ke(ec,[["__scopeId","data-v-3697ee2a"]]);const nc={class:"stage",width:"100%",height:"100%"},ic={class:"g1"},ac=se({__name:"Board",props:{nodes:{},types:{},stage:{},state:{},visibility:{},width:{},height:{},style:{},classes:{},links:{},selectedAction:{},selectedNode:{},draggingNode:{},receivingNode:{},mousePosition:{},setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=Ze(e),i=V({x:0,y:0}),a=V({x:0,y:0}),r=V(!1),l=V(!1),o=V(null),u=F(()=>{const b=n.nodes.value.slice();if(n.draggingNode.value){const C=b.splice(b.indexOf(n.draggingNode.value),1)[0];b.push(C)}return b});Dn(()=>{const b=n.draggingNode.value;if(b==null)return null;const C={x:b.position.x+a.value.x,y:b.position.y+a.value.y};let E=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((T,S)=>{if(S.id===b.id)return T;const $=n.types.value[S.type];if(!he($.canAccept,S,b))return T;const ce=Math.pow(C.x-S.position.x,2)+Math.pow(C.y-S.position.y,2);let ge=he($.size,S);return ce>E||ce>ge*ge?T:(E=ce,S)},null))});function g(b){b.setTransformOrigin(null),b.moveTo(o.value.$el.clientWidth/2,o.value.$el.clientHeight/2),n.stage.value=b}function h(b,C=null,E=!1){if(n.draggingNode.value==null){b.preventDefault(),b.stopPropagation();let T,S;if("touches"in b)if(b.touches.length===1)T=b.touches[0].clientX,S=b.touches[0].clientY;else return;else T=b.clientX,S=b.clientY;i.value={x:T,y:S},a.value={x:0,y:0},l.value=!1,r.value=!0,E&&n.setDraggingNode.value(C)}}function p(b){const{x:C,y:E,scale:T}=o.value.panZoomInstance.getTransform();let S,$;if("touches"in b)if(b.touches.length===1)S=b.touches[0].clientX,$=b.touches[0].clientY;else{_(n.draggingNode.value),n.mousePosition.value=null;return}else S=b.clientX,$=b.clientY;n.mousePosition.value={x:(S-C)/T,y:($-E)/T},a.value={x:a.value.x+(S-i.value.x)/T,y:a.value.y+($-i.value.y)/T},i.value={x:S,y:$},(Math.abs(a.value.x)>10||Math.abs(a.value.y)>10)&&(l.value=!0),n.draggingNode.value!=null||r.value&&l.value&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function _(b,C=!1){var E,T;if(n.draggingNode.value!=null&&n.draggingNode.value===b){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(a.value.x/25)*25,n.draggingNode.value.position.y+=Math.round(a.value.y/25)*25);const S=n.nodes.value;S.push(S.splice(S.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((T=(E=n.types.value[n.receivingNode.value.type]).onDrop)==null||T.call(E,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else!l.value&&!C&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null);r.value=!1}function w(b,C){n.state.value.selectedAction===C?f(n.selectedAction).onClick(f(n.selectedNode)):n.state.value={...n.state.value,selectedAction:C}}return(b,C)=>{const E=Yt("panZoom");return f(nn)(b.visibility)?(x(),re(E,{key:0,style:et([{width:b.width,height:b.height},b.style]),class:Pe(b.classes),selector:".g1",options:{initialZoom:1,minZoom:.1,maxZoom:10,zoomDoubleClickSpeed:1},ref_key:"stage",ref:o,onInit:g,onMousemove:p,onTouchmove:p,onMousedown:C[0]||(C[0]=T=>h(T)),onTouchstart:C[1]||(C[1]=T=>h(T)),onMouseup:C[2]||(C[2]=()=>_(f(b.draggingNode))),onTouchendPassive:C[3]||(C[3]=()=>_(f(b.draggingNode))),onMouseleave:C[4]||(C[4]=()=>_(f(b.draggingNode),!0))},{default:X(()=>[(x(),M("svg",nc,[m("g",ic,[s(ai,{name:"link",appear:""},{default:X(()=>[(x(!0),M(W,null,_t(f(b.links)||[],T=>(x(),M("g",{key:`${T.startNode.id}-${T.endNode.id}`},[s(Mu,{link:T,dragging:f(b.draggingNode),dragged:T.startNode===f(b.draggingNode)||T.endNode===f(b.draggingNode)?a.value:void 0},null,8,["link","dragging","dragged"])]))),128))]),_:1}),s(ai,{name:"grow",duration:500,appear:""},{default:X(()=>[(x(!0),M(W,null,_t(u.value,T=>(x(),M("g",{key:T.id,style:{"transition-duration":"0s"}},[s(tc,{node:T,nodeType:b.types[T.type],dragging:f(b.draggingNode),dragged:f(b.draggingNode)===T?a.value:void 0,hasDragged:f(b.draggingNode)==null?!1:l.value,receivingNode:f(b.receivingNode)===T,isSelected:f(b.selectedNode)===T,selectedAction:f(b.selectedNode)===T?f(b.selectedAction):null,onMouseDown:h,onEndDragging:_,onClickAction:S=>w(T,S)},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class"])):G("",!0)}}});We.on("setupVue",e=>na.install(e));const Vi=Symbol("Board");var In=(e=>(e.Outline="Outline",e.Fill="Fill",e))(In||{}),je=(e=>(e.Circle="Circle",e.Diamond="Triangle",e.Square="Square",e))(je||{});function Bi(e){const t=me({nodes:[],selectedNode:null,selectedAction:null},!1);return an(n=>{const i=e.call(n,n);i.id=Xn("board-"),i.type=Vi,i[pn]=ac,i.state?(wo(t),B(i,"state")):(t[Qt]={nodes:i.startNodes().map((o,u)=>(o.id=u,o)),selectedNode:null,selectedAction:null},i.state=t),i.nodes=F(()=>f(l.state).nodes),i.selectedNode=F({get(){return l.nodes.value.find(o=>o.id===f(l.state).selectedNode)||null},set(o){var u,g;Qe(l.state)?l.state.value={...l.state.value,selectedNode:(u=o==null?void 0:o.id)!=null?u:null}:l.state.selectedNode=(g=o==null?void 0:o.id)!=null?g:null}}),i.selectedAction=F({get(){const o=l.selectedNode.value;if(o==null)return null;const u=l.types[o.type];return u.actions==null?null:u.actions.find(g=>g.id===f(l.state).selectedAction)||null},set(o){var u,g;Qe(l.state)?l.state.value={...l.state.value,selectedAction:(u=o==null?void 0:o.id)!=null?u:null}:l.state.selectedAction=(g=o==null?void 0:o.id)!=null?g:null}}),i.mousePosition=V(null),i.links?B(i,"links"):i.links=F(()=>l.selectedAction.value==null?null:l.selectedAction.value.links&&l.selectedNode.value?he(l.selectedAction.value.links,l.selectedNode.value):null),i.draggingNode=V(null),i.receivingNode=V(null),i.stage=V(null),B(i,"visibility"),Ce(i,"visibility",mt.Visible),B(i,"width"),Ce(i,"width","100%"),B(i,"height"),Ce(i,"height","100%"),B(i,"classes"),B(i,"style");for(const o in i.types){const u=i.types[o];if(B(u,"title"),B(u,"label"),B(u,"size"),Ce(u,"size",50),B(u,"style"),B(u,"classes"),B(u,"draggable"),Ce(u,"draggable",!1),B(u,"shape"),Ce(u,"shape","Circle"),B(u,"canAccept"),Ce(u,"canAccept",!1),B(u,"progress"),B(u,"progressDisplay"),Ce(u,"progressDisplay","Fill"),B(u,"progressColor"),Ce(u,"progressColor","none"),B(u,"fillColor"),B(u,"outlineColor"),B(u,"titleColor"),B(u,"actionDistance"),Ce(u,"actionDistance",Math.PI/6),u.nodes=F(()=>f(l.state).nodes.filter(g=>g.type===o)),Ce(u,"onClick",function(g){f(l.state).selectedNode=g.id}),u.actions)for(const g of u.actions)B(g,"visibility"),Ce(g,"visibility",mt.Visible),B(g,"icon"),B(g,"fillColor"),B(g,"tooltip"),B(g,"confirmationLabel"),Ce(g,"confirmationLabel",{text:"Tap again to confirm"}),B(g,"links")}function a(o){i.draggingNode.value=o}function r(o){i.receivingNode.value=o}i.placeInAvailableSpace=function(o,u=100,g=q.Right){const h=l.nodes.value.slice().filter(p=>p===o||(g===q.Down||g===q.Up)&&Math.abs(p.position.x-o.position.x)>u||(g===q.Left||g===q.Right)&&Math.abs(p.position.y-o.position.y)>u?!1:!(g===q.Right&&p.position.x<o.position.x-u||g===q.Left&&p.position.x>o.position.x+u||g===q.Up&&p.position.y>o.position.y+u||g===q.Down&&p.position.y<o.position.y-u)).sort(g===q.Right?(p,_)=>p.position.x-_.position.x:g===q.Left?(p,_)=>_.position.x-p.position.x:g===q.Up?(p,_)=>_.position.y-p.position.y:(p,_)=>p.position.y-_.position.y);for(let p=0;p<h.length;p++){const _=h[p],w=g===q.Right||g===q.Left?Math.abs(o.position.x-_.position.x):Math.abs(o.position.y-_.position.y);if(w<u)g===q.Right?o.position.x=_.position.x+u:g===q.Left?o.position.x=_.position.x-u:g===q.Up?o.position.y=_.position.y-u:g===q.Down&&(o.position.y=_.position.y+u);else if(p>0&&w>u)break}},i[vn]=function(){const{nodes:o,types:u,stage:g,state:h,visibility:p,width:_,height:w,style:b,classes:C,links:E,selectedAction:T,selectedNode:S,mousePosition:$,draggingNode:H,receivingNode:ce}=this;return{nodes:o,types:u,stage:g,state:h,visibility:p,width:_,height:w,style:f(b),classes:C,links:E,selectedAction:T,selectedNode:S,mousePosition:$,draggingNode:H,receivingNode:ce,setDraggingNode:a,setReceivingNode:r}};const l=i;return l})}function he(e,t,...n){return Tn(e)?e(t,...n):f(e)}const un={};We.on("addLayer",e=>{const t=Nr(e,Vi);un[e.id]=e.on("postUpdate",n=>{t.forEach(i=>{Object.values(i.types).forEach(a=>a.nodes.value.forEach(r=>{var l;return(l=a.update)==null?void 0:l.call(a,r,n)}))})})});We.on("removeLayer",e=>{var t;(t=un[e.id])==null||t.call(un),un[e.id]=void 0});const Ne=Symbol("BoardID"),R=Symbol("BoardConnections");function Ot(e,t){e.effects.decay&&(t*=2),e.effects.blazing&&(t*=4),e.health-=t}const rc={name:"Beamer",icon:"\u{1F4A0}",color:"#afcfef",class:"damager",description:"Beams one random enemy on the loop it's on once every a certain amount of time.",baseCost:{energy:100},upgrades:{damage:{name:"Damage",effect:e=>10+2*e,cost:e=>({energy:50*1.2**e}),unit:"/hit"},interval:{name:"Interval",max:15,effect:e=>2*.9**e,cost:e=>({energy:50*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var i,a,r,l;if(t.enemies.length){if(e.data.prg=((i=e.data.prg)!=null?i:0)+n/this.upgrades.interval.effect((a=e.upgrades.interval)!=null?a:0),e.data.prg>=1){let o=t.enemies[Math.floor(Math.random()*t.enemies.length)];Ot(o,this.upgrades.damage.effect((r=e.upgrades.damage)!=null?r:0)),o[R]||(o[R]={}),o[R][(l=t[Ne])!=null?l:0]=0,e.data.prg--}}else e.data.prg=0}},sc={name:"Splatter",icon:"\u{1F539}",color:"#afcfef",class:"damager",description:"Splats one random enemy on the loop it's on at a very fast speed.",baseCost:{energy:150},upgrades:{damage:{name:"Damage",effect:e=>2+1*e,cost:e=>({energy:50*1.3**e}),unit:"/hit"},interval:{name:"Interval",max:5,effect:e=>.5*.8**e,cost:e=>({energy:100*2**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var i,a,r,l;if(t.enemies.length){if(e.data.prg=((i=e.data.prg)!=null?i:0)+n/this.upgrades.interval.effect((a=e.upgrades.interval)!=null?a:0),e.data.prg>=1){let o=t.enemies[Math.floor(Math.random()*t.enemies.length)];Ot(o,this.upgrades.damage.effect((r=e.upgrades.damage)!=null?r:0)),o[R]||(o[R]={}),o[R][(l=t[Ne])!=null?l:0]=0,e.data.prg--}}else e.data.prg=0}},oc={name:"Blaster",icon:"\u{1F537}",color:"#afcfef",class:"damager",description:"Blasts one random enemy on the loop it's on once every a certain amount of time. Takes a while to charge but its damage is scaled to the time since the last blast.",baseCost:{energy:200},upgrades:{damage:{name:"Base Damage",effect:e=>20+4*e,cost:e=>({energy:100*1.2**e}),unit:"/hit"},damage2:{name:"Time Factor",effect:e=>1+e,cost:e=>({energy:200*1.5**e}),unit:"x"},interval:{name:"Interval",max:10,effect:e=>5*.9**e,cost:e=>({energy:100*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var i,a,r,l,o,u;if(t.enemies.length){if(e.data.prg=((i=e.data.prg)!=null?i:0)+n/this.upgrades.interval.effect((a=e.upgrades.interval)!=null?a:0),e.data.time=((r=e.data.time)!=null?r:0)+n,e.data.prg>=1){let g=t.enemies[Math.floor(Math.random()*t.enemies.length)],h=this.upgrades.damage.effect((l=e.upgrades.damage)!=null?l:0)+Math.log(e.data.time+1)*this.upgrades.damage2.effect((o=e.upgrades.damage2)!=null?o:0);Ot(g,h),g[R]||(g[R]={}),g[R][(u=t[Ne])!=null?u:0]=0,e.data.prg--,e.data.time=0}}else e.data.prg=0}},lc={name:"Hourglass",icon:"\u23F3",color:"#afcfef",class:"damager",description:"A beamer whose damage is scaled based on time since it was placed. You can not upgrade the damage, only the interval.",baseCost:{energy:200},upgrades:{interval:{name:"Interval",max:15,effect:e=>2*.9**e,cost:e=>({energy:100*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var i,a,r,l;if(t.enemies.length){if(e.data.prg=((i=e.data.prg)!=null?i:0)+n/this.upgrades.interval.effect((a=e.upgrades.interval)!=null?a:0),e.data.time=((r=e.data.time)!=null?r:0)+n,e.data.prg>=1){let o=t.enemies[Math.floor(Math.random()*t.enemies.length)],u=10+2*Math.sqrt(e.data.time+1);Ot(o,u),o[R]||(o[R]={}),o[R][(l=t[Ne])!=null?l:0]=0,e.data.prg--}}else e.data.prg=0}},uc={name:"Plasma",icon:"\u26AA",color:"#efbfbf",class:"damager",description:"Deal damage per second to all enemies on the loop it's on.",baseCost:{energy:300},upgrades:{damage:{name:"Damage",effect:e=>8+2*e,cost:e=>({energy:200*1.2**e}),unit:"/s"}},onUpdate(e,t,n){var a,r;let i=this.upgrades.damage.effect((a=e.upgrades.damage)!=null?a:0);for(let l of t.enemies)Ot(l,i*n),l[R]||(l[R]={}),l[R][(r=t[Ne])!=null?r:0]=0}},cc={name:"Bomber",icon:"\u{1F4A3}",color:"#efbfbf",class:"damager",description:"Deal damage to all enemies on the loop it's on every once in a while.",baseCost:{energy:400},upgrades:{damage:{name:"Damage",effect:e=>18+3*e,cost:e=>({energy:200*1.2**e}),unit:"/hit"},interval:{name:"Interval",max:15,effect:e=>2.5*.9**e,cost:e=>({energy:300*1.3**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var i,a,r,l;if(t.enemies.length){if(e.data.prg=((i=e.data.prg)!=null?i:0)+n/this.upgrades.interval.effect((a=e.upgrades.interval)!=null?a:0),e.data.prg>=1){let o=this.upgrades.damage.effect((r=e.upgrades.damage)!=null?r:0);for(let u of t.enemies)Ot(u,o),u[R]||(u[R]={}),u[R][(l=t[Ne])!=null?l:0]=0}}else e.data.prg=0}},dc={name:"Thunder",icon:"\u{1F329}\uFE0F",color:"#efefaf",class:"damager",description:"Deals huge damage to enemies at a very fast speed, but requires an amount of Energy equal to its damage. Attacks of this building also make enemies lose all their Energy drop.",baseCost:{energy:500},upgrades:{damage:{name:"Damage",effect:e=>20+4*e,cost:e=>({energy:250*1.3**e}),unit:"/hit"},interval:{name:"Interval",max:5,effect:e=>.5*.8**e,cost:e=>({energy:400*2**e}),precision:2,unit:"s"}},onUpdate(e,t,n){var a,r,l,o;let i=this.upgrades.damage.effect((a=e.upgrades.damage)!=null?a:0);if(t.enemies.length&&Xt.resources.energy.value>=i){if(e.data.prg=((r=e.data.prg)!=null?r:0)+n/this.upgrades.interval.effect((l=e.upgrades.interval)!=null?l:0),e.data.prg>=1){let u=t.enemies[Math.floor(Math.random()*t.enemies.length)];Ot(u,i),u[R]||(u[R]={}),u[R][(o=t[Ne])!=null?o:0]=0,e.data.prg--,Xt.resources.energy.value-=i,u.loot.energy=0}}else e.data.prg=0}},fc={name:"Pins",icon:"\u{1F4CD}",color:"#afafaf",class:"damager",description:"Deals a flat 20 damage to an enemy when one enters the loop it's on. Only has 20 uses before it vanishes. This building is not sellable and will not reverse its cost scaling when vanished.",baseCost:{energy:75},upgrades:{},onEnemyEnter(e,t,n){var i,a;Ot(n,20),e.data.uses=((i=e.data.uses)!=null?i:0)+1,e.data.uses>=20&&delete t.building,n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}},gc={name:"Freezer",icon:"\u2744\uFE0F",color:"#afcfef",class:"effector",description:`Apply the "Freezing" effect to enemies when one moves out of the loop it's on. Freezed enemies' speed are halved. If the enemy has the "Blazing" effect, removes it.`,baseCost:{energy:500},upgrades:{duration:{name:"Duration",effect:e=>2+.4*e,cost:e=>({energy:300*1.4**e}),precision:1,unit:"rad"}},onEnemyExit(e,t,n){var i,a;n.effects.duality||delete n.effects.blaze,n.effects.freeze=this.upgrades.duration.effect((i=e.upgrades.duration)!=null?i:0),n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}},mc={name:"Igniter",icon:"\u{1F525}",color:"#efafaf",class:"effector",description:`Apply the "Blazing" effect to enemies when one moves in to the loop it's on. Blazed enemies move twice as fast but receive four times the damage. If the enemy has the "Freezing" effect, removes it.`,baseCost:{energy:600},upgrades:{duration:{name:"Duration",effect:e=>8+2*e,cost:e=>({energy:350*1.4**e}),unit:"rad"}},onEnemyEnter(e,t,n){var i,a;n.effects.duality||delete n.effects.freeze,n.effects.blaze=this.upgrades.duration.effect((i=e.upgrades.duration)!=null?i:0),n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}},pc={name:"Zen Pagoda",icon:"\u262F\uFE0F",color:"#efefef",class:"effector",description:`Apply the "Duality" effect to enemies when one moves in to the loop it's on. The "Duality" effect allows enemies to have the "Freezing" and "Blazing" effect at the same time.`,baseCost:{energy:500},upgrades:{duration:{name:"Duration",effect:e=>8+4*e,cost:e=>({energy:400*1.4**e}),unit:"rad"}},onEnemyEnter(e,t,n){var i,a;n.effects.duality=this.upgrades.duration.effect((i=e.upgrades.duration)!=null?i:0),n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}},vc={name:"Decayer",icon:"\u2620\uFE0F",color:"#cfafef",class:"effector",description:`Apply the "Decay" effect to enemies when one moves in to the loop it's on. Decaying enemies take twice as much damage.`,baseCost:{energy:700},upgrades:{duration:{name:"Duration",effect:e=>5+1*e,cost:e=>({energy:400*1.4**e}),unit:"rad"}},onEnemyEnter(e,t,n){var i,a;n.effects.decay=this.upgrades.duration.effect((i=e.upgrades.duration)!=null?i:0),n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}},hc={name:"Splitter",icon:"\u2194\uFE0F",color:"#efafef",class:"effector",description:"Enemies have a chance to split upon entering the loop the building is on.",baseCost:{energy:300},upgrades:{chance:{name:"Chance",max:10,effect:e=>25+5*e,cost:e=>({energy:200*1.6**e}),unit:"%"}},onEnemyEnter(e,t,n){var i,a;if(Math.random()<this.upgrades.chance.effect((i=e.upgrades.chance)!=null?i:0)/100){let r={angle:n.angle,speed:-n.speed,health:n.health/=2,maxHealth:n.maxHealth/=2,lifetime:0,effects:{...n.effects},loot:{}};for(let l in n.loot)r.loot[l]=n.loot[l]/=2;t.enemies.push(r),n[R]||(n[R]={}),n[R][(a=t[Ne])!=null?a:0]=0}}},bc={name:"Stablizer",icon:"\u{1F518}",color:"#afefaf",class:"effector",description:"Reduces the lifespan of an enemy when one moves to the loop it's on, down to an upgradable minimum, therefore reduces the stress load.",baseCost:{energy:500},upgrades:{amount:{name:"Amount",effect:e=>2+.5*e,cost:e=>({energy:200*1.4**e}),precision:1,unit:"rad"},min:{name:"Minimum",max:20,effect:e=>20-e,cost:e=>({energy:300*1.2**e}),unit:"rad"}},onEnemyEnter(e,t,n){var a,r,l;let i=this.upgrades.min.effect((a=e.upgrades.min)!=null?a:0);n.lifetime>i&&(n.lifetime=Math.max(i,n.lifetime-this.upgrades.amount.effect((r=e.upgrades.amount)!=null?r:0)),n[R]||(n[R]={}),n[R][(l=t[Ne])!=null?l:0]=0)}},yc={name:"Energizer",icon:"\u26A1",color:"#efefaf",class:"generator",description:"Infuse enemies with Energy while they are on the loop it's on, resulting in them dropping more Energy when defeated. Scales with base enemy speed.",baseCost:{energy:200},upgrades:{amount:{name:"Amount",effect:e=>2+e*(e+1)/2,cost:e=>({energy:400*3**e}),unit:"/rad"}},onUpdate(e,t,n){var a,r,l;let i=this.upgrades.amount.effect((a=e.upgrades.amount)!=null?a:0);for(let o of t.enemies)o.loot.energy=((r=o.loot.energy)!=null?r:0)+i*n*Math.abs(o.speed),o[R]||(o[R]={}),o[R][(l=t[Ne])!=null?l:0]=0}},_c={name:"Multiplier",icon:"\u2716\uFE0F",color:"#efefaf",class:"generator",description:"When an enemy enters the loop its on, if an enemy's Energy drop is in a certain threshold or below, double the Energy drop.",baseCost:{energy:800},upgrades:{threshold:{name:"Threshold",effect:e=>200+50*e,cost:e=>({energy:500*3**e})}},onEnemyEnter(e,t,n){var a,r;let i=this.upgrades.threshold.effect((a=e.upgrades.threshold)!=null?a:0);n.loot.energy<=i&&(n.loot.energy*=2,n[R]||(n[R]={}),n[R][(r=t[Ne])!=null?r:0]=0)}},wc={name:"Observer",icon:"\u{1F441}\uFE0F",color:"#efafcf",class:"generator",description:"Generates Information while an enemy is on the loop it's on. Use Information to purchase global upgrades.",baseCost:{energy:400},upgrades:{amount:{name:"Amount",effect:e=>1+e,cost:e=>({energy:400*2**e}),unit:"/s"}},onUpdate(e,t,n){var a,r,l;let i=this.upgrades.amount.effect((a=e.upgrades.amount)!=null?a:0);for(let o of t.enemies)o.loot.info=((r=o.loot.info)!=null?r:0)+i*n,o[R]||(o[R]={}),o[R][(l=t[Ne])!=null?l:0]=0}};var ti=Object.freeze(Object.defineProperty({__proto__:null,beamer:rc,splatter:sc,blaster:oc,hourglass:lc,plasma:uc,bomber:cc,thunder:dc,pins:fc,freezer:gc,igniter:mc,pagoda:pc,decayer:vc,splitter:hc,stablizer:bc,energizer:yc,multiplier:_c,observer:wc},Symbol.toStringTag,{value:"Module"}));const zn=ti,Cc={shape:je.Circle,size:50,title:"",classes:{loop:!0}},Nc={shape:je.Circle,size:8,title:"",classes:{enemy:!0}},kc={shape:e=>{var t;return{damager:je.Circle,effector:je.Diamond,generator:je.Square}[(t=zn[e.state.target.type])==null?void 0:t.class]},size:30,title:e=>{var t;return(t=zn[e.state.target.type])==null?void 0:t.icon},fillColor:e=>{var t;return(t=zn[e.state.target.type])==null?void 0:t.color},classes:{building:!0}};var xc=Object.freeze(Object.defineProperty({__proto__:null,loop:Cc,enemy:Nc,building:kc},Symbol.toStringTag,{value:"Module"}));const Sc={key:0},Mc={key:0,class:"mark star"},Ic=["src"],$c=se({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>t.mark?(x(),M("div",Sc,[t.mark===!0?(x(),M("div",Mc)):(x(),M("img",{key:1,class:"mark",src:t.mark},null,8,Ic))])):G("",!0)}});var Li=ke($c,[["__scopeId","data-v-2207999f"]]);const Tc=se({__name:"Node",props:{id:{}},setup(e){const n=Ze(e),i=ri(Kn,()=>{}),a=ri(Qn,()=>{}),r=tn(null),l=F(()=>r.value&&r.value.parentElement);return gt([l,n.id],([o,u],[g,h])=>{g&&a(f(h)),o&&i(u,o)}),mi(()=>a(f(n.id))),(o,u)=>(x(),M("div",{class:"node",ref_key:"node",ref:r},null,512))}});var qi=ke(Tc,[["__scopeId","data-v-a48cb382"]]);const Pc=se({props:{progress:{type:fe(String,Object,Number),required:!0},width:{type:fe(Number),required:!0},height:{type:fe(Number),required:!0},direction:{type:fe(String),required:!0},display:fe(Object,String,Function),visibility:{type:fe(Number,Boolean),required:!0},style:fe(Object,String,Array),classes:fe(Object),borderStyle:fe(Object,String,Array),textStyle:fe(Object,String,Array),baseStyle:fe(Object,String,Array),fillStyle:fe(Object,String,Array),mark:fe(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:Li,Node:qi},setup(e){const{progress:t,width:n,height:i,direction:a,display:r}=Ze(e),l=F(()=>{let g=t.value instanceof c?t.value.toNumber():Number(t.value);return(1-Math.min(Math.max(g,0),1))*100}),o=F(()=>{const g={width:ot(n)+1+"px",height:ot(i)+.5+"px"};switch(f(a)){case q.Up:g.clipPath=`inset(${l.value}% 0% 0% 0%)`,g.width=ot(n)+1+"px";break;case q.Down:g.clipPath=`inset(0% 0% ${l.value}% 0%)`,g.width=ot(n)+1+"px";break;case q.Right:g.clipPath=`inset(0% ${l.value}% 0% 0%)`;break;case q.Left:g.clipPath=`inset(0% 0% 0% ${l.value}%)`;break;case q.Default:g.clipPath="inset(0% 50% 0% 0%)";break}return g}),u=hn(r);return{normalizedProgress:l,barStyle:o,component:u,unref:f,Visibility:mt,isVisible:nn,isHidden:Ni}}});function Fc(e,t,n,i,a,r){var u,g,h,p,_,w,b;const l=Yt("MarkNode"),o=Yt("Node");return e.isVisible(e.visibility)?(x(),M("div",{key:0,style:et([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px",visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:{}]),class:Pe({bar:!0,...e.unref(e.classes)})},[m("div",{class:"overlayTextContainer border",style:et([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(g=e.unref(e.borderStyle))!=null?g:{}])},[e.component?(x(),M("span",{key:0,class:"overlayText",style:et(e.unref(e.textStyle))},[(x(),re(at(e.component)))],4)):G("",!0)],4),m("div",{class:"border",style:et([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(h=e.unref(e.style))!=null?h:{},(p=e.unref(e.baseStyle))!=null?p:{},(_=e.unref(e.borderStyle))!=null?_:{}])},[m("div",{class:"fill",style:et([e.barStyle,(w=e.unref(e.style))!=null?w:{},(b=e.unref(e.fillStyle))!=null?b:{}])},null,4)],4),s(l,{mark:e.unref(e.mark)},null,8,["mark"]),s(o,{id:e.id},null,8,["id"])],6)):G("",!0)}var Ec=ke(Pc,[["render",Fc],["__scopeId","data-v-368a68be"]]);const Dc=Symbol("Bar");function jn(e,...t){const n=t.reduce((i,a)=>{var r;return Object.assign(i,(r=a.getPersistentData)==null?void 0:r.call(a))},{});return an(i=>{var l,o;const a=e.call(i,i);a.id=Xn("bar-"),a.type=Dc,a[pn]=Ec;for(const u of t)(l=u.preConstruct)==null||l.call(u,a);Object.assign(a,n),B(a,"visibility"),Ce(a,"visibility",mt.Visible),B(a,"width"),B(a,"height"),B(a,"direction"),B(a,"style"),B(a,"classes"),B(a,"borderStyle"),B(a,"baseStyle"),B(a,"textStyle"),B(a,"fillStyle"),B(a,"progress"),B(a,"display"),B(a,"mark");for(const u of t)(o=u.postConstruct)==null||o.call(u,a);const r=t.reduce((u,g)=>{var h;return Object.assign(u,(h=g.getGatheredProps)==null?void 0:h.call(g,a))},{});return a[vn]=function(){const{progress:u,width:g,height:h,direction:p,display:_,visibility:w,style:b,classes:C,borderStyle:E,textStyle:T,baseStyle:S,fillStyle:$,mark:H,id:ce}=this;return{progress:u,width:g,height:h,direction:p,display:_,visibility:w,style:f(b),classes:C,borderStyle:E,textStyle:T,baseStyle:S,fillStyle:$,mark:H,id:ce,...r}},a})}var Oc=se({props:{display:{type:fe(Object,String,Function),required:!0},visibility:{type:fe(Number,Boolean),required:!0},style:fe(Object,String,Array),classes:fe(Object),onClick:Function,onHold:Function,canClick:{type:fe(Boolean),required:!0},small:Boolean,mark:fe(Boolean,String),id:{type:String,required:!0}},components:{Node:qi,MarkNode:Li},setup(e){const{display:t,onClick:n,onHold:i}=Ze(e),a=tn("");Dn(()=>{var h;const o=ot(t);if(o==null){a.value="";return}if(An(o)){a.value=Ge(o);return}const u=Ge((h=o.title)!=null?h:"","h3"),g=Ge(o.description,"div");a.value=Ge(we(()=>s("span",null,[o.title!=null?s("div",null,[s(u,null,null)]):null,s(g,null,null)])))});const{start:r,stop:l}=Dr(n,i);return{start:r,stop:l,comp:a,Visibility:mt,isVisible:nn,isHidden:Ni,unref:f}}});function Ac(e,t,n,i,a,r){var u;const l=Yt("MarkNode"),o=Yt("Node");return e.isVisible(e.visibility)?(x(),M("button",{key:0,style:et([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(u=e.unref(e.style))!=null?u:[]]),onClick:t[0]||(t[0]=(...g)=>e.onClick&&e.onClick(...g)),onMousedown:t[1]||(t[1]=(...g)=>e.start&&e.start(...g)),onMouseleave:t[2]||(t[2]=(...g)=>e.stop&&e.stop(...g)),onMouseup:t[3]||(t[3]=(...g)=>e.stop&&e.stop(...g)),onTouchstartPassive:t[4]||(t[4]=(...g)=>e.start&&e.start(...g)),onTouchendPassive:t[5]||(t[5]=(...g)=>e.stop&&e.stop(...g)),onTouchcancelPassive:t[6]||(t[6]=(...g)=>e.stop&&e.stop(...g)),class:Pe({feature:!0,clickable:!0,can:e.unref(e.canClick),locked:!e.unref(e.canClick),small:e.small,...e.unref(e.classes)})},[e.unref(e.comp)?(x(),re(at(e.unref(e.comp)),{key:0})):G("",!0),s(l,{mark:e.unref(e.mark)},null,8,["mark"]),s(o,{id:e.id},null,8,["id"])],38)):G("",!0)}var Vc=ke(Oc,[["render",Ac],["__scopeId","data-v-433a7f81"]]);function qt(e){return an(t=>{var i;const n=e.call(t,t);return n.partialDisplay=a=>s("span",{style:f(n.requirementMet)?"":"color: var(--danger)"},[gi(n.resource,n.cost instanceof d?Mn(n.cost,a!=null?a:1,f(n.cumulativeCost),f(n.directSum)):f(n.cost))," ",n.resource.displayName]),n.display=a=>s("div",null,[f(n.requiresPay)?"Costs: ":"Requires: ",gi(n.resource,n.cost instanceof d?Mn(n.cost,a!=null?a:1,f(n.cumulativeCost),f(n.directSum)):f(n.cost))," ",n.resource.displayName]),B(n,"visibility"),Ce(n,"visibility",mt.Visible),B(n,"cost"),B(n,"requiresPay"),Ce(n,"requiresPay",!0),B(n,"cumulativeCost"),Ce(n,"cumulativeCost",!0),B(n,"maxBulkAmount"),Ce(n,"maxBulkAmount",1),B(n,"directSum"),Ce(n,"pay",function(a){const r=n.cost instanceof d?Mn(n.cost,a!=null?a:1,f(n.cumulativeCost),f(n.directSum)):f(n.cost);n.resource.value=c.sub(n.resource.value,r).max(0)}),n.canMaximize=F(()=>{var o;if(!(n.cost instanceof d))return!1;const a=f(n.maxBulkAmount);if(c.lte(a,1))return!1;const r=f(n.cumulativeCost),l=(o=f(n.directSum))!=null?o:r?10:0;return c.lte(a,l)?!0:!(!n.cost.isInvertible()||r===!0&&!n.cost.isIntegrable())}),n.cost instanceof d?n.requirementMet=bo(n.cost,n.resource,(i=n.cumulativeCost)!=null?i:!0,n.directSum,n.maxBulkAmount):n.requirementMet=F(()=>c.gte(n.resource.value,f(n.cost))?1:0),n})}function Bc(e){return an(()=>({requirementMet:F(()=>nn(e.visibility)),visibility:mt.None,requiresPay:!1}))}function Ri(e){if(Pt(e))return e.every(Ri);const t=f(e.requirementMet);return typeof t=="boolean"?t:c.gt(t,0)}function zi(e){if(Pt(e))return e.map(zi).reduce(c.min);const t=f(e.requirementMet);return typeof t=="boolean"?t?c.dInf:0:c.gt(t,1)&&f(e.canMaximize)!==!0?1:t}function ji(e,t=1){var n,i;if(Pt(e)&&(e=e.filter(a=>nn(a.visibility)),e.length===1&&(e=e[0])),Pt(e)){e=e.filter(l=>"partialDisplay"in l);const a=e.filter(l=>f(l.requiresPay)),r=e.filter(l=>!f(l.requiresPay));return s(W,null,[a.length>0?s("div",null,[y("Costs:")," ",di(a.map(l=>l.partialDisplay(t)),s(W,null,[y(", ")]))]):null,r.length>0?s("div",null,[y("Requires:")," ",di(r.map(l=>l.partialDisplay(t)),s(W,null,[y(", ")]))]):null])}return(i=(n=e.display)==null?void 0:n.call(e))!=null?i:s(W,null,null)}function Lc(e,t=1){var n;Pt(e)?e.filter(i=>f(i.requiresPay)).forEach(i=>{var a;return(a=i.pay)==null?void 0:a.call(i,t)}):f(e.requiresPay)&&((n=e.pay)==null||n.call(e,t))}const qc=Symbol("Repeatable");function Rt(e,...t){const n=me(0),i=t.reduce((a,r)=>{var l;return Object.assign(a,(l=r.getPersistentData)==null?void 0:l.call(r))},{});return an(a=>{var _,w,b;const r=e.call(a,a);r.id=Xn("repeatable-"),r.type=qc,r[pn]=Vc;for(const C of t)(_=C.preConstruct)==null||_.call(C,r);r.amount=n,r.amount[Qt]=(w=r.initialAmount)!=null?w:0,Object.assign(r,i);const l={requirementMet:F(()=>c.sub(f(r.limit),r.amount.value)),requiresPay:!1,visibility:mt.None,canMaximize:!0},o=Bc(r);Pt(r.requirements)?(r.requirements.unshift(o),r.requirements.push(l)):r.requirements=[o,r.requirements,l],r.maxed=F(()=>c.gte(r.amount.value,f(r.limit))),B(r,"classes");const u=r.classes;r.classes=F(()=>{const C=f(u)||{};return r.maxed.value&&(C.bought=!0),C}),r.amountToIncrease=F(()=>c.clampMin(zi(r.requirements),1)),r.canClick=F(()=>Ri(r.requirements));const g=r.onClick;r.onClick=function(C){var S;const E=r;if(!f(E.canClick))return;const T=(S=f(r.amountToIncrease))!=null?S:1;Lc(r.requirements,T),E.amount.value=c.add(E.amount.value,T),g==null||g(C)},B(r,"display");const h=r.display;r.display=we(()=>{var E,T,S;const C=f(h);if(An(C)){const $=Ge(C);return s($,null,null)}if(C!=null){const $=r,H=Ge((E=C.title)!=null?E:"","h3"),ce=Ge((T=C.description)!=null?T:""),ge=Ge((S=C.effectDisplay)!=null?S:"");return s("span",null,[C.title==null?null:s("div",null,[s(H,null,null)]),C.description==null?null:s(ce,null,null),C.showAmount===!1?null:s("div",null,[s("hr",null,null),s(W,null,[y("Amount: "),_e($.amount.value)]),c.isFinite(f($.limit))?s(W,null,[y(" / "),_e(f($.limit))]):void 0]),C.effectDisplay==null?null:s("div",null,[s("hr",null,null),y("Currently: "),s(ge,null,null)]),$.maxed.value?null:s("div",null,[s("hr",null,null),ji($.requirements,f(r.amountToIncrease))])])}return""}),B(r,"visibility"),Ce(r,"visibility",mt.Visible),B(r,"limit"),Ce(r,"limit",c.dInf),B(r,"style"),B(r,"mark"),B(r,"small");for(const C of t)(b=C.postConstruct)==null||b.call(C,r);const p=t.reduce((C,E)=>{var T;return Object.assign(C,(T=E.getGatheredProps)==null?void 0:T.call(E,r))},{});return r[vn]=function(){const{display:C,visibility:E,style:T,classes:S,onClick:$,canClick:H,small:ce,mark:ge,id:oe}=this;return{display:C,visibility:E,style:f(T),classes:S,onClick:$,canClick:H,small:ce,mark:ge,id:oe,...p}},r})}const Le=ti,Rc="game";function xn(e){let[t,n]=e.split("x");return{x:+t,y:+n}}function Ae(e,t){return e+"x"+t}var Je=function(e){return e.New="",e.Started="start",e.Stopped="stop",e.Idle="idle",e}(Je||{});const Xt=ei(Rc,function(){const e="Game",t=me(0),n=me(0),i=me(0),a=V(0),r=me({}),l=me(0),o={energy:En(0,"Energy"),info:En(0,"Info")},u=Object.fromEntries(Object.entries(o).map(([N,D])=>[N,Ai(D)])),g=me(0),h=me({});function p(N){var D;return 1.1**(g.value+((D=h.value[N])!=null?D:0))}const _=me("",!1),w=me(0),b=V(!1),C=V(!1),E=me(0),T=V(0),S={stress:Rt(N=>({display:we(()=>s(W,null,[y("Level "),ue(N.amount.value),s("br",null,null),s("h3",null,[y("Stress")]),s("hr",null,null),y("\u2191 "),ue(c.add(N.amount.value,101)),y("% \u2191"),s("br",null,null),ue(c.add(N.amount.value,100)),y("%"),s("br",null,null),s("hr",null,null),ji(S.stress.requirements)])),requirements:qt(()=>({resource:nt(o.info),cost:d.variable(N.amount).pow_base(1.1).mul(100)}))}))};function $(){t.value=0,n.value=0,o.energy.value=c.mul(de.upgrades.startEnergy.amount.value,25).add(de.getCapsuleEffect("energy")).add(100).toNumber(),o.info.value,Kt(()=>{u.energy.value=u.info.value=0}),g.value=0,h.value={},l.value=0,_.value=Je.Started,w.value=1,C.value=!1;for(let D of Object.values(S))D.amount.value=0;switch(E.value=0,de.selectedGameMode.value){case"standard":i.value=100;break;case"boosted":i.value=50;break;case"hardcore":i.value=Number.EPSILON;break}let N=()=>setTimeout(()=>{K.stage.value?(K.stage.value.getTransform(),K.stage.value.zoomAbs(window.innerWidth/2,window.innerHeight/2,1),K.stage.value.moveTo(window.innerWidth/2,window.innerHeight/2)):N()},0);N(),r.value={"0x0":{enemies:[{angle:0,lifetime:0,speed:Number.EPSILON,health:20,maxHealth:20,effects:{},loot:{energy:100}}]}}}function H(){_.value=Je.Stopped,w.value=.1,de.bestCycle[de.selectedGameMode.value].value=Math.max(de.bestCycle[de.selectedGameMode.value].value,t.value);let N={x:0,y:0},D={x:0,y:0};for(let ae in r.value){let{x:Se,y:Xe}=xn(ae);N.x=Math.min(N.x,Se),N.y=Math.min(N.y,Xe),D.x=Math.max(D.x,Se),D.y=Math.max(D.y,Xe)}let L=(N.x+D.x)*-50,z=(N.y+D.y)*-50,Z=Math.min(window.innerWidth/(D.x-N.x+1)/120,window.innerHeight/(D.y-N.y+1)/120,1),te=()=>setTimeout(()=>{K.stage.value?(K.stage.value.smoothMoveTo(L+window.innerWidth/2,z+window.innerHeight/2),K.stage.value.smoothZoomAbs(window.innerWidth/2,window.innerHeight/2,Z)):te()},0);te(),setTimeout(()=>{for(let ae of f(K.state).nodes)ae.state.velocity={x:Math.random()*450-225,y:Math.random()*-450}},3e3),setTimeout(()=>{T.value=Math.sqrt(t.value)*Math.sqrt(l.value/60)*(1+de.getCapsuleEffect("xp")/100)*Object.values(u).reduce((ae,Se)=>ae+Math.log10(new c(Se.value).toNumber()+1),1),T.value*=ut[de.selectedGameMode.value].multiplier,bt.value=!0},6e3)}function ce(){let N=1+.1*t.value+.01*t.value*t.value;N=Math.floor(N)+(Math.random()<N%1?1:0);let D=Object.values(r.value);if(D.length<=0)return;o.info.value=+o.info.value;let L=1;switch(de.selectedGameMode.value){case"standard":L=1;break;case"boosted":L=2;break;case"hardcore":L=3;break}for(let z=0;z<N;z++){let Z=18*1.05**(t.value*L)*(Math.random()*.2+.9);D[Math.floor(Math.random()*D.length)].enemies.push({angle:Math.random(),lifetime:0,speed:(Math.random()*.4+.8+.05*t.value)*(Math.random()<.5?1:-1),health:Z,maxHealth:Z,effects:{},loot:{energy:25}})}}function ge(){let N=Object.entries(r.value),D="";for(;N.length;){let L=Math.floor(Math.random()*N.length),z=N[L],{x:Z,y:te}=xn(z[0]),ae=[];if(r.value[Ae(Z+1,te)]||ae.push(Ae(Z+1,te)),r.value[Ae(Z-1,te)]||ae.push(Ae(Z-1,te)),r.value[Ae(Z,te+1)]||ae.push(Ae(Z,te+1)),r.value[Ae(Z,te-1)]||ae.push(Ae(Z,te-1)),ae.length){D=ae[Math.floor(Math.random()*ae.length)];break}else N.splice(L,1)}r.value[D]={enemies:[]}}We.on("onLoad",()=>{_.value==Je.New?$():_.value==Je.Stopped&&H()}),We.on("update",N=>{var D,L,z,Z,te,ae,Se,Xe,st,xt,St,Mt;if(_.value==Je.Started){if(w.value<=0||b.value)return;N*=w.value,l.value+=N,E.value-=N,t.value>=1&&(n.value+=N/(15+Math.sqrt(t.value)),n.value>=1&&(n.value--,t.value++,ce(),(t.value+1)%2==0&&ge()));let Ue=!1,Ee=!0;for(let J of Object.values(r.value))Ue||(Ue=J.enemies.length>0),Ee&&(Ee=!J.building||Le[J.building.type].class!="damager");if(Ue||(n.value=0,t.value++,ce(),(t.value+1)%2==0&&ge()),Ee&&!C.value){for(let J of de.selectedBuildings.value)if(Le[J].class=="damager"&&tt(J)){Ee=!1;break}Ee&&(de.objectives.value.stucked=(D=de.objectives.value.stucked)!=null?D:0,C.value=!0,setTimeout(()=>{b.value=!1,H()},3e3))}let ye=[];a.value=0;for(let J in r.value){let $e=r.value[J],{x:Oe,y:Be}=xn(J);for(let Q of $e.enemies){let ii=Q.angle,sn=Q.speed*.1*N;Q.effects.freeze&&(sn*=.5),Q.effects.blaze&&(sn*=2),Q.angle+=sn,Q.lifetime+=Math.abs(sn),a.value+=Q.lifetime,Q.angle=(Q.angle%1+1)%1;let[Cn,Nn]=[Math.min(ii,Q.angle),Math.max(ii,Q.angle)];if(Q.health<=0){$e.enemies.splice($e.enemies.indexOf(Q),1);for(let[Vt,Gi]of Object.entries(Q.loot))o[Vt].value+=Gi}Cn<.25&&Nn>.75?r.value[Ae(Oe,Be+1)]&&Math.random()<.5&&(ye.push({enemy:Q,from:r.value[Ae(Oe,Be)],to:r.value[Ae(Oe,Be+1)]}),Q.angle=.5-Q.angle,Q.speed=-Q.speed):Cn<.25&&Nn>.25?r.value[Ae(Oe+1,Be)]&&Math.random()<.5&&(ye.push({enemy:Q,from:r.value[Ae(Oe,Be)],to:r.value[Ae(Oe+1,Be)]}),Q.angle=1-Q.angle,Q.speed=-Q.speed):Cn<.5&&Nn>.5?r.value[Ae(Oe,Be-1)]&&Math.random()<.5&&(ye.push({enemy:Q,from:r.value[Ae(Oe,Be)],to:r.value[Ae(Oe,Be-1)]}),Q.angle=.5-Q.angle,Q.speed=-Q.speed):Cn<.75&&Nn>.75&&r.value[Ae(Oe-1,Be)]&&Math.random()<.5&&(ye.push({enemy:Q,from:r.value[Ae(Oe,Be)],to:r.value[Ae(Oe-1,Be)]}),Q.angle=1-Q.angle,Q.speed=-Q.speed),Q.angle=(Q.angle%1+1)%1;for(let Vt in Q.effects)Q.effects[Vt]-=Math.abs(sn),Q.effects[Vt]<=0&&delete Q.effects[Vt];if(Q[R])for(let Vt in Q[R])Q[R][Vt]-=N}$e.building&&((z=(L=Le[$e.building.type]).onUpdate)==null||z.call(L,$e.building,$e,N))}a.value/=Object.values(r.value).length*10,a.value>1&&(i.value-=2**a.value*N),a.value>=2&&(de.objectives.value.anxiety=(Z=de.objectives.value.anxiety)!=null?Z:0),i.value<=0&&H();for(let J of ye)J.from.enemies.splice(J.from.enemies.indexOf(J.enemy),1),J.to.enemies.push(J.enemy),J.from.building&&((ae=(te=Le[J.from.building.type]).onEnemyExit)==null||ae.call(te,J.from.building,J.from,J.enemy)),J.to.building&&((Xe=(Se=Le[J.to.building.type]).onEnemyEnter)==null||Xe.call(Se,J.to.building,J.to,J.enemy));if(ve.value)if(tt(ve.value)){if(((st=K.selectedNode.value)==null?void 0:st.type)=="loop"){let J=K.selectedNode.value.state.target;if(J.building)f(K.state).selectedNode=null;else{J.building={type:ve.value,upgrades:{},data:{},sellValue:{}};for(let[$e,Oe]of Object.entries(Le[ve.value].baseCost)){let Be=Oe*p(ve.value);o[$e].value-=Be,J.building.sellValue[$e]=Be*.75}for(let $e of J.enemies)(St=(xt=Le[ve.value]).onEnemyEnter)==null||St.call(xt,J.building,J,$e);g.value++,h.value[ve.value]=((Mt=h.value[ve.value])!=null?Mt:0)+1,ve.value=""}}}else ve.value=""}else if(_.value==Je.Stopped){for(let Ue in r.value)for(let Ee of r.value[Ue].enemies)Ee.angle+=.001*N;for(let Ue of f(K.state).nodes){let Ee=Ue.state;Ee.velocity?(Ue.position.x+=Ee.velocity.x*N,Ue.position.y+=Ee.velocity.y*N,Ee.velocity.y+=250*N):(Ue.position.x+=Math.random()*2-1,Ue.position.y+=Math.random()*2-1)}}});let oe=0;const K=Bi(()=>({startNodes:()=>[],state(){var D,L,z,Z,te,ae,Se,Xe,st,xt,St,Mt,Ue;let N=[];{let Ee=[];for(let[ye,J]of Object.entries(r.value)){let{x:$e,y:Oe}=xn(ye);for(let Be of J.enemies)Be[Ne]||(Be[Ne]=oe,oe+=1),Ee.push({...Be,position:{x:$e,y:Oe}});$e=$e*100,Oe=Oe*100,J[Ne]||(J[Ne]=oe,oe+=2),N.push({id:(D=J[Ne])!=null?D:0,position:{x:$e,y:Oe},type:"loop",state:{target:J}}),J.building&&N.push({id:((L=J[Ne])!=null?L:0)+1,position:{x:$e,y:Oe},type:"building",state:{target:J.building}})}for(let ye of Ee){let{x:J,y:$e}=ye.position;N.push({id:(z=ye[Ne])!=null?z:0,position:{x:(J+Math.sin(ye.angle*2*Math.PI)*.5)*100,y:($e+Math.cos(ye.angle*2*Math.PI)*.5)*100},type:"enemy",state:{target:ye}})}}if(_.value==Je.Stopped&&((Z=f(K.state))==null?void 0:Z.nodes.length)>0){let Ee=(te=f(K.state))==null?void 0:te.nodes;for(let ye in N)N[ye].position.x=(Se=(ae=Ee[ye])==null?void 0:ae.position.x)!=null?Se:N[ye].position.x,N[ye].position.y=(st=(Xe=Ee[ye])==null?void 0:Xe.position.y)!=null?st:N[ye].position.y,N[ye].state=(St=(xt=Ee[ye])==null?void 0:xt.state)!=null?St:N[ye].state}return{nodes:N,selectedNode:(Ue=(Mt=f(K.state))==null?void 0:Mt.selectedNode)!=null?Ue:null,selectedAction:null}},links(){let N=[];for(let[D,L]of Object.entries(r.value))for(let z of L.enemies)if(z[R])for(let Z in z[R]){let te=K.nodes.value.find(Se=>Se.id==+Z),ae=K.nodes.value.find(Se=>Se.id==z[Ne]);te&&ae&&N.push({startNode:te,endNode:ae,stroke:"white",strokeWidth:2}),z[R][Z]<=0&&delete z[R][Z]}return N},classes:{"game-board":!0},types:xc})),At=jn(()=>({width:500,height:31,direction:q.Right,progress:F(()=>n.value),display:we(()=>s("span",{class:"bar-label"},[y("Cycle "),ue(t.value)])),fillStyle:{backgroundColor:"#50637c"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),A=jn(()=>({width:249,height:31,direction:q.Right,progress:F(()=>a.value),display:we(()=>s("span",{class:"bar-label left"},[y("Stress: "),ue(a.value*100),y("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderRadius:"0 0 0 4px"}})),pe=jn(()=>({width:249,height:31,direction:q.Left,progress:F(()=>i.value/100),display:we(()=>s("span",{class:"bar-label right"},[y("HP: "),ue(i.value),y("%")])),fillStyle:{backgroundColor:"#ff5c5a"},baseStyle:{backgroundColor:"#0000001f"},borderStyle:{border:"none",borderTop:"2px solid var(--outline)",borderLeft:"2px solid var(--outline)",borderRadius:"0 0 4px 0"}}));let xe=0,Ve=V(!1),I=V(""),j=V(q.Default),O=V({});function Y(N,D,L=q.Default){I.value=N,Ve.value=!0,j.value=L,setTimeout(()=>{var Xe;let z=(Xe=document.querySelector(".game-tooltip"))==null?void 0:Xe.getBoundingClientRect(),Z=D.getBoundingClientRect();if(!z)return;(z.right+z.left)/2,(z.bottom+z.top)/2;let te={x:(Z.right+Z.left)/2,y:(Z.bottom+Z.top)/2},ae=st=>Math.min(Math.max(st,8),window.innerHeight-z.height-8),Se=st=>Math.min(Math.max(st,8),window.innerWidth-z.width-8);L==q.Left?O.value={right:window.innerWidth-(Z.left-12)+"px",top:ae(te.y-z.height/2)+"px"}:L==q.Right?O.value={left:Z.right+12+"px",top:ae(te.y-z.height/2)+"px"}:L==q.Up?O.value={left:Se(te.x-z.width/2)+"px",bottom:window.innerHeight-(Z.top-12)+"px"}:L==q.Down&&(O.value={left:Se(te.x-z.width/2)+"px",top:Z.bottom+12+"px"})},0)}function He(){Ve.value=!1}let ve=V("");function tt(N){if(!Le[N])return!1;let D=p(N);for(let[L,z]of Object.entries(Le[N].baseCost))if(o[L].value<z*D)return!1;return!0}function kt(N,D){var L,z;if(Le[N.type].upgrades[D].max!==void 0&&N.upgrades[D]>=((L=Le[N.type].upgrades[D].max)!=null?L:0)-1)return!1;for(let[Z,te]of Object.entries(Le[N.type].upgrades[D].cost((z=N.upgrades[D])!=null?z:0)))if(o[Z].value<te)return!1;return!0}function ze(N,D){var L,z,Z;if(kt(N,D)){for(let[te,ae]of Object.entries(Le[N.type].upgrades[D].cost((L=N.upgrades[D])!=null?L:0)))o[te].value-=ae,N.sellValue[te]=((z=N.sellValue[te])!=null?z:0)+ae*.5;N.upgrades[D]=((Z=N.upgrades[D])!=null?Z:0)+1}}function ht(N){var D;if(N.building&&N.building.type!="pins"&&E.value<=0){for(let[L,z]of Object.entries(N.building.sellValue))o[L].value+=z,u[L].value=c.sub(u[L].value,z).toNumber();g.value--,h.value[N.building.type]=((D=h.value[N.building.type])!=null?D:0)-1,delete N.building,E.value=c.mul(de.upgrades.sellCooldown.amount.value,-5).add(60).toNumber()}}function yn(N,D,L){xe=setTimeout(()=>{let z=p(L);Y(s(W,null,[s("h3",null,[D.name])," ",s("h5",{style:"display: inline-block; margin: 0"},[s("i",null,[y("- "),D.class.toUpperCase()])]),s("br",null,null),s("i",null,[D.description]),s("hr",null,null),s("h5",null,[y("BUILDING COST:")]),s("div",{class:"stat-entries"},[Object.entries(D.baseCost).map(([Z,te])=>s("div",{class:{red:o[Z].value<te*z}},[s("div",{class:"name"},[o[Z].displayName]),s("div",{class:"value"},[ue(te*z)])]))]),s("hr",null,null),s("h5",null,[y("STARTING SPECS:")]),s("div",{class:"stat-entries"},[Object.entries(D.upgrades).map(([Z,te])=>{var ae,Se;return s("div",null,[s("div",{class:"name"},[te.name]),s("div",{class:"value"},[Re(te.effect(0),(ae=te.precision)!=null?ae:0)+((Se=te.unit)!=null?Se:"")])])})])]),N.target,q.Left)},500)}function _n(N,D,L){clearTimeout(xe),He()}function wn(N,D,L){clearTimeout(xe),He(),tt(L)&&(ve.value=ve.value==L?"":L)}const bt=V(!1);return{name:e,color:"#afcfef",cycle:t,cycleProgress:n,cycleBar:At,health:i,healthBar:pe,gameState:_,gameSpeed:w,sellCooldown:E,upgrades:S,loops:r,buildingFactor:g,buildingFactors:h,resources:o,resourcesTotal:u,lifetime:l,board:K,startGame:$,endGame:H,display:we(()=>s(W,null,[dt(K),s("div",{class:{"game-top":!0,hidden:_.value!=Je.Started||t.value<=0}},[s("div",{style:"display: flex; height: 31px"},[s("span",{class:"bar-label"},[ue(o.energy.value),y(" energy")]),c.gt(u.info.value,0)?s("span",{class:"bar-label"},[ue(o.info.value),y(" info")]):""]),dt(At),s("div",{style:"display: flex"},[dt(A),dt(pe)])]),s("div",{class:{"game-bottom":!0,hidden:_.value!=Je.Started}},[(()=>{var D;let N=(D=K.selectedNode.value)==null?void 0:D.state;return s(W,null,[N?s("div",{style:"display: flex; height: 31px"},[N.target.building?s("div",{class:"building-upgrades",style:{"--layer-color":Le[N.target.building.type].color}},[Object.entries(Le[N.target.building.type].upgrades).map(([L,z])=>{var te,ae,Se,Xe,st,xt,St,Mt,Ue,Ee,ye;let Z=(ae=(te=N==null?void 0:N.target.building)==null?void 0:te.upgrades[L])!=null?ae:0;return Le[(Xe=(Se=N==null?void 0:N.target.building)==null?void 0:Se.type)!=null?Xe:""].upgrades[L].max!==void 0&&Z>=((St=Le[(xt=(st=N==null?void 0:N.target.building)==null?void 0:st.type)!=null?xt:""].upgrades[L].max)!=null?St:0)-1,s("button",{class:{feature:!0,can:kt(N==null?void 0:N.target.building,L)},onClick:()=>ze(N==null?void 0:N.target.building,L)},[y("Level "),ue(Z+1)+(z.max?" / "+ue(z.max):""),s("br",null,null),s("h3",null,[z.name]),s("hr",null,null),y("\u2191 "),Re(z.effect(Z+1),(Mt=z.precision)!=null?Mt:0)+((Ue=z.unit)!=null?Ue:""),y(" \u2191"),s("br",null,null),Re(z.effect(Z),(Ee=z.precision)!=null?Ee:0)+((ye=z.unit)!=null?ye:""),s("br",null,null),s("hr",null,null),Object.entries(z.cost(Z)).map(([J,$e])=>ue($e)+" "+o[J].displayName).join(", ")])}),N.target.building.type=="pins"?"":s("button",{class:{feature:!0,can:E.value<=0},style:"width: 100px; flex-basis: 100px",onClick:()=>ht(N==null?void 0:N.target)},[E.value<=0?s(W,null,[y("Sell for"),s("hr",null,null),Object.entries(N.target.building.sellValue).map(([L,z])=>ue(z)+" "+o[L].displayName).join(", ")]):s(W,null,[y("Sell cooldown"),s("hr",null,null),Gt(E.value)])])]):s("span",{class:"bar-label"},[y("Select a building to build \u2192")])]):c.gt(u.info.value,0)?s("div",{class:"building-upgrades",style:"--layer-color: #afcfef"},[Object.values(S).map(dt)]):"",s("div",{style:"display: flex; height: 31px"},[s("span",null,[N?N.target.building?Le[N.target.building.type].name:s("i",null,[y("No building")]):ve.value?"\u25B2 Select a loop to build \u25B2":"\u25B2 Select a loop from above \u25B2"])])])})()]),s("div",{class:{"game-left":!0,hidden:_.value!=Je.Started||t.value<=0}},[s("div",{class:"action-list"},[s("button",{class:"action",onClick:()=>b.value=!0},[s("div",{class:"background"},[s("div",{class:"icon"},[y("\u2630")])])]),de.selectedGameMode.value=="hardcore"?"":s(W,null,[c.gte(de.upgrades.speedManip.amount.value,1)?s(W,null,[s("button",{class:"action speed",onClick:()=>w.value=0},[s("div",{class:"background"},[s("div",{class:"icon"},[y("\u23F8\uFE0F")])])]),s("button",{class:"action speed",onClick:()=>w.value=1},[s("div",{class:"background"},[s("div",{class:"icon"},[y("\u25B6")])])])]):"",[...Array(c.sub(de.upgrades.speedManip.amount.value,1).max(0).toNumber()).keys()].map(N=>s("button",{class:"action speed",onClick:()=>w.value=N+2},[s("div",{class:"background"},[s("div",{class:"icon"},[N+2,y("x")])])]))])])]),s("div",{class:{"game-right":!0,hidden:_.value!=Je.Started}},[s("div",{class:"building-list"},[de.selectedBuildings.value.map(N=>{let D=Le[N];return s("button",{class:Object.fromEntries([[D.class,!0],["selected",ve.value==N],["disabled",!tt(N)]]),onMouseenter:L=>yn(L,D,N),onMouseleave:L=>_n(),onClick:L=>wn(L,D,N)},[s("div",{class:"background",style:{background:D.color}},[s("div",{class:"icon"},[D.icon])])])})])]),s("div",{class:{"game-tooltip":!0,hidden:!Ve.value,left:j.value==q.Left,right:j.value==q.Right,top:j.value==q.Up,bottom:j.value==q.Down},style:O.value},[I.value]),s(pt,{modelValue:b.value},{header:()=>s(W,null,[s("h1",{class:"result-title"},[y("PAUSED")]),s("h2",{style:"font-style: italic;"},[y("- Operations halted. -")])]),body:()=>s("div",{style:"text-align: center"},[s("div",{class:"result-entry"},[s("div",{class:"name"},[y("Cycles reached")]),s("h1",{class:"value"},[ue(t.value)])]),s("div",{class:"result-entry"},[s("div",{class:"name"},[y("Relative lifetime")]),s("div",{class:"value"},[Gt(l.value)])]),s("div",{style:"width: 75%; margin-top: 10px;"},[s("div",{class:"name"},[y("Total resources gained:")]),s("div",{class:"stat-entries"},[Object.entries(u).filter(([N,D])=>c.gt(D.value,0)).map(([N,D])=>s("div",null,[s("div",{class:"name"},[o[N].displayName]),s("div",{class:"value"},[ue(D.value)])]))||"Nothing :("])])]),footer:()=>s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("button",{class:"feature can",onClick:()=>{setTimeout(()=>{de.points.value=c.add(de.points.value,T.value).toNumber(),bt.value=!1,$()},6001),H(),b.value=!1}},[y("Restart")]),s("button",{class:"feature can",onClick:()=>{setTimeout(()=>{de.points.value=c.add(de.points.value,T.value).toNumber(),_.value=Je.Idle,bt.value=!1,U.tabs=["main"]},6001),H(),b.value=!1}},[y("Forfeit and Return to Hub")]),s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{b.value=!1}},[y("Continue")])])}),s(pt,{modelValue:bt.value},{header:()=>s(W,null,[s("h1",{class:"result-title"},[y("GAME OVER")]),s("h2",{style:"font-style: italic;"},[y("- "),C.value?"You managed to softlock yourself...":"The cycle has been broken.",y(" -")])]),body:()=>s("div",{style:"text-align: center"},[s("div",{class:"result-entry"},[s("div",{class:"name"},[y("Cycles reached")]),s("h1",{class:"value"},[ue(t.value)])]),s("div",{class:"result-entry"},[s("div",{class:"name"},[y("Relative lifetime")]),s("div",{class:"value"},[Gt(l.value)])]),s("div",{style:"width: 75%; margin-top: 10px;"},[s("div",{class:"name"},[y("Total resources gained:")]),s("div",{class:"stat-entries"},[Object.entries(u).filter(([N,D])=>c.gt(D.value,0)).map(([N,D])=>s("div",null,[s("div",{class:"name"},[o[N].displayName]),s("div",{class:"value"},[ue(D.value)])]))||"Nothing :("])]),s("div",{style:"width: 75%; margin-top: 10px;"},[s("div",{class:"name"},[y("Hub rewards:")]),s("div",{class:"stat-entries"},[s("div",null,[s("div",{class:"name"},[y("XP")]),s("div",{class:"value"},[ue(T.value)])])])])]),footer:()=>s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("button",{class:"feature can",onClick:()=>{setTimeout(()=>{de.points.value=c.add(de.points.value,T.value).toNumber(),$()},1e3),bt.value=!1}},[y("Replay")]),s("button",{class:"feature can",onClick:N=>{try{navigator.share({title:"Delooped",text:"I reached Cycle "+ue(t.value)+" on Delooped!",url:"https://ducdat0507.itch.io/delooped"})}catch(D){D instanceof TypeError&&(navigator.clipboard.writeText("I reached Cycle "+ue(t.value)+` on Delooped!
https://ducdat0507.itch.io/delooped`),clearTimeout(xe),N.target.innerText="Copied to clipboard",xe=setTimeout(()=>N.target.innerText="Share",2e3))}}},[y("Share")]),s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{setTimeout(()=>{de.points.value=c.add(de.points.value,T.value).toNumber(),_.value=Je.Idle,U.tabs=["main"]},1e3),bt.value=!1}},[y("Return to Hub")])])})])),minimizable:!1,classes:{game:!0}}}),Me=ti;let ut={standard:{name:"Standard",description:`The default game mode.
Standard rules apply.`,multiplier:1},boosted:{name:"Boosted",description:`Harder enemies.
Less health.`,multiplier:1.5},hardcore:{name:"Hardcore",description:`Hardest enemies.
No speed changes.
Stress = Lethal.`,multiplier:2}},zt=["standard","boosted","hardcore"];const de=ei("main",function(){const e=En(0,"xp"),t=Ai(e),n=En(0,"\u{1F48A}"),i=me(0),a=me("idle",!1);let r={standard:me(0),boosted:me(0),hardcore:me(0)},l=me("standard",!1),o=me({beamer:!0,plasma:!0,freezer:!0,energizer:!0}),u=me(["beamer","plasma","freezer","energizer"]),g=V(""),h={collection:me(!1),research:me(!1),objectives:me(!1),capsules:me(!1)},p={startEnergy:Rt(I=>({display:{title:"Better Funding",description:"Increase the starting Energy budget by 25.",effectDisplay:we(()=>s(W,null,[_e(c.mul(I.amount.value,25).add(100))])),showAmount:!1},limit:9,requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(1.5).mul(200).sub(200)})),style:{width:"225px",padding:"0 10px"}})),maxBuildings:Rt(I=>({display:{title:"Bigger Inventory",description:"Increase the maximum amount of buildings you can equip by 1.",effectDisplay:we(()=>s(W,null,[_e(c.add(I.amount.value,6)),y(" / 14")])),showAmount:!1},limit:8,requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(2).mul(300)})),style:{width:"225px",padding:"0 10px"}})),speedManip:Rt(I=>({display:{title:"Speed Manipulation",description:we(()=>s(W,null,[y("Unlock "),c.gte(I.amount.value,1)?_e(c.add(I.amount.value,1).min(4))+"x / 4x speed change":"pausing",y("."),s("br",null,null),y("Is disabled on certain game modes.")])),showAmount:!1},limit:4,requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(5).mul(200)})),style:{width:"225px",padding:"0 10px"}})),sellCooldown:Rt(I=>({display:{title:"Decommission Machine",description:"Reduce the selling cooldown by 5 seconds.",effectDisplay:we(()=>s(W,null,[_e(c.mul(I.amount.value,-5).add(60)),y("s / 10s")])),showAmount:!1},limit:10,requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(1.5).mul(200)})),style:{width:"225px",padding:"0 10px"}})),capsuleGain:Rt(I=>({display:{title:"Capsule Productor",description:"Increase capsule's production speed by 1%.",effectDisplay:we(()=>s(W,null,[y("+"),_e(I.amount.value),y("%")])),showAmount:!1},visibility:nt(h.capsules),requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(1.3).mul(175)})),style:{width:"225px",padding:"0 10px"}})),capsuleCap:Rt(I=>({display:{title:"Capsule Storage",description:"Increase capsule's maximum storage by 1.",effectDisplay:we(()=>s(W,null,[y("+"),_e(I.amount.value)])),showAmount:!1},visibility:nt(h.capsules),requirements:qt(()=>({resource:nt(e),cost:d.variable(I.amount).pow_base(1.6).mul(200)})),style:{width:"225px",padding:"0 10px"}}))},_=me({}),w=V("normal"),b={standardCycle:{name:"First Cycle",description:"Reach Cycle {0} in Standard mode.",target:nt(r.standard),goal:I=>10+I*5,reward:I=>["xp",10+I*(I+1)*.5],exclusiveRewards:{3:["building","splatter"],6:["building","blaster"],9:["building","splitter"],12:["building","thunder"]}},boostedCycle:{name:"Second Cycle",description:"Reach Cycle {0} in Boosted mode.",target:nt(r.boosted),goal:I=>10+I*5,reward:I=>["xp",12+I*(I+1)],exclusiveRewards:{2:["building","bomber"],4:["building","hourglass"],6:["building","decayer"]}},hardcoreCycle:{name:"Third Cycle",description:"Reach Cycle {0} in Hardcore mode.",target:nt(r.hardcore),goal:I=>10+I*5,reward:I=>["xp",15+I*(I+1)*1.5],exclusiveRewards:{1:["building","igniter"],3:["building","pagoda"]}},upgradeCount:{name:"Not Really a Fair Game",description:"Buy {0} Researches.",target:F(()=>Object.values(p).reduce((I,j)=>c.add(I,j.amount.value).toNumber(),0)),goal:I=>3+I*2,reward:I=>["capsules",3+I],exclusiveRewards:{3:["building","observer"]}},totalXP:{name:"XP Grinder",description:"Gain a total of {0} XP.",target:nt(t),goal:I=>500+I*(I+1)*(I+2)*250,reward:I=>["capsules",3],exclusiveRewards:{6:["building","multiplier"]}}},C={anxiety:{name:"Anxiety",description:"Reach 200% stress.",reward:["building","stablizer"]},stucked:{name:"Stucked",description:'Get yourself in a "softlocked" state.',reward:["building","pins"]}},E=me({}),T={xp:{name:"XP Core",description:"+{0}% xp gain.",formula:I=>I},energy:{name:"Energy Core",description:"+{0} starting Energy.",formula:I=>I},capsules:{name:"Capsule Core",description:"+{0}% capsule production.",formula:I=>Math.sqrt(I),precision:2},capacity:{name:"Capacity Core",description:"+{0} capsule capacity.",formula:I=>Math.sqrt(I/10),precision:2}};function S(I){var j;return T[I].formula((j=E.value[I])!=null?j:0)}const $=Bi(()=>({startNodes:()=>[],state(){return{nodes:[{id:0,type:"play",position:{x:0,y:0}},{id:1,type:"info",position:{x:Math.sin(U.timePlayed/20)*150,y:Math.cos(U.timePlayed/20)*150}},{id:2,type:"setting",position:{x:Math.sin(U.timePlayed/20+Math.PI*.66667)*150,y:Math.cos(U.timePlayed/20+Math.PI*.66667)*150}},{id:3,type:"saves",position:{x:Math.sin(U.timePlayed/20+Math.PI*1.33333)*150,y:Math.cos(U.timePlayed/20+Math.PI*1.33333)*150}},{id:4,type:"collection",position:{x:Math.sin(U.timePlayed/-50)*300,y:Math.cos(U.timePlayed/-50)*300}},{id:5,type:"research",position:{x:Math.sin(U.timePlayed/-50+Math.PI)*300,y:Math.cos(U.timePlayed/-50+Math.PI)*300}},{id:6,type:"objectives",position:{x:Math.sin(U.timePlayed/-50+Math.PI*.5)*300,y:Math.cos(U.timePlayed/-50+Math.PI*.5)*300}},{id:7,type:"capsules",position:{x:Math.sin(U.timePlayed/-50+Math.PI*1.5)*300,y:Math.cos(U.timePlayed/-50+Math.PI*1.5)*300}}],selectedNode:null,selectedAction:null}},classes:{"hub-board":!0},types:{play:{shape:je.Circle,fillColor:"#afcfef",size:80,title:"\u25B6",onClick(I){H()}},info:{shape:je.Circle,fillColor:"#afcfef",size:30,title:"i",onClick(I){var j;(j=document.querySelector(".overlay-nav :nth-child(4)"))==null||j.click()}},setting:{shape:je.Circle,fillColor:"#afcfef",size:30,title:"\u2699\uFE0F",onClick(I){var j;(j=document.querySelector(".overlay-nav :nth-child(3)"))==null||j.click()}},saves:{shape:je.Circle,fillColor:"#afcfef",size:30,title:"\u{1F4BE}",onClick(I){var j;(j=document.querySelector(".overlay-nav :nth-child(2)"))==null||j.click()}},collection:{shape:je.Circle,fillColor:"#afcfef",size:50,title:"\u{1F4DA}",onClick(I){ge()}},research:{shape:je.Circle,fillColor:"#afcfef",size:50,title:"\u{1F52C}",onClick(I){oe()}},objectives:{shape:je.Circle,fillColor:"#afcfef",size:50,title:"\u{1F3AF}",onClick(I){K()}},capsules:{shape:je.Circle,fillColor:"#afcfef",size:50,title:"\u{1F48A}",onClick(I){At()}}}}));function H(){pe.value=s(W,null,[s("h1",{class:"result-title"},[y("NEW GAME")]),s("h2",{style:"font-style: italic;"},[y("- Select your game mode. -")])]),xe.value=()=>{let I=zt.indexOf(l.value),j=zt[(I+zt.length-1)%zt.length],O=zt[(I+1)%zt.length];return s(W,null,[s("div",{class:"game-mode-holder"},[s("button",{class:"feature game-mode-card prev",onClick:()=>l.value=j},[s("h2",null,[ut[j].name]),s("hr",null,null),s("i",null,[ut[j].description,s("br",null,null),Re(ut[j].multiplier,1),y("\xD7 XP gain.")]),s("hr",null,null),y("Highest cycle reached:"),s("br",null,null),s("h1",null,[_e(r[j].value)])]),s("button",{class:"feature game-mode-card"},[s("h2",null,[ut[l.value].name]),s("hr",null,null),s("i",null,[ut[l.value].description,s("br",null,null),Re(ut[l.value].multiplier,1),y("\xD7 XP gain.")]),s("hr",null,null),y("Highest cycle reached:"),s("br",null,null),s("h1",null,[_e(r[l.value].value)])]),s("button",{class:"feature game-mode-card next",onClick:()=>l.value=O},[s("h2",null,[ut[O].name]),s("hr",null,null),s("i",null,[ut[O].description,s("br",null,null),Re(ut[O].multiplier,1),y("\xD7 XP gain.")]),s("hr",null,null),y("Highest cycle reached:"),s("br",null,null),s("h1",null,[_e(r[O].value)])])])])},Ve.value=s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Back")]),s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{ce()}},[y("Next")])]),A.value=!0}function ce(){let I=c.add(p.maxBuildings.amount.value,6).toNumber(),j=c.mul(p.startEnergy.amount.value,25).add(100).toNumber();pe.value=()=>s(W,null,[s("h1",{class:"result-title"},[y("NEW GAME")]),s("h2",{style:"font-style: italic;"},[y("- Equip your buildings. -")]),s("div",{class:"building-list collection",style:"border-bottom: 2px solid var(--foreground); padding-bottom: 20px; transition: none"},[u.value.map(O=>{let Y=Me[O];return s("button",{class:Object.fromEntries([[Y.class,!0],["selected",g.value==O]]),onClick:()=>{g.value==O?u.value.splice(u.value.indexOf(O),1):g.value=O}},[s("div",{class:"background",style:{background:Y.color}},[s("div",{class:"icon"},[Y.icon])])])}),[...Array(I-u.value.length).keys()].map(()=>s("button",{class:"disabled"},[y("a")]))])]),xe.value=()=>s(W,null,[s("div",{class:"building-list collection",style:"transition: none"},[Object.keys(o.value).map(O=>{let Y=Me[O];return s("button",{class:Object.fromEntries([[Y.class,!0],["disabled",u.value.includes(O)],["selected",g.value==O]]),onClick:()=>{g.value==O?u.value.includes(O)?u.value.splice(u.value.indexOf(O),1):u.value.length<I&&u.value.push(O):g.value=O}},[s("div",{class:"background",style:{background:Y.color}},[s("div",{class:"icon"},[Y.icon])])])})])]),Ve.value=()=>s(W,null,[g.value?s("div",{style:"display: flex; flex-direction: row; align-content: flex-start; gap: 10px; font-size: 12px; transition: none"},[s("div",{style:"flex: 0 0 calc(50% - 5px); margin: 0"},[s("h3",null,[Me[g.value].name])," ",s("h5",{style:"display: inline-block; margin: 0"},[s("i",null,[y("- "),Me[g.value].class.toUpperCase()])]),s("br",null,null),s("i",null,[Me[g.value].description])]),s("div",{style:"flex: 0 0 calc(50% - 5px); margin: 5px 0 5px 0"},[s("h5",null,[y("BASE BUILDING COST:")]),s("div",{class:"stat-entries"},[Object.entries(Me[g.value].baseCost).map(([O,Y])=>s("div",null,[s("div",{class:"name"},[Xt.resources[O].displayName]),s("div",{class:"value"},[_e(Y)])]))]),s("hr",{style:"opacity: 0; margin: 3px"},null),s("h5",null,[y("STARTING SPECS:")]),s("div",{class:"stat-entries"},[Object.entries(Me[g.value].upgrades).map(([O,Y])=>{var He,ve;return s("div",null,[s("div",{class:"name"},[Y.name]),s("div",{class:"value"},[Re(Y.effect(0),(He=Y.precision)!=null?He:0)+((ve=Y.unit)!=null?ve:"")])])})])])]):s("div",{style:"text-align: center; font-style: italic;"},[y("Click on a building to view its details.")]),s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("button",{class:"feature can",onClick:()=>{H()}},[y("Back")]),s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Close")]),s("div",{style:"flex-grow: 1"},null),u.value.findIndex(O=>{var Y;return Me[O].class=="damager"&&Object.keys(Me[O].baseCost).length<=1&&((Y=Me[O].baseCost.energy)!=null?Y:1/0)<=j&&Me[O].onUpdate})>=0?s("button",{class:"feature can",onClick:()=>{U.tabs=["game"],Xt.startGame(),A.value=!1}},[y("Start game")]):s("div",null,[y("Need at least 1 building that can defeat enemies at start.")])])]),g.value="",A.value=!0}function ge(){pe.value=s(W,null,[s("h1",{class:"result-title"},[y("COLLECTION")]),s("h2",{style:"font-style: italic;"},[y("- View your unlocked buildings. -")])]),xe.value=()=>{let I=0;return h.collection.value?s("div",{class:"building-list collection"},[Object.entries(Me).map(([j,O])=>s("button",{class:Object.fromEntries([[O.class,!0],["disabled",!o.value[j]],["selected",g.value==j]]),onClick:()=>g.value=j},[s("div",{class:"background",style:{background:O.color}},[s("div",{class:"icon"},[O.icon])])]))]):s("div",{style:"text-align: center; --layer-color: #afcfef"},[s("button",{class:{feature:!0,can:e.value>=I},style:"font-size: 10px; width: 200px; height: 80px; margin: 2s0px;",onClick:()=>{e.value>=I&&(e.value-=I,h.collection.value=!0)}},[s("h2",null,[y("Unlock Collection.")]),s("br",null,null),s("br",null,null),y("Costs: "),_e(I),y(" xp")])])},Ve.value=()=>s(W,null,[g.value?s("div",{style:"display: flex; flex-direction: row; align-content: flex-start; gap: 10px; font-size: 12px; transition: none"},[s("div",{style:"flex: 0 0 calc(50% - 5px); margin: 0"},[s("h3",null,[Me[g.value].name])," ",s("h5",{style:"display: inline-block; margin: 0"},[s("i",null,[y("- "),Me[g.value].class.toUpperCase()])]),s("br",null,null),s("i",null,[Me[g.value].description])]),s("div",{style:"flex: 0 0 calc(50% - 5px); margin: 5px 0 5px 0"},[s("h5",null,[y("BASE BUILDING COST:")]),s("div",{class:"stat-entries"},[Object.entries(Me[g.value].baseCost).map(([I,j])=>s("div",null,[s("div",{class:"name"},[Xt.resources[I].displayName]),s("div",{class:"value"},[_e(j)])]))]),s("hr",{style:"opacity: 0; margin: 3px"},null),s("h5",null,[y("STARTING SPECS:")]),s("div",{class:"stat-entries"},[Object.entries(Me[g.value].upgrades).map(([I,j])=>{var O,Y;return s("div",null,[s("div",{class:"name"},[j.name]),s("div",{class:"value"},[Re(j.effect(0),(O=j.precision)!=null?O:0)+((Y=j.unit)!=null?Y:"")])])})])])]):h.collection.value?s("div",{style:"text-align: center; font-style: italic;"},[y("Click on a building to view its details.")]):"",s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Back")])])]),g.value="",A.value=!0}function oe(){pe.value=s(W,null,[s("h1",{class:"result-title"},[y("LABORATORY")]),s("h2",{style:"font-style: italic;"},[y("- Replay. Research. Repeat. -")])]),xe.value=()=>{let I=250;return h.research.value?s("div",{style:"text-align: center; --layer-color: #afcfef"},[y("You have "),s("h2",null,[_e(e.value)]),y(" xp."),s("br",null,null),s("br",null,null),s("div",{style:"display: flex; flex-wrap: wrap; justify-content: center"},[Object.values(p).map(dt)]),s("br",null,null),s("br",null,null)]):s("div",{style:"text-align: center; --layer-color: #afcfef"},[s("button",{class:{feature:!0,can:e.value>=I},style:"font-size: 10px; width: 200px; height: 80px; margin: 20px;",onClick:()=>{e.value>=I&&(e.value-=I,h.research.value=!0)}},[s("h2",null,[y("Unlock Research.")]),s("br",null,null),s("br",null,null),y("Costs: "),_e(I),y(" xp")])])},Ve.value=s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Back")])]),A.value=!0}function K(){pe.value=()=>s(W,null,[s("h1",{class:"result-title"},[y("OBJECTIVES")]),s("h2",{style:"font-style: italic;"},[y("- Do tasks. Reap rewards. -")]),h.objectives.value?s("div",{class:"option-tabs"},[s("button",{class:{selected:w.value=="normal"},onClick:()=>w.value="normal"},[y("Normal")]),s("button",{class:{selected:w.value=="special"},onClick:()=>w.value="special"},[y("Special")])]):""]),xe.value=()=>{let I=0;return h.objectives.value?s("div",{style:"text-align: center; --layer-color: #afcfef"},[w.value=="special"?Object.entries(C).map(([j,O])=>{let Y=_.value[j];return s("div",{class:"objective-holder"},[s("h3",null,[O.name]),s("br",null,null),Y===void 0?O.description.replaceAll(/\S/g,"?"):O.description,s("hr",null,null),s("div",{class:"building-list",style:"justify-content: center; margin-top: 0; transition: none"},[s("button",{class:Object.fromEntries([...O.reward[0]=="building"?[[Me[O.reward[1]].class,!0]]:[],["disabled",Y===1],["claimable",Y===0]]),onClick:()=>{Y===0&&(O.reward[0]=="building"&&(o.value[O.reward[1]]=!0),Y=_.value[j]=1)}},[s("div",{class:"background",style:{background:Me[O.reward[1]].color}},[s("div",{class:"icon"},[Me[O.reward[1]].icon])])])])])}):Object.entries(b).map(([j,O])=>{var ve,tt,kt;let Y=(ve=_.value[j])!=null?ve:0,He=O.goal(Y);return s("div",{class:"objective-holder"},[s("h3",null,[O.name]),s("br",null,null),O.description.replace("{0}",Re(He,(tt=O.goalPrecision)!=null?tt:0)),s("hr",null,null),s("div",{style:"display: inline-block; min-width: 50px; padding-inline: 5px; border-bottom: 2px solid var(--foreground); transition: none"},[Re(O.target.value,(kt=O.goalPrecision)!=null?kt:0)]),s("div",{class:"building-list"},[[-3,-2,-1,0,1,2,3].map(ze=>{var _n,wn;let ht=O.exclusiveRewards[Y+ze],yn=O.reward(Y+ze);return s("button",{class:Object.fromEntries([...(ht==null?void 0:ht[0])=="building"?[[Me[ht[1]].class,!0]]:[],["disabled",ze<0],["claimable",ze>=0&&O.target.value>=O.goal(Y+ze)]]),onClick:()=>{if(ze>=0&&O.target.value>=O.goal(Y+ze))for(let bt=0;bt<=ze;bt++){let N=O.exclusiveRewards[Y];if(N)N[0]=="building"&&(o.value[N[1]]=!0);else{let D=O.reward(Y),L={xp:e,capsules:n}[D[0]];L.value=c.add(L.value,D[1]).toNumber()}Y=_.value[j]=Y+1}}},[s("div",{class:{goal:!0,zero:ze==0}},[Y+ze>=0?Re(O.goal(Y+ze),(_n=O.goalPrecision)!=null?_n:0):""]),Y+ze<0?"":ht?s("div",{class:"background",style:{background:Me[ht[1]].color}},[s("div",{class:"icon"},[Me[ht[1]].icon])]):s("div",{class:"xp-reward"},[Re(yn[1],(wn=O.rewardPrecision)!=null?wn:0),s("br",null,null),{xp:"XP",capsules:"\u{1F48A}"}[yn[0]]])])})])])})]):s("div",{style:"text-align: center; --layer-color: #afcfef"},[s("button",{class:{feature:!0,can:e.value>=I},style:"font-size: 10px; width: 200px; height: 80px; margin: 20px;",onClick:()=>{e.value>=I&&(e.value-=I,h.objectives.value=!0)}},[s("h2",null,[y("Unlock Objectives.")]),s("br",null,null),s("br",null,null),y("Costs: "),_e(I),y(" xp")])])},Ve.value=s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Back")])]),A.value=!0}function At(){pe.value=s(W,null,[s("h1",{class:"result-title"},[y("CAPSULES")]),s("h2",{style:"font-style: italic;"},[y("- The solution to everything. -")])]),xe.value=()=>{let I=1,j=3600/(100+S("capsules"))/(100+new c(p.capsuleGain.amount.value).toNumber())*1e4,O=10+S("capacity")+new c(p.capsuleCap.amount.value).toNumber(),Y=Math.min((U.time-i.value)/j/1e3,O);return h.capsules.value?s("div",{style:"text-align: center; --layer-color: #afcfef"},[y("You have "),s("h2",null,[_e(n.value)]),y(" \u{1F48A}."),s("hr",null,null),Object.entries(T).map(([He,ve])=>{var kt,ze;let tt=(kt=E.value[He])!=null?kt:0;return s("button",{class:"feature",style:"background: #afcfef; font-size: 10px; width: 240px; height: 100px;"},[_e(tt),y(" \u{1F48A}"),s("br",null,null),s("h3",null,[ve.name]),s("br",null,null),ve.description.replace("{0}",Re(ve.formula(tt),(ze=ve.precision)!=null?ze:0))])}),s("hr",null,null),s("button",{class:{feature:!0,can:n.value>=1},style:"font-size: 12px; width: 240px; height: 50px;",onClick:()=>{var He;if(n.value>=1){n.value-=1;let ve=Object.keys(T),tt=ve[Math.floor(Math.random()*ve.length)];E.value[tt]=((He=E.value[tt])!=null?He:0)+1}}},[y("Open 1 \u{1F48A}")]),s("hr",null,null),s("br",null,null),y("You have "),s("h2",null,[Re(Y,3),y(" / "),Re(O,2)]),y(" unclaimed \u{1F48A}."),s("br",null,null),y("You gain 1 \u{1F48A} every "),Gt(j),y("."),s("hr",null,null),s("button",{class:{feature:!0,can:Y>=1},style:"font-size: 12px; width: 240px; height: 50px;",onClick:()=>{let He=Math.floor(Y);n.value+=He,Y-=He,i.value=Date.now()-Y*j*1e3}},[y("Claim "),_e(Math.floor(Y)),y(" \u{1F48A}")])]):s("div",{style:"text-align: center; --layer-color: #afcfef"},[s("button",{class:{feature:!0,can:n.value>=I},style:"font-size: 10px; width: 200px; height: 80px; margin: 20px;",onClick:()=>{n.value>=I&&(n.value-=I,h.capsules.value=!0)}},[s("h2",null,[y("Unlock Capsules.")]),s("br",null,null),s("br",null,null),y("Costs: "),_e(I),y(" \u{1F48A}")])])},Ve.value=s("div",{style:"display: flex; text-align: center; --layer-color: #dadafa"},[s("div",{style:"flex-grow: 1"},null),s("button",{class:"feature can",onClick:()=>{A.value=!1}},[y("Back")])]),A.value=!0}let A=V(!1),pe=V(""),xe=V(""),Ve=V("");return{name:"Tree",color:"#afcfef",classes:{hub:!0},minimizable:!1,points:e,total:t,capsules:n,timeSinceLastClaim:i,bestCycle:r,hubState:a,selectedGameMode:l,unlockedBuildings:o,selectedBuildings:u,board:$,unlocks:h,upgrades:p,objectives:_,allocatedCapsules:E,getCapsuleEffect:S,display:we(()=>s(W,null,[dt($),s("div",{class:"game-top"},[s("div",{style:"display: flex; height: 31px; justify-content: center"},[s("span",{class:"bar-label",style:"margin: 4px;"},[_e(e.value),y(" xp")]),s("span",{class:"bar-label",style:"margin: 4px;"},[_e(n.value),y(" \u{1F48A}")])])]),s(pt,{modelValue:A.value,"onUpdate:modelValue":I=>A.value=I},{header:pe.value,body:xe.value,footer:Ve.value})]))}}),zc=e=>[de,Xt],Ui=F(()=>!1);function jc(e,t){}var Uc=Object.freeze(Object.defineProperty({__proto__:null,gameModes:ut,gameModeArray:zt,main:de,getInitialLayers:zc,hasWon:Ui,fixOldSave:jc},Symbol.toStringTag,{value:"Module"}));const bn=e=>(Et("data-v-4a50ce42"),e=e(),Dt(),e),Gc={class:"game-over-modal-header"},Wc=["src","alt"],Hc={class:"game-over-modal-title"},Yc=bn(()=>m("h2",null,"Congratulations!",-1)),Zc={key:0},Xc=bn(()=>m("br",null,null,-1)),Jc=bn(()=>m("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),Kc=bn(()=>m("br",null,null,-1)),Qc=["href"],ed=bn(()=>m("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),td=se({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:i,discordLink:a,versionNumber:r,versionTitle:l}=le,o=F(()=>Gt(U.timePlayed)),u=F(()=>Ui.value&&!U.keepGoing),g=Ft(U,"autosave");function h(){U.keepGoing=!0}function p(){jt(Zt())}return(_,w)=>(x(),re(pt,{"model-value":u.value},{header:X(()=>[m("div",Gc,[f(n)?(x(),M("img",{key:0,class:"game-over-modal-logo",src:f(n),alt:f(t)},null,8,Wc)):G("",!0),m("div",Hc,[Yc,m("h4",null,"You've beaten "+ne(f(t))+" v"+ne(f(r))+": "+ne(f(l)),1)])])]),body:X(({shown:b})=>[b?(x(),M("div",Zc,[m("div",null,"It took you "+ne(o.value)+" to beat the game.",1),Xc,Jc,Kc,m("div",null,[m("a",{href:f(a),class:"game-over-modal-discord-link"},[ed,y(" "+ne(f(i)),1)],8,Qc)]),s(yt,{title:"Autosave",modelValue:g.value,"onUpdate:modelValue":w[0]||(w[0]=C=>g.value=C)},null,8,["modelValue"])])):G("",!0)]),footer:X(()=>[m("div",{class:"game-over-footer"},[m("button",{onClick:h,class:"button"},"Keep Going"),m("button",{onClick:p,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var nd=ke(td,[["__scopeId","data-v-4a50ce42"]]);const Ln=e=>(Et("data-v-2776d67d"),e=e(),Dt(),e),id=Ln(()=>m("div",{class:"nan-modal-header"},[m("h2",null,"NaN value detected!")],-1)),ad={key:0},rd=Ln(()=>m("br",null,null,-1)),sd=["href"],od=Ln(()=>m("span",{class:"material-icons nan-modal-discord"},"discord",-1)),ld=Ln(()=>m("br",null,null,-1)),ud={class:"nan-footer"},cd=se({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=le,i=V(!0),a=V(!0),r=Ft(Te,"hasNaN"),l=V(null);gt(r,_=>{_?(i.value=U.autosave,a.value=U.devSpeed===0):(U.autosave=i.value,U.devSpeed=a.value?0:null)});const o=F(()=>{var _;return(_=Te.NaNPath)==null?void 0:_.join(".")}),u=F(()=>Te.NaNPersistent!=null?Te.NaNPersistent.value:null);function g(){Te.NaNPersistent!=null&&(Te.NaNPersistent.value=new c(0),Te.hasNaN=!1)}function h(){Te.NaNPersistent&&(Te.NaNPersistent.value=new c(1),Te.hasNaN=!1)}function p(){Te.NaNPersistent&&(Te.NaNPersistent.value=new c(NaN),Te.hasNaN=!1)}return(_,w)=>(x(),M(W,null,[s(pt,Ht({modelValue:r.value,"onUpdate:modelValue":w[4]||(w[4]=b=>r.value=b)},_.$attrs),{header:X(()=>[id]),body:X(()=>[m("div",null,[y(' Attempted to assign "'+ne(o.value)+'" to NaN',1),u.value?(x(),M("span",ad,ne(" ")+"(previously "+ne(f(Re)(u.value))+")",1)):G("",!0),y(". Auto-saving has been "+ne(i.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),rd,m("div",null,[m("a",{href:f(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[od,y(" "+ne(f(t)||"The Paper Pilot Community"),1)],8,sd)]),ld,s(yt,{title:"Autosave",modelValue:i.value,"onUpdate:modelValue":w[0]||(w[0]=b=>i.value=b)},null,8,["modelValue"]),f(le).enablePausing?(x(),re(yt,{key:0,title:"Pause game",modelValue:a.value,"onUpdate:modelValue":w[1]||(w[1]=b=>a.value=b)},null,8,["modelValue"])):G("",!0)]),footer:X(()=>[m("div",ud,[m("button",{onClick:w[2]||(w[2]=b=>{var C;return(C=l.value)==null?void 0:C.open()}),class:"button"},"Open Saves Manager"),m("button",{onClick:g,class:"button"},"Set to 0"),m("button",{onClick:h,class:"button"},"Set to 1"),u.value&&f(c).neq(u.value,0)&&f(c).neq(u.value,1)?(x(),M("button",{key:0,onClick:w[3]||(w[3]=b=>r.value=!1),class:"button"}," Set to previous ")):G("",!0),m("button",{onClick:p,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),s(Di,{ref_key:"savesManager",ref:l},null,512)],64))}});var dd=ke(cd,[["__scopeId","data-v-2776d67d"]]);const fd={key:0,class:"tpsDisplay"},gd=se({__name:"TPS",setup(e){const t=F(()=>c.div(Te.lastTenTicks.length,Te.lastTenTicks.reduce((n,i)=>n+i,0)));return(n,i)=>t.value.isNan()?G("",!0):(x(),M("div",fd,"TPS: "+ne(f(_e)(t.value)),1))}});var md=ke(gd,[["__scopeId","data-v-89b89152"]]);var pd=se({__name:"App",setup(e){const t=le.useHeader,n=F(()=>ct[be.theme].variables),i=Ft(be,"showTPS"),a=Ft(Te,"errors"),r=F(()=>Ge(we(()=>s(W,null,[Tr.map(dt)]))));return(l,o)=>a.value.length>0?(x(),M("div",{key:0,class:"error-container",style:et(n.value)},[s(vi,{errors:a.value},null,8,["errors"])],4)):(x(),M(W,{key:1},[m("div",{id:"modal-root",style:et(n.value)},null,4),m("div",{class:Pe(["app",{useHeader:f(t)}]),style:et(n.value)},[f(t)?(x(),re(Oi,{key:0})):G("",!0),s(ku),f(i.value)?(x(),re(md,{key:1})):G("",!0),s(nd),s(dd),(x(),re(at(r.value)))],6)],64))}});var vd=ke(pd,[["__scopeId","data-v-2d818346"]]);We.on("setupVue",e=>e.use(ia));function hd(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:a,onRegisteredSW:r,onRegisterError:l}=e;let o,u,g,h;const p=async(w=!0)=>{await g,w&&(o==null||o.addEventListener("controlling",b=>{b.isUpdate&&window.location.reload()})),await(h==null?void 0:h())};async function _(){if("serviceWorker"in navigator){const{Workbox:w,messageSW:b}=await fn(()=>import("./workbox-window.4a8794bb.js"),[]);h=async()=>{u&&u.waiting&&await b(u.waiting,{type:"SKIP_WAITING"})},o=new w("./sw.js",{scope:"./",type:"classic"}),o.addEventListener("activated",C=>{C.isUpdate||i==null||i()});{const C=()=>{n==null||n()};o.addEventListener("waiting",C),o.addEventListener("externalwaiting",C)}o.register({immediate:t}).then(C=>{u=C,r?r("./sw.js",C):a==null||a(C)}).catch(C=>{l==null||l(C)})}}return g=_(),p}function bd(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:a,onRegisteredSW:r,onRegisterError:l}=e,o=V(!1),u=V(!1);return{updateServiceWorker:hd({immediate:t,onNeedRefresh(){o.value=!0,n==null||n()},onOfflineReady(){u.value=!0,i==null||i()},onRegistered:a,onRegisteredSW:r,onRegisterError:l}),offlineReady:u,needRefresh:o}}const ni=console.error;console.error=function(...e){ni(...e)};window.onerror=function(e,t,n,i,a){return Te.errors.push(a instanceof Error?a:new Error(JSON.stringify(a))),ni(a),!0};window.onunhandledrejection=function(e){Te.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),ni(e.reason)};document.title=le.title;window.projInfo=le;le.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await xr();const{globalBus:e}=await fn(()=>Promise.resolve().then(function(){return kr}),void 0),{startGameLoop:t}=await fn(()=>import("./gameLoop.4df15eed.js"),["assets/gameLoop.4df15eed.js","assets/@fontsource.719f4e79.css","assets/vue.d3924a70.js","assets/amator.0d8662e6.js","assets/bezier-easing.a990b400.js","assets/@vue.f39bd477.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.90a10463.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.09420910.js","assets/sortablejs.c81ffc7d.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.84096fdf.js","assets/panzoom.a3919164.js","assets/wheel.e9936e98.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.1036abd4.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=Ki(vd);n.config.errorHandler=function(i,a,r){console.error(i,r,a)},e.emit("setupVue",n),n.mount("#app"),Kt(()=>{const i=aa(),{updateServiceWorker:a}=bd({onNeedRefresh(){i.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){a()}})},onOfflineReady(){i.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(r){r&&setInterval(()=>r.update(),60*60*1e3)}})}),t()});export{c as D,fn as _,Te as a,le as b,Uc as c,We as g,xi as l,U as p,be as s};
